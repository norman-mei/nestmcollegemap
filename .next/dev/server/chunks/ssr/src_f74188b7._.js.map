{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/kirk/Downloads/Coding%20Projects/nestmcollegemap/src/components/sidebar/SidebarContainer.tsx"],"sourcesContent":["'use client';\n\nimport React, { useState, useRef, useEffect } from 'react';\nimport { cn } from '@/lib/utils';\n\nexport default function SidebarContainer({ children }: { children: React.ReactNode }) {\n  const [width, setWidth] = useState<number>(400);\n  const [isResizing, setIsResizing] = useState(false);\n  const sidebarRef = useRef<HTMLDivElement>(null);\n\n  const startResizing = React.useCallback(() => {\n    setIsResizing(true);\n  }, []);\n\n  const stopResizing = React.useCallback(() => {\n    setIsResizing(false);\n  }, []);\n\n  const resize = React.useCallback((mouseMoveEvent: MouseEvent) => {\n    if (isResizing) {\n      const newWidth = mouseMoveEvent.clientX;\n      if (newWidth > 300 && newWidth < 800) {\n          setWidth(newWidth);\n          if (typeof window !== 'undefined') {\n            window.localStorage.setItem('sidebar-width', String(newWidth));\n          }\n      }\n    }\n  }, [isResizing]);\n\n  useEffect(() => {\n    // apply stored width after mount to avoid SSR mismatch\n    if (typeof window !== 'undefined') {\n      const stored = window.localStorage.getItem('sidebar-width');\n      const parsed = stored ? parseInt(stored, 10) : NaN;\n      if (parsed && parsed > 300 && parsed < 800) {\n        setWidth(parsed);\n      }\n    }\n\n    window.addEventListener(\"mousemove\", resize);\n    window.addEventListener(\"mouseup\", stopResizing);\n    return () => {\n      window.removeEventListener(\"mousemove\", resize);\n      window.removeEventListener(\"mouseup\", stopResizing);\n    };\n  }, [resize, stopResizing]);\n\n  return (\n    <div className=\"flex h-full relative z-20 shadow-xl\" style={{ width: width }}>\n      <div \n        ref={sidebarRef}\n        className=\"flex-1 bg-gray-50 dark:bg-neutral-900 border-r border-gray-300 dark:border-neutral-800 h-full flex flex-col overflow-hidden\"\n      >\n        {children}\n      </div>\n      <div\n        className=\"w-1 bg-gray-300 dark:bg-neutral-800 hover:bg-blue-500 cursor-col-resize transition-colors\"\n        onMouseDown={startResizing}\n      />\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AAFA;;;AAKe,SAAS,iBAAiB,EAAE,QAAQ,EAAiC;IAClF,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,iNAAQ,EAAS;IAC3C,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,iNAAQ,EAAC;IAC7C,MAAM,aAAa,IAAA,+MAAM,EAAiB;IAE1C,MAAM,gBAAgB,gNAAK,CAAC,WAAW,CAAC;QACtC,cAAc;IAChB,GAAG,EAAE;IAEL,MAAM,eAAe,gNAAK,CAAC,WAAW,CAAC;QACrC,cAAc;IAChB,GAAG,EAAE;IAEL,MAAM,SAAS,gNAAK,CAAC,WAAW,CAAC,CAAC;QAChC,IAAI,YAAY;YACd,MAAM,WAAW,eAAe,OAAO;YACvC,IAAI,WAAW,OAAO,WAAW,KAAK;gBAClC,SAAS;gBACT;;YAGJ;QACF;IACF,GAAG;QAAC;KAAW;IAEf,IAAA,kNAAS,EAAC;QACR,uDAAuD;QACvD;;QAQA,OAAO,gBAAgB,CAAC,aAAa;QACrC,OAAO,gBAAgB,CAAC,WAAW;QACnC,OAAO;YACL,OAAO,mBAAmB,CAAC,aAAa;YACxC,OAAO,mBAAmB,CAAC,WAAW;QACxC;IACF,GAAG;QAAC;QAAQ;KAAa;IAEzB,qBACE,8OAAC;QAAI,WAAU;QAAsC,OAAO;YAAE,OAAO;QAAM;;0BACzE,8OAAC;gBACC,KAAK;gBACL,WAAU;0BAET;;;;;;0BAEH,8OAAC;gBACC,WAAU;gBACV,aAAa;;;;;;;;;;;;AAIrB"}},
    {"offset": {"line": 83, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/kirk/Downloads/Coding%20Projects/nestmcollegemap/src/components/sidebar/StudentList.tsx"],"sourcesContent":["'use client';\n\nimport React, { useMemo, useState, useEffect } from 'react';\nimport { useFilters } from '@/contexts/FilterContext';\nimport { useUI } from '@/contexts/UIContext';\nimport { ProcessedStudent } from '@/lib/types';\nimport { GRAD_CLASS_COLORS } from '@/lib/constants';\n\ntype CollapsedState = Record<string, boolean>;\n\nconst gradOrder = [\"'21\",\"'22\",\"'23\",\"'24\",\"'25\",\"'26\"];\nconst getFirstName = (full: string) => full.trim().split(/\\s+/)[0] || full;\nconst getLastName = (full: string) => {\n  const parts = full.trim().split(/\\s+/);\n  return parts.length > 1 ? parts[parts.length - 1] : full;\n};\nconst displayGradClass = (gradClass: string) => gradClass.replace(/^'+/, '');\n\nexport default function StudentList() {\n  const { filteredStudents, filterState, setFilterState, toggleStudentVisibility, toggleCollegeVisibility, isStudentVisible, isCollegeVisible } = useFilters();\n  const { openPhotoPopup, setActiveHoverId, activeHoverId } = useUI();\n  const [isGallery, setIsGallery] = useState(false);\n  const [sortTarget, setSortTarget] = useState<'students' | 'colleges'>('students');\n  const [studentSort, setStudentSort] = useState<'grad_first' | 'grad_last' | 'first' | 'last'>('grad_first');\n  const [collegeSort, setCollegeSort] = useState<'name_asc' | 'name_desc' | 'count_desc' | 'count_asc'>('name_asc');\n  const [collapsedClasses, setCollapsedClasses] = useState<CollapsedState>({});\n\n  // Load persisted collapsed state after mount to avoid SSR/client mismatch\n  useEffect(() => {\n    try {\n      const stored = localStorage.getItem('collapsedGradClasses');\n      if (stored) {\n        const parsed = JSON.parse(stored);\n        if (parsed && typeof parsed === 'object') setCollapsedClasses(parsed as CollapsedState);\n      }\n    } catch {\n      // ignore malformed storage\n    }\n  }, []);\n\n  useEffect(() => {\n    if (typeof window === 'undefined') return;\n    localStorage.setItem('collapsedGradClasses', JSON.stringify(collapsedClasses));\n  }, [collapsedClasses]);\n\n  const sortedStudents = useMemo(() => {\n    const list = [...filteredStudents];\n    return list.sort((a, b) => {\n      if (studentSort === 'grad_first' || studentSort === 'grad_last') {\n        const gradCompare = gradOrder.indexOf(a.gradClass) - gradOrder.indexOf(b.gradClass);\n        if (gradCompare !== 0) return gradCompare;\n        if (studentSort === 'grad_first') {\n          const first = getFirstName(a.seniorName).localeCompare(getFirstName(b.seniorName));\n          if (first !== 0) return first;\n          return getLastName(a.seniorName).localeCompare(getLastName(b.seniorName));\n        }\n        const last = getLastName(a.seniorName).localeCompare(getLastName(b.seniorName));\n        if (last !== 0) return last;\n        return getFirstName(a.seniorName).localeCompare(getFirstName(b.seniorName));\n      }\n\n      if (studentSort === 'first') {\n        const first = getFirstName(a.seniorName).localeCompare(getFirstName(b.seniorName));\n        if (first !== 0) return first;\n        return getLastName(a.seniorName).localeCompare(getLastName(b.seniorName));\n      }\n      const last = getLastName(a.seniorName).localeCompare(getLastName(b.seniorName));\n      if (last !== 0) return last;\n      return getFirstName(a.seniorName).localeCompare(getFirstName(b.seniorName));\n    });\n  }, [filteredStudents, studentSort]);\n\n  const groupedByGrad = useMemo(() => {\n    if (sortTarget !== 'students' || (studentSort !== 'grad_first' && studentSort !== 'grad_last')) return [];\n    const groups = new Map<string, ProcessedStudent[]>();\n    sortedStudents.forEach((s) => {\n      const key = s.gradClass;\n      if (!groups.has(key)) groups.set(key, []);\n      groups.get(key)!.push(s);\n    });\n    return Array.from(groups.entries()).sort(([a], [b]) => gradOrder.indexOf(a) - gradOrder.indexOf(b));\n  }, [sortedStudents, sortTarget, studentSort]);\n\n  const collegesAggregated = useMemo(() => {\n    const map = new Map<string, { name: string; count: number; sampleStudent: ProcessedStudent; image?: string }>();\n    filteredStudents.forEach((s) => {\n      if (s.collegeName === 'Undecided') return;\n      if (!map.has(s.collegeName)) {\n        map.set(s.collegeName, { name: s.collegeName, count: 0, sampleStudent: s, image: s.collegeImageUrl });\n      }\n      const entry = map.get(s.collegeName)!;\n      entry.count += 1;\n      if (!entry.image && s.collegeImageUrl) entry.image = s.collegeImageUrl;\n    });\n    const arr = Array.from(map.values());\n    return arr.sort((a, b) => {\n      if (collegeSort === 'name_asc') return a.name.localeCompare(b.name);\n      if (collegeSort === 'name_desc') return b.name.localeCompare(a.name);\n      if (collegeSort === 'count_desc') return b.count - a.count || a.name.localeCompare(b.name);\n      return a.count - b.count || a.name.localeCompare(b.name);\n    });\n  }, [filteredStudents, collegeSort]);\n\n  // Respond to map marker clicks by opening the right class section, highlighting, and showing the popup\n  useEffect(() => {\n    const handleFocusFromMap = (ev: Event) => {\n      const custom = ev as CustomEvent<{ id: number }>;\n      if (!custom.detail) return;\n      const targetId = custom.detail.id;\n      const target = filteredStudents.find((s) => s.id === targetId);\n      if (!target) return;\n\n      // Ensure the grad class accordion is open\n      setCollapsedClasses((prev) => ({ ...prev, [target.gradClass]: false }));\n\n      // Highlight and open popup after DOM updates\n      requestAnimationFrame(() => {\n        const el = document.querySelector(`[data-student-id=\"${target.id}\"]`) as HTMLElement | null;\n        if (el) {\n          el.scrollIntoView({ behavior: 'smooth', block: 'center' });\n          el.classList.add('ring-2', 'ring-[#188BFE]', 'ring-offset-2');\n          setTimeout(() => el.classList.remove('ring-2', 'ring-[#188BFE]', 'ring-offset-2'), 1600);\n        }\n        setActiveHoverId(target.id);\n        openPhotoPopup(target, el?.getBoundingClientRect());\n      });\n    };\n    window.addEventListener('focus-student-from-map', handleFocusFromMap as EventListener);\n    return () => window.removeEventListener('focus-student-from-map', handleFocusFromMap as EventListener);\n  }, [filteredStudents, setActiveHoverId, openPhotoPopup]);\n\n  const handleSearch = (e: React.ChangeEvent<HTMLInputElement>) => {\n    setFilterState((prev) => ({ ...prev, searchQuery: e.target.value }));\n  };\n\n  const toggleClass = (gradClass: string) => {\n    setCollapsedClasses((prev) => ({ ...prev, [gradClass]: !prev[gradClass] }));\n  };\n\n  const ListItem = ({ student }: { student: ProcessedStudent }) => {\n    const color = GRAD_CLASS_COLORS[student.gradClass] || '#ccc';\n    const isHovered = activeHoverId === student.id;\n    const honoraries = student.honoraries || [];\n    return (\n      <div\n        className={`px-4 py-2 border-b border-gray-200 dark:border-neutral-800 transition-colors cursor-pointer ${\n          isHovered ? 'bg-blue-50 dark:bg-blue-900/20' : 'hover:bg-gray-100 dark:hover:bg-neutral-800'\n        }`}\n        data-student-id={student.id}\n        onClick={(e) => {\n          window.dispatchEvent(\n            new CustomEvent('center-student-marker', { detail: { id: student.id, lat: student.lat, lng: student.lng } })\n          );\n          openPhotoPopup(student, e.currentTarget.getBoundingClientRect());\n        }}\n        onMouseEnter={(e) => {\n          setActiveHoverId(student.id);\n          openPhotoPopup(student, e.currentTarget.getBoundingClientRect());\n        }}\n        onMouseLeave={() => setActiveHoverId(null)}\n      >\n        <div className=\"flex items-start gap-3\">\n          <input\n            type=\"checkbox\"\n            className=\"mt-3\"\n            checked={isStudentVisible(student.id)}\n            onChange={(e) => {\n              e.stopPropagation();\n              toggleStudentVisibility(student.id);\n            }}\n            onClick={(e) => e.stopPropagation()}\n          />\n          <div className=\"h-12 w-12 rounded bg-gray-200 dark:bg-neutral-800 overflow-hidden flex-shrink-0\">\n            <img\n              src={student.seniorPhotoUrl}\n              alt={student.seniorName}\n              className=\"h-full w-full object-cover\"\n              onError={(e) => {\n                const img = e.target as HTMLImageElement;\n                img.src = student.seniorPhotoUrlPng || '/placeholder-logo.png';\n              }}\n            />\n          </div>\n          <div className=\"flex-1 min-w-0\">\n            <div className=\"flex items-start justify-between gap-2\">\n              <div className=\"min-w-0 flex items-center gap-2 flex-wrap\">\n                <span className=\"font-bold text-gray-900 dark:text-gray-100 truncate\">{student.seniorName}</span>\n                <span\n                  className=\"text-xs font-bold px-1.5 py-0.5 rounded text-white\"\n                  style={{ backgroundColor: color }}\n                >\n                  {displayGradClass(student.gradClass)}\n                </span>\n                <div className=\"flex items-center gap-1\">\n                  {honoraries.includes('dean_scholars') && (\n                    <img src=\"/logos/dean scholars.png\" alt=\"Dean Scholars\" className=\"h-4 w-4\" />\n                  )}\n                  {honoraries.includes('macaulay') && (\n                    <img src=\"/logos/macaulay.png\" alt=\"Macaulay Honors\" className=\"h-4 w-4\" />\n                  )}\n                  {honoraries.includes('posse') && (\n                    <img src=\"/logos/posse.png\" alt=\"Posse Scholar\" className=\"h-4\" style={{ width: 20 }} />\n                  )}\n                  {honoraries.includes('questbridge') && (\n                    <img src=\"/logos/questbridge.png\" alt=\"QuestBridge Scholar\" className=\"h-4 w-4\" />\n                  )}\n                  {student.instagramUrl && (\n                    <a href={student.instagramUrl} target=\"_blank\" rel=\"noreferrer\" className=\"inline-flex\">\n                      <img src=\"/logos/instagram.svg\" alt=\"Instagram\" className=\"h-4 w-4\" />\n                    </a>\n                  )}\n                  {student.linkedInUrl && (\n                    <a href={student.linkedInUrl} target=\"_blank\" rel=\"noreferrer\" className=\"inline-flex\">\n                      <img src=\"/logos/linkedin.svg\" alt=\"LinkedIn\" className=\"h-4 w-4\" />\n                    </a>\n                  )}\n                  {student.githubUrl && (\n                    <a href={student.githubUrl} target=\"_blank\" rel=\"noreferrer\" className=\"inline-flex\">\n                      <img src=\"/logos/github.svg\" alt=\"GitHub\" className=\"h-4 w-4 dark:invert\" />\n                    </a>\n                  )}\n                </div>\n              </div>\n            </div>\n        <div className=\"text-sm text-blue-600 dark:text-blue-400 font-medium truncate\">{student.collegeName}</div>\n        <div className=\"text-xs text-gray-500 dark:text-gray-400 truncate\">{student.major || 'Undecided'}</div>\n          </div>\n        </div>\n      </div>\n    );\n  };\n\n  const GalleryItem = ({ student }: { student: ProcessedStudent }) => (\n    <div\n      className=\"relative aspect-square bg-gray-200 dark:bg-neutral-800 rounded overflow-hidden group cursor-pointer\"\n      data-student-id={student.id}\n      onClick={(e) => {\n        window.dispatchEvent(\n          new CustomEvent('center-student-marker', { detail: { id: student.id, lat: student.lat, lng: student.lng } })\n        );\n        openPhotoPopup(student, e.currentTarget.getBoundingClientRect());\n      }}\n      onMouseEnter={() => setActiveHoverId(student.id)}\n      onMouseLeave={() => setActiveHoverId(null)}\n    >\n      <img\n        src={student.seniorPhotoUrl}\n        alt={student.seniorName}\n        className=\"object-cover w-full h-full\"\n        onError={(e) => {\n          (e.target as HTMLImageElement).src = '/placeholder-logo.png';\n        }}\n      />\n      <div className=\"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center p-2 text-center\">\n        <span className=\"text-white text-sm font-bold\">\n          {student.seniorName} {'->'} {student.collegeName}\n        </span>\n      </div>\n      <div\n        className=\"absolute top-1 right-1 text-xs font-bold text-white px-1.5 py-0.5 rounded\"\n        style={{ backgroundColor: GRAD_CLASS_COLORS[student.gradClass] }}\n      >\n        {displayGradClass(student.gradClass)}\n      </div>\n    </div>\n  );\n\n  return (\n    <div className=\"flex flex-col h-full min-h-0\">\n      <div id=\"student-list-toolbar\" className=\"p-4 border-b border-gray-300 dark:border-neutral-800 bg-white dark:bg-neutral-900 sticky top-0 z-10\">\n        <h2 className=\"text-lg font-bold mb-2\">College List & Seniors</h2>\n        <div className=\"flex gap-2 mb-2\">\n          <input\n            type=\"text\"\n            placeholder=\"Search...\"\n            id=\"student-search-input\"\n            className=\"flex-1 px-3 py-2 border rounded-full text-sm dark:bg-neutral-800 dark:border-neutral-700\"\n            value={filterState.searchQuery}\n            onChange={handleSearch}\n          />\n          <select\n            className=\"px-2 py-1 border rounded text-sm dark:bg-neutral-800 dark:border-neutral-700\"\n            id=\"list-mode-select\"\n            value={sortTarget}\n            onChange={(e) => {\n              const next = e.target.value as 'students' | 'colleges';\n              setSortTarget(next);\n              if (next === 'colleges') setIsGallery(false);\n            }}\n          >\n            <option value=\"students\">Students</option>\n            <option value=\"colleges\">Colleges</option>\n          </select>\n          {sortTarget === 'students' ? (\n            <select\n              className=\"px-2 py-1 border rounded text-sm dark:bg-neutral-800 dark:border-neutral-700\"\n              id=\"student-sort-select\"\n              value={studentSort}\n              onChange={(e) => setStudentSort(e.target.value as typeof studentSort)}\n            >\n              <option value=\"grad_first\">Grad Class, First Name</option>\n              <option value=\"grad_last\">Grad Class, Last Name</option>\n              <option value=\"first\">First Name (Overall)</option>\n              <option value=\"last\">Last Name (Overall)</option>\n            </select>\n          ) : (\n            <select\n              className=\"px-2 py-1 border rounded text-sm dark:bg-neutral-800 dark:border-neutral-700\"\n              id=\"college-sort-select\"\n              value={collegeSort}\n              onChange={(e) => setCollegeSort(e.target.value as typeof collegeSort)}\n            >\n              <option value=\"name_asc\">Name (A-Z)</option>\n              <option value=\"name_desc\">Name (Z-A)</option>\n              <option value=\"count_desc\">Student Count (Most)</option>\n              <option value=\"count_asc\">Student Count (Least)</option>\n            </select>\n          )}\n          {sortTarget === 'students' && (\n            <button\n              onClick={() => setIsGallery(!isGallery)}\n              id=\"gallery-toggle-btn\"\n              className=\"px-3 py-1 bg-gray-200 dark:bg-neutral-700 rounded text-sm\"\n            >\n              {isGallery ? 'List' : 'Gallery'}\n            </button>\n          )}\n        </div>\n        <div className=\"text-xs text-gray-500\">\n          {sortTarget === 'students'\n            ? `Showing ${filteredStudents.length} students`\n            : `Showing ${collegesAggregated.length} colleges`}\n        </div>\n      </div>\n\n      <div\n        id=\"student-list-scroll\"\n        className=\"flex-1 min-h-0 overflow-y-auto pr-2 scrollbar-thin scrollbar-thumb-gray-400\"\n        style={{ scrollbarGutter: 'stable', maxHeight: 'calc(100vh - 240px)' }}\n      >\n        {sortTarget === 'students' && filteredStudents.length === 0 ? (\n            <div className=\"p-8 text-center text-gray-500\">No results found.</div>\n        ) : sortTarget === 'students' && (studentSort === 'grad_first' || studentSort === 'grad_last') ? (\n          groupedByGrad.map(([gradClass, students]) => {\n            const isCollapsed = collapsedClasses[gradClass] ?? false;\n            return (\n              <div key={gradClass} className=\"border-b border-gray-200 dark:border-neutral-800\">\n                <button\n                  className=\"w-full flex items-center justify-between px-4 py-2 bg-gray-100 dark:bg-neutral-800 text-left font-semibold\"\n                  onClick={() => toggleClass(gradClass)}\n                >\n                  <span className=\"flex items-center gap-2\">\n                    <span\n                      className=\"inline-block h-3 w-3 rounded-full\"\n                      style={{ backgroundColor: GRAD_CLASS_COLORS[gradClass] || '#ccc' }}\n                    />\n                    <span>{displayGradClass(gradClass)} Seniors</span>\n                    <span className=\"text-xs text-gray-500 ml-1\">({students.length})</span>\n                  </span>\n                  <span className=\"text-sm\">{isCollapsed ? '[+]' : '[-]'}</span>\n                </button>\n\n                {!isCollapsed && (\n                  <div className=\"p-2\">\n                    {isGallery ? (\n                      <div className=\"grid grid-cols-2 sm:grid-cols-3 gap-3\">\n                        {students.map((s) => (\n                          <GalleryItem key={s.id} student={s} />\n                        ))}\n                      </div>\n                    ) : (\n                      <div className=\"divide-y divide-gray-200 dark:divide-neutral-800\">\n                        {students.map((s) => (\n                          <ListItem key={s.id} student={s} />\n                        ))}\n                      </div>\n                    )}\n                  </div>\n                )}\n              </div>\n            );\n          })\n        ) : sortTarget === 'students' ? (\n          <div className=\"divide-y divide-gray-200 dark:divide-neutral-800\">\n            {sortedStudents.map((s) => (\n              <ListItem key={s.id} student={s} />\n            ))}\n          </div>\n        ) : collegesAggregated.length === 0 ? (\n          <div className=\"p-8 text-center text-gray-500\">No colleges found.</div>\n        ) : (\n          <div className=\"divide-y divide-gray-200 dark:divide-neutral-800\">\n            {collegesAggregated.map((c) => (\n              <div\n                key={c.name}\n                className=\"p-3 flex items-center gap-3 hover:bg-gray-100 dark:hover:bg-neutral-800 cursor-pointer\"\n                onClick={() => {\n                  if (c.sampleStudent) {\n                    window.dispatchEvent(\n                      new CustomEvent('center-student-marker', {\n                        detail: { id: c.sampleStudent.id, lat: c.sampleStudent.lat, lng: c.sampleStudent.lng }\n                      })\n                    );\n                    window.dispatchEvent(new CustomEvent('focus-student-from-map', { detail: { id: c.sampleStudent.id } }));\n                  }\n                }}\n              >\n                <input\n                  type=\"checkbox\"\n                  className=\"mt-1\"\n                  checked={isCollegeVisible(c.name)}\n                  onChange={(e) => {\n                    e.stopPropagation();\n                    toggleCollegeVisibility(c.name);\n                  }}\n                  onClick={(e) => e.stopPropagation()}\n                />\n                <div className=\"h-10 w-10 rounded bg-gray-200 dark:bg-neutral-700 overflow-hidden flex items-center justify-center\">\n                  {c.image ? (\n                    <img src={c.image} alt={c.name} className=\"object-contain h-full w-full\" />\n                  ) : (\n                    <span className=\"text-xs text-gray-500\">No Logo</span>\n                  )}\n                </div>\n                <div className=\"flex-1 min-w-0\">\n                  <div className=\"font-semibold text-sm text-gray-900 dark:text-gray-100 truncate\">{c.name}</div>\n                  <div className=\"text-xs text-gray-500\">{c.count} {c.count === 1 ? 'student' : 'students'}</div>\n                </div>\n              </div>\n            ))}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 990, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/kirk/Downloads/Coding%20Projects/nestmcollegemap/src/components/sidebar/FilterPanel.tsx"],"sourcesContent":["'use client';\n\nimport React, { useMemo } from 'react';\nimport { useFilters } from '@/contexts/FilterContext';\nimport { GRAD_CLASS_COLORS, PREDEFINED_MAJOR_AREAS } from '@/lib/constants';\nimport { useData } from '@/contexts/DataContext';\n\nconst INSTAGRAM_LINKS: Record<string, string> = {\n  \"'21\": 'https://www.instagram.com/nestmdecisions2021/',\n  \"'22\": 'https://www.instagram.com/nestm2022decisions/',\n  \"'23\": 'https://www.instagram.com/nestmdecisions2023/',\n  \"'24\": 'https://www.instagram.com/nestmdecisions2024/',\n  \"'25\": 'https://www.instagram.com/nestmdecisions25/',\n  \"'26\": 'https://www.instagram.com/nestmseniors2026/',\n};\n\nconst REGION_OPTIONS = [\n  { key: 'InCityNYC', label: 'NYC', detail: 'NYC schools', icon: 'üóΩ' },\n  { key: 'InStateNYOther', label: 'NY State', detail: 'Outside NYC', icon: 'üß≠' },\n  { key: 'OutOfStateUS', label: 'Out-of-State US', detail: 'US outside NY', icon: '‚úàÔ∏è' },\n  { key: 'International', label: 'International', detail: 'Outside US', icon: 'üåç' },\n];\n\nconst MAJOR_COUNT_OVERRIDES: Record<string, number> = {\n  \"Arts/Design\": 24,\n  \"Business/Economics\": 53,\n  \"Communications\": 1,\n  \"Computer Science\": 5,\n  \"Education\": 3,\n  \"Engineering\": 37,\n  \"Health Sciences\": 26,\n  \"Humanities\": 10,\n  \"Humanities/Social Sciences\": 67,\n  \"IT\": 5,\n  \"Journalism\": 1,\n  \"Life Sciences\": 2,\n  \"Mathematics\": 2,\n  \"Physical Sciences\": 4,\n  \"Social Sciences\": 7,\n  \"Statistics\": 2,\n  \"STEM\": 68,\n  \"Other\": 0,\n  \"Undecided/Other\": 66,\n};\n\nconst MAJOR_EMOJIS: Record<string, string> = {\n  \"Arts/Design\": \"üé®\",\n  \"Business/Economics\": \"üíº\",\n  \"Communications\": \"üó£Ô∏è\",\n  \"Computer Science\": \"üíª\",\n  \"Education\": \"üìö\",\n  \"Engineering\": \"üõ†Ô∏è\",\n  \"Health Sciences\": \"ü©∫\",\n  \"Humanities\": \"üìñ\",\n  \"Humanities/Social Sciences\": \"üåê\",\n  \"IT\": \"üñ•Ô∏è\",\n  \"Journalism\": \"üì∞\",\n  \"Life Sciences\": \"üß¨\",\n  \"Mathematics\": \"‚ûó\",\n  \"Physical Sciences\": \"üî¨\",\n  \"Social Sciences\": \"üèõÔ∏è\",\n  \"Statistics\": \"üìä\",\n  \"STEM\": \"üöÄ\",\n  \"Other\": \"‚ú®\",\n  \"Undecided/Other\": \"ü§î\",\n  \"Unknown\": \"‚ùì\",\n};\n\nexport default function FilterPanel() {\n  const { allStudents } = useData();\n  const { filterState, setFilterState, toggleGradClass, toggleMajorArea, toggleLocationFocus, toggleStateCountry } = useFilters();\n\n  const regionCounts = useMemo(() => {\n    const counts: Record<string, number> = {};\n    allStudents.forEach((s) => {\n      counts[s.locationFocus] = (counts[s.locationFocus] || 0) + 1;\n    });\n    return counts;\n  }, [allStudents]);\n\n  const majorCounts = useMemo(() => {\n    const counts: Record<string, number> = {};\n    allStudents.forEach((s) => {\n      const areas = s.majorArea.split(' & ').map((a) => a.trim());\n      areas.forEach((area) => {\n        counts[area] = (counts[area] || 0) + 1;\n      });\n    });\n    return counts;\n  }, [allStudents]);\n\n  const outOfStateCounts = useMemo(() => {\n    const counts: Record<string, number> = {};\n    allStudents.forEach((s) => {\n      if (s.stateOrCountry && s.stateOrCountry.length === 2 && s.stateOrCountry !== 'NY') {\n        counts[s.stateOrCountry] = (counts[s.stateOrCountry] || 0) + 1;\n      }\n    });\n    return Object.entries(counts)\n      .filter(([, count]) => count > 0)\n      .sort((a, b) => a[0].localeCompare(b[0]));\n  }, [allStudents]);\n\n  const setRegions = (keys: string[]) => {\n    const nextState: Record<string, boolean> = {};\n    REGION_OPTIONS.forEach(({ key }) => {\n      nextState[key] = keys.includes(key);\n    });\n    // Keep \"N/A\" untouched (hidden) if it exists\n    if (filterState.locationFocus['N/A'] !== undefined) {\n      nextState['N/A'] = filterState.locationFocus['N/A'];\n    }\n    setFilterState((prev) => ({ ...prev, locationFocus: nextState }));\n  };\n\n  const DEFAULT_SECTIONS = {\n    grad: true,\n    major: true,\n    region: false,\n    stateBreakdown: false,\n    instagram: true,\n  };\n\n  // Match SSR/CSR on first paint; hydrate preferences after mount\n  const [sectionsOpen, setSectionsOpen] = React.useState<typeof DEFAULT_SECTIONS>(DEFAULT_SECTIONS);\n\n  React.useEffect(() => {\n    try {\n      const stored = window.localStorage.getItem('filter-sections-open');\n      const parsed = stored ? JSON.parse(stored) : null;\n      if (parsed && typeof parsed === 'object') {\n        setSectionsOpen((prev) => ({ ...prev, ...parsed }));\n      }\n    } catch {\n      // ignore malformed storage\n    }\n  }, []);\n\n  React.useEffect(() => {\n    if (typeof window === 'undefined') return;\n    window.localStorage.setItem('filter-sections-open', JSON.stringify(sectionsOpen));\n  }, [sectionsOpen]);\n\n  return (\n    <div className=\"p-4 border-b border-gray-300 dark:border-neutral-800 space-y-4\">\n        {/* Class Instagram Links */}\n        <details\n          id=\"class-instagram-section\"\n          open={sectionsOpen.instagram}\n          className=\"group\"\n          onToggle={(e) => setSectionsOpen((prev) => ({ ...prev, instagram: (e.target as HTMLDetailsElement).open }))}\n        >\n          <summary className=\"font-bold cursor-pointer list-none flex justify-between\">\n            <span>Class Instagrams</span>\n            <span className=\"group-open:rotate-180 transition-transform\">‚ñº</span>\n          </summary>\n          <div className=\"mt-3\">\n            <div className=\"flex flex-wrap gap-2\">\n              {Object.keys(GRAD_CLASS_COLORS).map((cls) => {\n                const bg = GRAD_CLASS_COLORS[cls] || '#e5e7eb';\n                const textColor = '#ffffff';\n                return (\n                  <button\n                    key={cls}\n                    className=\"text-xs px-2 py-1 rounded-full border border-gray-300 dark:border-neutral-700 hover:opacity-90 flex items-center gap-1\"\n                    style={{ backgroundColor: bg, color: textColor }}\n                    onClick={() => {\n                      const next: Record<string, boolean> = {};\n                      Object.keys(filterState.gradClasses || {}).forEach((k) => {\n                        next[k] = k === cls;\n                      });\n                      setFilterState((prev) => ({ ...prev, gradClasses: next }));\n                      const link = INSTAGRAM_LINKS[cls];\n                      if (link && typeof window !== 'undefined') {\n                        window.open(link, '_blank', 'noopener,noreferrer');\n                      }\n                    }}\n                    title={`View ${cls} Instagram & filter`}\n                  >\n                    <span aria-hidden=\"true\">\n                      <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" className=\"instagram-logo fill-current\">\n                        <path d=\"M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4s1.791-4 4-4 4 1.79 4 4-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z\"></path>\n                      </svg>\n                    </span>\n                    <span className=\"font-semibold\">{cls.replace(\"'\", '')}</span>\n                  </button>\n                );\n              })}\n            </div>\n          </div>\n        </details>\n\n        {/* Grad Class Filter */}\n        <details\n          id=\"grad-class-filter\"\n          open={sectionsOpen.grad}\n          className=\"group\"\n          onToggle={(e) => setSectionsOpen((prev) => ({ ...prev, grad: (e.target as HTMLDetailsElement).open }))}\n        >\n            <summary className=\"font-bold cursor-pointer list-none flex justify-between\">\n                <span>Filter by Graduating Class</span>\n                <span className=\"group-open:rotate-180 transition-transform\">‚ñº</span>\n            </summary>\n            <div className=\"mt-2 space-y-1\">\n                {Object.keys(GRAD_CLASS_COLORS).map(cls => (\n                    <label key={cls} className=\"flex items-center space-x-2 text-sm cursor-pointer\">\n                        <input \n                            type=\"checkbox\" \n                            checked={!!filterState.gradClasses[cls]}\n                            onChange={() => toggleGradClass(cls)}\n                            className=\"rounded border-gray-300\"\n                        />\n                        <span className=\"w-3 h-3 inline-block rounded-full\" style={{ backgroundColor: GRAD_CLASS_COLORS[cls] }}></span>\n                        <span>{cls}</span>\n                    </label>\n                ))}\n            </div>\n        </details>\n\n        {/* Major Area Filter */}\n         <details\n           id=\"major-area-filter\"\n           className=\"group\"\n           open={sectionsOpen.major}\n           onToggle={(e) => setSectionsOpen((prev) => ({ ...prev, major: (e.target as HTMLDetailsElement).open }))}\n         >\n            <summary className=\"font-bold cursor-pointer list-none flex justify-between\">\n                <span>Filter by Major Area</span>\n                <span className=\"group-open:rotate-180 transition-transform\">‚ñº</span>\n            </summary>\n            <div className=\"mt-2 space-y-3\">\n              <div className=\"flex flex-wrap gap-2 text-xs\">\n                <button\n                  className=\"px-2 py-1 rounded border border-gray-300 dark:border-neutral-700 hover:bg-gray-100 dark:hover:bg-neutral-800\"\n                  onClick={() => {\n                    const next = PREDEFINED_MAJOR_AREAS.reduce((acc, a) => ({ ...acc, [a]: true }), {} as Record<string, boolean>);\n                    setFilterState((prev) => ({ ...prev, majorAreas: next }));\n                  }}\n                >\n                  ‚úÖ Select All\n                </button>\n                <button\n                  className=\"px-2 py-1 rounded border border-gray-300 dark:border-neutral-700 hover:bg-gray-100 dark:hover:bg-neutral-800\"\n                  onClick={() => {\n                    const next = PREDEFINED_MAJOR_AREAS.reduce((acc, a) => ({ ...acc, [a]: false }), {} as Record<string, boolean>);\n                    setFilterState((prev) => ({ ...prev, majorAreas: next }));\n                  }}\n                >\n                  üßπ Clear All\n                </button>\n              </div>\n\n              <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-2\">\n                {PREDEFINED_MAJOR_AREAS.filter((area) => (majorCounts[area] ?? MAJOR_COUNT_OVERRIDES[area] ?? 0) > 0).map((area) => {\n                  const checked = !!filterState.majorAreas[area];\n                  const displayCount = majorCounts[area] ?? MAJOR_COUNT_OVERRIDES[area] ?? 0;\n                  return (\n                    <label\n                      key={area}\n                      className={`flex items-center justify-between rounded border px-3 py-2 text-sm cursor-pointer transition-colors ${\n                        checked\n                          ? 'bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-700'\n                          : 'bg-white dark:bg-neutral-900 border-gray-200 dark:border-neutral-800 hover:bg-gray-50 dark:hover:bg-neutral-800'\n                      }`}\n                      onClick={(e) => {\n                        e.preventDefault();\n                        toggleMajorArea(area);\n                      }}\n                      >\n                      <span className=\"flex flex-col\">\n                        <span className=\"font-semibold flex items-center gap-1\">\n                          <span aria-hidden=\"true\">{MAJOR_EMOJIS[area] || \"üìå\"}</span>\n                          <span>{area}</span>\n                        </span>\n                        <span className=\"text-xs text-gray-500 dark:text-gray-400\">{displayCount} students</span>\n                      </span>\n                      <input\n                        type=\"checkbox\"\n                        readOnly\n                        checked={checked}\n                        className=\"w-4 h-4 rounded border-gray-300 dark:border-neutral-600 accent-green-600\"\n                      />\n                    </label>\n                  );\n                })}\n              </div>\n            </div>\n        </details>\n\n        {/* Location Focus */}\n         <details\n           id=\"region-filter\"\n           className=\"group\"\n           open={sectionsOpen.region}\n           onToggle={(e) => setSectionsOpen((prev) => ({ ...prev, region: (e.target as HTMLDetailsElement).open }))}\n         >\n            <summary className=\"font-bold cursor-pointer list-none flex justify-between\">\n                <span>Filter by Region</span>\n                <span className=\"group-open:rotate-180 transition-transform\">‚ñº</span>\n            </summary>\n            <div className=\"mt-2 space-y-3\">\n              <div className=\"flex flex-wrap gap-2 text-xs\">\n                <button\n                  className=\"px-2 py-1 rounded border border-gray-300 dark:border-neutral-700 hover:bg-gray-100 dark:hover:bg-neutral-800\"\n                  onClick={() => setRegions(REGION_OPTIONS.map((r) => r.key))}\n                >\n                  Select All\n                </button>\n                <button\n                  className=\"px-2 py-1 rounded border border-gray-300 dark:border-neutral-700 hover:bg-gray-100 dark:hover:bg-neutral-800\"\n                  onClick={() => setRegions(['InCityNYC'])}\n                >\n                  NYC Only\n                </button>\n                <button\n                  className=\"px-2 py-1 rounded border border-gray-300 dark:border-neutral-700 hover:bg-gray-100 dark:hover:bg-neutral-800\"\n                  onClick={() => setRegions(['InCityNYC', 'InStateNYOther'])}\n                >\n                  All NY\n                </button>\n                <button\n                  className=\"px-2 py-1 rounded border border-gray-300 dark:border-neutral-700 hover:bg-gray-100 dark:hover:bg-neutral-800\"\n                  onClick={() => setRegions(['OutOfStateUS', 'International'])}\n                >\n                  Beyond NY\n                </button>\n              </div>\n\n              <div className=\"space-y-2\">\n                {REGION_OPTIONS.map(({ key, label, detail, icon }) => {\n                  const checked = !!filterState.locationFocus[key];\n                  return (\n                    <label\n                      key={key}\n                      className={`flex items-center justify-between rounded border px-3 py-2 text-sm cursor-pointer transition-colors ${\n                        checked\n                          ? 'bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-700'\n                          : 'bg-white dark:bg-neutral-900 border-gray-200 dark:border-neutral-800 hover:bg-gray-50 dark:hover:bg-neutral-800'\n                      }`}\n                      onClick={(e) => {\n                        e.preventDefault();\n                        toggleLocationFocus(key);\n                      }}\n                    >\n                      <span className=\"flex items-center gap-3\">\n                        <span className=\"text-lg\">{icon}</span>\n                        <span className=\"flex flex-col\">\n                          <span className=\"font-semibold\">{label}</span>\n                          <span className=\"text-xs text-gray-500 dark:text-gray-400\">{detail}</span>\n                        </span>\n                      </span>\n                      <span className=\"flex items-center gap-3\">\n                        <span className=\"text-xs text-gray-500 dark:text-gray-400\">({regionCounts[key] || 0})</span>\n                        <input\n                          type=\"checkbox\"\n                          readOnly\n                          checked={checked}\n                          className=\"w-4 h-4 rounded border-gray-300 dark:border-neutral-600 accent-blue-600\"\n                        />\n                      </span>\n                    </label>\n                  );\n                })}\n              </div>\n\n              {outOfStateCounts.length > 0 && (\n                <details\n                  className=\"group\"\n                  open={sectionsOpen.stateBreakdown}\n                  onToggle={(e) => setSectionsOpen((prev) => ({ ...prev, stateBreakdown: (e.target as HTMLDetailsElement).open }))}\n                >\n                  <summary className=\"font-semibold cursor-pointer list-none flex justify-between text-sm\">\n                    <span>Out-of-State breakdown</span>\n                    <span className=\"group-open:rotate-180 transition-transform\">‚ñº</span>\n                  </summary>\n                  <div className=\"mt-2 grid grid-cols-2 gap-2 text-sm\">\n                    {outOfStateCounts.map(([state, count]) => {\n                      const checked = filterState.stateCountry[state] ?? true;\n                      return (\n                        <label\n                          key={state}\n                          className={`flex items-center justify-between rounded border px-3 py-2 cursor-pointer transition-colors ${\n                            checked\n                              ? 'bg-purple-50 dark:bg-purple-900/20 border-purple-200 dark:border-purple-700'\n                              : 'bg-white dark:bg-neutral-900 border-gray-200 dark:border-neutral-800 hover:bg-gray-50 dark:hover:bg-neutral-800'\n                          }`}\n                          onClick={(e) => {\n                            e.preventDefault();\n                            toggleStateCountry(state);\n                          }}\n                        >\n                          <span className=\"font-semibold\">{state}</span>\n                          <span className=\"flex items-center gap-2 text-xs text-gray-500 dark:text-gray-400\">\n                            ({count})\n                            <input\n                              type=\"checkbox\"\n                              readOnly\n                              checked={checked}\n                              className=\"w-4 h-4 rounded border-gray-300 dark:border-neutral-600 accent-purple-600\"\n                            />\n                          </span>\n                        </label>\n                      );\n                    })}\n                  </div>\n                </details>\n              )}\n            </div>\n        </details>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1832, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/kirk/Downloads/Coding%20Projects/nestmcollegemap/src/components/sidebar/StatisticsPanel.tsx"],"sourcesContent":["'use client';\n\nimport React, { useMemo } from 'react';\nimport { useFilters } from '@/contexts/FilterContext';\nimport { useData } from '@/contexts/DataContext';\nimport { GRAD_CLASS_COLORS } from '@/lib/constants';\n\nexport default function StatisticsPanel() {\n  const { filteredStudents, filterState, toggleLocationFocus } = useFilters();\n  const { allStudents } = useData();\n\n  const regionStats = useMemo(() => {\n    const template = () => ({\n      Public: 0,\n      Private: 0,\n      Total: 0,\n      grads: {} as Record<string, number>,\n    });\n    const stats: Record<string, ReturnType<typeof template>> = {\n      InCityNYC: template(),\n      InStateNYOther: template(),\n      OutOfStateUS: template(),\n      International: template(),\n      Total: template(),\n    };\n\n    filteredStudents.forEach((student) => {\n      const focus = student.locationFocus;\n      if (!(focus in stats) || focus === 'N/A') return;\n      const bucket = stats[focus];\n      const type = student.isCampusPublic ? 'Public' : 'Private';\n      bucket[type] += 1;\n      bucket.Total += 1;\n      bucket.grads[student.gradClass] = (bucket.grads[student.gradClass] || 0) + 1;\n\n      const total = stats.Total;\n      total[type] += 1;\n      total.Total += 1;\n      total.grads[student.gradClass] = (total.grads[student.gradClass] || 0) + 1;\n    });\n\n    return stats;\n  }, [filteredStudents]);\n\n  const topColleges = useMemo(() => {\n    const counts: Record<string, number> = {};\n    filteredStudents.forEach((s) => {\n      counts[s.collegeName] = (counts[s.collegeName] || 0) + 1;\n    });\n    return Object.entries(counts)\n      .sort((a, b) => b[1] - a[1])\n      .slice(0, 5);\n  }, [filteredStudents]);\n\n  const totalStudents = allStudents.length;\n\n  return (\n    <div className=\"p-4 border-b border-gray-300 dark:border-neutral-800\">\n         <details className=\"group\">\n            <summary className=\"font-bold cursor-pointer list-none flex justify-between\">\n                <span>College Attendance Statistics</span>\n                <span className=\"group-open:rotate-180 transition-transform\">‚ñº</span>\n            </summary>\n            <div className=\"mt-3 space-y-3\">\n              {/* Region cards */}\n              <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-3 text-sm\">\n                {[\n                  { key: \"InCityNYC\", label: \"In City (NYC)\" },\n                  { key: \"InStateNYOther\", label: \"In State (NY)\" },\n                  { key: \"OutOfStateUS\", label: \"Out of State\" },\n                  { key: \"International\", label: \"International\" }\n                ].map(({ key, label }) => {\n                  const region = regionStats[key];\n                  const percent = totalStudents ? Math.round((region.Total / totalStudents) * 100) : 0;\n                  return (\n                    <div\n                      key={key}\n                      className=\"rounded border border-gray-200 dark:border-neutral-800 bg-white dark:bg-neutral-900 p-3 shadow-sm flex flex-col gap-2\"\n                    >\n                      <div className=\"flex items-center justify-between\">\n                        <div>\n                          <div className=\"font-semibold\">{label}</div>\n                          <div className=\"text-xs text-gray-500 dark:text-gray-400\">{region.Total} students ‚Ä¢ {percent}%</div>\n                        </div>\n                        <label className=\"flex items-center gap-2 text-xs\">\n                          <input\n                            type=\"checkbox\"\n                            checked={!!filterState.locationFocus[key]}\n                            onChange={() => toggleLocationFocus(key)}\n                          />\n                          <span>Show</span>\n                        </label>\n                      </div>\n                      <div className=\"flex items-center gap-2 text-xs text-gray-600 dark:text-gray-300\">\n                        <span className=\"px-2 py-0.5 rounded bg-green-100 text-green-800 dark:bg-green-900/40 dark:text-green-200\">Public: {region.Public}</span>\n                        <span className=\"px-2 py-0.5 rounded bg-amber-100 text-amber-800 dark:bg-amber-900/40 dark:text-amber-200\">Private: {region.Private}</span>\n                      </div>\n                      {Object.keys(region.grads).length > 0 && (\n                        <div className=\"flex flex-wrap gap-2 text-xs\">\n                          {Object.entries(region.grads).sort().map(([grad, count]) => (\n                            <span\n                              key={grad}\n                              className=\"px-2 py-0.5 rounded text-white font-semibold\"\n                              style={{ backgroundColor: GRAD_CLASS_COLORS[grad] || '#666' }}\n                            >\n                              {grad}: {count}\n                            </span>\n                          ))}\n                        </div>\n                      )}\n                    </div>\n                  );\n                })}\n              </div>\n\n              {/* Top colleges */}\n              <div className=\"rounded border border-gray-200 dark:border-neutral-800 bg-white dark:bg-neutral-900 p-3 shadow-sm\">\n                <div className=\"flex items-center justify-between mb-2\">\n                  <div className=\"font-semibold text-sm\">Top Colleges (Filtered)</div>\n                  <div className=\"text-xs text-gray-500 dark:text-gray-400\">{filteredStudents.length} students</div>\n                </div>\n                {topColleges.length === 0 ? (\n                  <div className=\"text-xs text-gray-500\">No colleges in current filters.</div>\n                ) : (\n                  <ul className=\"text-xs space-y-1\">\n                    {topColleges.map(([college, count], idx) => (\n                      <li key={college} className=\"flex justify-between\">\n                        <span>{idx + 1}. {college}</span>\n                        <span className=\"font-semibold\">{count}</span>\n                      </li>\n                    ))}\n                  </ul>\n                )}\n              </div>\n            </div>\n        </details>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2177, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/kirk/Downloads/Coding%20Projects/nestmcollegemap/src/components/sidebar/TrendCharts.tsx"],"sourcesContent":["'use client';\n\nimport React from 'react';\nimport {\n  Chart as ChartJS,\n  CategoryScale,\n  LinearScale,\n  PointElement,\n  LineElement,\n  Title,\n  Tooltip,\n  Legend,\n  ChartOptions\n} from 'chart.js';\nimport { Line } from 'react-chartjs-2';\nimport { useData } from '@/contexts/DataContext';\nimport { useTheme } from '@/contexts/ThemeContext';\nimport { PREDEFINED_MAJOR_AREAS } from '@/lib/constants';\n\nChartJS.register(\n  CategoryScale,\n  LinearScale,\n  PointElement,\n  LineElement,\n  Title,\n  Tooltip,\n  Legend\n);\n\nexport default function TrendCharts() {\n  const { allStudents } = useData();\n  const { theme } = useTheme();\n  const isDark = theme === 'dark';\n\n  const years = [\"'21\", \"'22\", \"'23\", \"'24\", \"'25\", \"'26\"];\n  const palette = [\n    '#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0', '#9966FF', '#FF9F40',\n    '#8A2BE2', '#5F9EA0', '#D2691E', '#FF7F50', '#6495ED', '#20c997',\n    '#f472b6', '#f59e0b', '#22c55e', '#6366f1', '#06b6d4'\n  ];\n\n  const totalsByYear = React.useMemo(() => {\n    const map: Record<string, number> = {};\n    years.forEach((y) => { map[y] = 0; });\n    allStudents.forEach((s) => {\n      if (map[s.gradClass] !== undefined) map[s.gradClass] += 1;\n    });\n    return map;\n  }, [allStudents, years]);\n\n  const majorDatasets = PREDEFINED_MAJOR_AREAS.map((area, idx) => {\n    const data = years.map(year => {\n      const total = totalsByYear[year] || 0;\n      if (!total) return 0;\n      const count = allStudents.filter(s => s.gradClass === year && s.majorArea === area).length;\n      return (count / total) * 100;\n    });\n\n    return {\n      label: area,\n      data,\n      borderColor: palette[idx % palette.length],\n      backgroundColor: palette[idx % palette.length],\n      tension: 0.3,\n      hidden: idx > 4 // reduce clutter by default\n    };\n  });\n\n  const locationKeys = [\n    { key: 'InCityNYC', label: 'NYC' },\n    { key: 'InStateNYOther', label: 'Rest of NY' },\n    { key: 'OutOfStateUS', label: 'Out of State' },\n    { key: 'International', label: 'International' },\n  ];\n\n  const locationDatasets = locationKeys.map((loc, idx) => {\n    const data = years.map(year => {\n      const total = totalsByYear[year] || 0;\n      if (!total) return 0;\n      const count = allStudents.filter(s => s.gradClass === year && s.locationFocus === loc.key).length;\n      return (count / total) * 100;\n    });\n    return {\n      label: loc.label,\n      data,\n      borderColor: palette[(idx + 5) % palette.length],\n      backgroundColor: palette[(idx + 5) % palette.length],\n      tension: 0.3,\n    };\n  });\n\n  const topFiveColleges = React.useMemo(() => {\n    const counts: Record<string, number> = {};\n    allStudents.forEach((s) => {\n      if (!s.collegeName || s.collegeName === 'Undecided') return;\n      counts[s.collegeName] = (counts[s.collegeName] || 0) + 1;\n    });\n    return Object.entries(counts)\n      .sort((a, b) => b[1] - a[1])\n      .slice(0, 5)\n      .map(([name]) => name);\n  }, [allStudents]);\n\n  const collegeDatasets = topFiveColleges.map((college, idx) => {\n    const data = years.map(year => {\n      const total = totalsByYear[year] || 0;\n      if (!total) return 0;\n      const count = allStudents.filter(s => s.gradClass === year && s.collegeName === college).length;\n      return (count / total) * 100;\n    });\n    return {\n      label: college,\n      data,\n      borderColor: palette[(idx + 9) % palette.length],\n      backgroundColor: palette[(idx + 9) % palette.length],\n      tension: 0.3,\n    };\n  });\n\n  const options: ChartOptions<'line'> = {\n    responsive: true,\n    maintainAspectRatio: false,\n    interaction: {\n      mode: 'index' as const,\n      intersect: false,\n    },\n    plugins: {\n      legend: {\n        position: 'top' as const,\n        labels: {\n            color: isDark ? '#e5e5e5' : '#333',\n            boxWidth: 10,\n            font: { size: 10 }\n        }\n      },\n      title: {\n        display: false,\n      },\n      tooltip: {\n          callbacks: {\n              label: (ctx) => {\n                const value = typeof ctx.parsed?.y === 'number' ? ctx.parsed.y : 0;\n                return `${ctx.dataset.label}: ${value.toFixed(1)}%`;\n              }\n          }\n      }\n    },\n    scales: {\n        x: {\n            grid: { color: isDark ? 'rgba(255,255,255,0.1)' : 'rgba(0,0,0,0.1)' },\n            ticks: { color: isDark ? '#ccc' : '#666' }\n        },\n        y: {\n            grid: { color: isDark ? 'rgba(255,255,255,0.1)' : 'rgba(0,0,0,0.1)' },\n            ticks: { color: isDark ? '#ccc' : '#666', callback: (v) => `${v}%` },\n            min: 0,\n            max: 100\n        }\n    }\n  };\n\n  return (\n    <div className=\"p-4 border-b border-gray-300 dark:border-neutral-800 space-y-4\">\n      <details className=\"group\">\n        <summary className=\"font-bold cursor-pointer list-none flex justify-between\">\n          <span>Data Trends Over Time</span>\n          <span className=\"group-open:rotate-180 transition-transform\">‚ñº</span>\n        </summary>\n        <div className=\"mt-4 space-y-6\">\n          <div className=\"h-64\">\n            <h5 className=\"text-xs font-bold text-center mb-2 dark:text-gray-300\">Major Area Popularity (% of Grads/Year)</h5>\n            <div className=\"h-full pb-6\">\n              <Line options={options} data={{ labels: years, datasets: majorDatasets }} />\n            </div>\n          </div>\n\n          <div className=\"h-64\">\n            <h5 className=\"text-xs font-bold text-center mb-2 dark:text-gray-300\">Location Focus (% of Grads/Year)</h5>\n            <div className=\"h-full pb-6\">\n              <Line options={options} data={{ labels: years, datasets: locationDatasets }} />\n            </div>\n          </div>\n\n          <div className=\"h-64\">\n            <h5 className=\"text-xs font-bold text-center mb-2 dark:text-gray-300\">Top 5 Colleges by Attendance (% of Grads/Year)</h5>\n            <div className=\"h-full pb-6\">\n              <Line options={options} data={{ labels: years, datasets: collegeDatasets }} />\n            </div>\n          </div>\n        </div>\n      </details>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAWA;AACA;AACA;AACA;AAjBA;;;;;;;;AAmBA,qKAAO,CAAC,QAAQ,CACd,6KAAa,EACb,2KAAW,EACX,4KAAY,EACZ,2KAAW,EACX,qKAAK,EACL,uKAAO,EACP,sKAAM;AAGO,SAAS;IACtB,MAAM,EAAE,WAAW,EAAE,GAAG,IAAA,0IAAO;IAC/B,MAAM,EAAE,KAAK,EAAE,GAAG,IAAA,4IAAQ;IAC1B,MAAM,SAAS,UAAU;IAEzB,MAAM,QAAQ;QAAC;QAAO;QAAO;QAAO;QAAO;QAAO;KAAM;IACxD,MAAM,UAAU;QACd;QAAW;QAAW;QAAW;QAAW;QAAW;QACvD;QAAW;QAAW;QAAW;QAAW;QAAW;QACvD;QAAW;QAAW;QAAW;QAAW;KAC7C;IAED,MAAM,eAAe,gNAAK,CAAC,OAAO,CAAC;QACjC,MAAM,MAA8B,CAAC;QACrC,MAAM,OAAO,CAAC,CAAC;YAAQ,GAAG,CAAC,EAAE,GAAG;QAAG;QACnC,YAAY,OAAO,CAAC,CAAC;YACnB,IAAI,GAAG,CAAC,EAAE,SAAS,CAAC,KAAK,WAAW,GAAG,CAAC,EAAE,SAAS,CAAC,IAAI;QAC1D;QACA,OAAO;IACT,GAAG;QAAC;QAAa;KAAM;IAEvB,MAAM,gBAAgB,iJAAsB,CAAC,GAAG,CAAC,CAAC,MAAM;QACtD,MAAM,OAAO,MAAM,GAAG,CAAC,CAAA;YACrB,MAAM,QAAQ,YAAY,CAAC,KAAK,IAAI;YACpC,IAAI,CAAC,OAAO,OAAO;YACnB,MAAM,QAAQ,YAAY,MAAM,CAAC,CAAA,IAAK,EAAE,SAAS,KAAK,QAAQ,EAAE,SAAS,KAAK,MAAM,MAAM;YAC1F,OAAO,AAAC,QAAQ,QAAS;QAC3B;QAEA,OAAO;YACL,OAAO;YACP;YACA,aAAa,OAAO,CAAC,MAAM,QAAQ,MAAM,CAAC;YAC1C,iBAAiB,OAAO,CAAC,MAAM,QAAQ,MAAM,CAAC;YAC9C,SAAS;YACT,QAAQ,MAAM,EAAE,4BAA4B;QAC9C;IACF;IAEA,MAAM,eAAe;QACnB;YAAE,KAAK;YAAa,OAAO;QAAM;QACjC;YAAE,KAAK;YAAkB,OAAO;QAAa;QAC7C;YAAE,KAAK;YAAgB,OAAO;QAAe;QAC7C;YAAE,KAAK;YAAiB,OAAO;QAAgB;KAChD;IAED,MAAM,mBAAmB,aAAa,GAAG,CAAC,CAAC,KAAK;QAC9C,MAAM,OAAO,MAAM,GAAG,CAAC,CAAA;YACrB,MAAM,QAAQ,YAAY,CAAC,KAAK,IAAI;YACpC,IAAI,CAAC,OAAO,OAAO;YACnB,MAAM,QAAQ,YAAY,MAAM,CAAC,CAAA,IAAK,EAAE,SAAS,KAAK,QAAQ,EAAE,aAAa,KAAK,IAAI,GAAG,EAAE,MAAM;YACjG,OAAO,AAAC,QAAQ,QAAS;QAC3B;QACA,OAAO;YACL,OAAO,IAAI,KAAK;YAChB;YACA,aAAa,OAAO,CAAC,CAAC,MAAM,CAAC,IAAI,QAAQ,MAAM,CAAC;YAChD,iBAAiB,OAAO,CAAC,CAAC,MAAM,CAAC,IAAI,QAAQ,MAAM,CAAC;YACpD,SAAS;QACX;IACF;IAEA,MAAM,kBAAkB,gNAAK,CAAC,OAAO,CAAC;QACpC,MAAM,SAAiC,CAAC;QACxC,YAAY,OAAO,CAAC,CAAC;YACnB,IAAI,CAAC,EAAE,WAAW,IAAI,EAAE,WAAW,KAAK,aAAa;YACrD,MAAM,CAAC,EAAE,WAAW,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,WAAW,CAAC,IAAI,CAAC,IAAI;QACzD;QACA,OAAO,OAAO,OAAO,CAAC,QACnB,IAAI,CAAC,CAAC,GAAG,IAAM,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,EAAE,EAC1B,KAAK,CAAC,GAAG,GACT,GAAG,CAAC,CAAC,CAAC,KAAK,GAAK;IACrB,GAAG;QAAC;KAAY;IAEhB,MAAM,kBAAkB,gBAAgB,GAAG,CAAC,CAAC,SAAS;QACpD,MAAM,OAAO,MAAM,GAAG,CAAC,CAAA;YACrB,MAAM,QAAQ,YAAY,CAAC,KAAK,IAAI;YACpC,IAAI,CAAC,OAAO,OAAO;YACnB,MAAM,QAAQ,YAAY,MAAM,CAAC,CAAA,IAAK,EAAE,SAAS,KAAK,QAAQ,EAAE,WAAW,KAAK,SAAS,MAAM;YAC/F,OAAO,AAAC,QAAQ,QAAS;QAC3B;QACA,OAAO;YACL,OAAO;YACP;YACA,aAAa,OAAO,CAAC,CAAC,MAAM,CAAC,IAAI,QAAQ,MAAM,CAAC;YAChD,iBAAiB,OAAO,CAAC,CAAC,MAAM,CAAC,IAAI,QAAQ,MAAM,CAAC;YACpD,SAAS;QACX;IACF;IAEA,MAAM,UAAgC;QACpC,YAAY;QACZ,qBAAqB;QACrB,aAAa;YACX,MAAM;YACN,WAAW;QACb;QACA,SAAS;YACP,QAAQ;gBACN,UAAU;gBACV,QAAQ;oBACJ,OAAO,SAAS,YAAY;oBAC5B,UAAU;oBACV,MAAM;wBAAE,MAAM;oBAAG;gBACrB;YACF;YACA,OAAO;gBACL,SAAS;YACX;YACA,SAAS;gBACL,WAAW;oBACP,OAAO,CAAC;wBACN,MAAM,QAAQ,OAAO,IAAI,MAAM,EAAE,MAAM,WAAW,IAAI,MAAM,CAAC,CAAC,GAAG;wBACjE,OAAO,GAAG,IAAI,OAAO,CAAC,KAAK,CAAC,EAAE,EAAE,MAAM,OAAO,CAAC,GAAG,CAAC,CAAC;oBACrD;gBACJ;YACJ;QACF;QACA,QAAQ;YACJ,GAAG;gBACC,MAAM;oBAAE,OAAO,SAAS,0BAA0B;gBAAkB;gBACpE,OAAO;oBAAE,OAAO,SAAS,SAAS;gBAAO;YAC7C;YACA,GAAG;gBACC,MAAM;oBAAE,OAAO,SAAS,0BAA0B;gBAAkB;gBACpE,OAAO;oBAAE,OAAO,SAAS,SAAS;oBAAQ,UAAU,CAAC,IAAM,GAAG,EAAE,CAAC,CAAC;gBAAC;gBACnE,KAAK;gBACL,KAAK;YACT;QACJ;IACF;IAEA,qBACE,8OAAC;QAAI,WAAU;kBACb,cAAA,8OAAC;YAAQ,WAAU;;8BACjB,8OAAC;oBAAQ,WAAU;;sCACjB,8OAAC;sCAAK;;;;;;sCACN,8OAAC;4BAAK,WAAU;sCAA6C;;;;;;;;;;;;8BAE/D,8OAAC;oBAAI,WAAU;;sCACb,8OAAC;4BAAI,WAAU;;8CACb,8OAAC;oCAAG,WAAU;8CAAwD;;;;;;8CACtE,8OAAC;oCAAI,WAAU;8CACb,cAAA,8OAAC,8JAAI;wCAAC,SAAS;wCAAS,MAAM;4CAAE,QAAQ;4CAAO,UAAU;wCAAc;;;;;;;;;;;;;;;;;sCAI3E,8OAAC;4BAAI,WAAU;;8CACb,8OAAC;oCAAG,WAAU;8CAAwD;;;;;;8CACtE,8OAAC;oCAAI,WAAU;8CACb,cAAA,8OAAC,8JAAI;wCAAC,SAAS;wCAAS,MAAM;4CAAE,QAAQ;4CAAO,UAAU;wCAAiB;;;;;;;;;;;;;;;;;sCAI9E,8OAAC;4BAAI,WAAU;;8CACb,8OAAC;oCAAG,WAAU;8CAAwD;;;;;;8CACtE,8OAAC;oCAAI,WAAU;8CACb,cAAA,8OAAC,8JAAI;wCAAC,SAAS;wCAAS,MAAM;4CAAE,QAAQ;4CAAO,UAAU;wCAAgB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAOvF"}},
    {"offset": {"line": 2526, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/kirk/Downloads/Coding%20Projects/nestmcollegemap/src/components/map/MapMarkers.tsx"],"sourcesContent":["import React, { useEffect, useRef } from 'react';\nimport { useMap } from '@vis.gl/react-google-maps';\nimport { MarkerClusterer } from '@googlemaps/markerclusterer';\nimport { ProcessedStudent } from '@/lib/types';\nimport { GRAD_CLASS_COLORS, NYC_BOUNDS } from '@/lib/constants';\nimport { useTheme } from '@/contexts/ThemeContext';\nimport { useUI } from '@/contexts/UIContext';\n\ndeclare var google: any;\n\ninterface MapMarkersProps {\n  students: ProcessedStudent[];\n}\n\ntype TimeFormat = '12' | '24';\n\ntype TimeDetails = {\n  timeZoneId: string;\n  label: string;\n};\n\ntype CoordTarget = { lat: number; lng: number };\n\ntype NestmInfoDetail = {\n  marker: any;\n  coords: CoordTarget;\n  name?: string;\n  homepageUrl?: string;\n  imageUrl?: string;\n  typeLabel?: string;\n  locationFocus?: string;\n};\n\nconst TIME_FORMAT_STORAGE_KEY = 'college-info-time-format';\n\nconst isMarkerDebugEnabled = () => {\n  if (process.env.NEXT_PUBLIC_MARKER_DEBUG === 'true') return true;\n  if (typeof window !== 'undefined') {\n    return window.localStorage?.getItem('marker-debug') === 'true';\n  }\n  return false;\n};\n\nconst debugLog = (...args: unknown[]) => {\n  if (isMarkerDebugEnabled()) {\n    console.debug('[MapMarkers]', ...args);\n  }\n};\n\nexport default function MapMarkers({ students }: MapMarkersProps) {\n  const map = useMap();\n  const { theme } = useTheme();\n  const { activeHoverId, setActiveHoverId } = useUI();\n  const clustererRef = useRef<MarkerClusterer | null>(null);\n  const markersRef = useRef<{[key: number]: { marker: any; color: string } }>({});\n  const infowindowRef = useRef<any | null>(null);\n  const lastHighlightedRef = useRef<number | null>(null);\n  const lastInfoWindowStudentIdRef = useRef<number | null>(null);\n  const timeCacheRef = useRef<Map<string, TimeDetails>>(new Map());\n  const weatherCacheRef = useRef<Map<string, string>>(new Map());\n  const transitCacheRef = useRef<Map<string, string>>(new Map());\n  const timeFormatRef = useRef<TimeFormat>('24');\n  const lastMarkerBuildRef = useRef<{\n    map: google.maps.Map | null;\n    studentsRef: ProcessedStudent[];\n    studentsLength: number;\n    theme: string | null;\n  } | null>(null);\n  const locationFocusChipClasses: Record<string, string> = {\n    InCityNYC: 'chip-nyc',\n    InStateNYOther: 'chip-nystate',\n    OutOfStateUS: 'chip-outofstate',\n    International: 'chip-international',\n    'N/A': 'muted',\n  };\n\n  const renderChip = (label: string, extraClass = '') =>\n    `<span class=\"info-chip${extraClass ? ` ${extraClass}` : ''}\">${label}</span>`;\n\n  const buildIcon = (color: string, scale = 7, strokeWeight = 1.5) => ({\n    path: google.maps.SymbolPath.CIRCLE,\n    fillColor: color,\n    fillOpacity: 1,\n    strokeColor: theme === 'dark' ? '#111' : '#fff',\n    strokeWeight,\n    scale,\n  });\n\n  // Cleanup markers on unmount\n  useEffect(() => {\n    return () => {\n      if (clustererRef.current) {\n        clustererRef.current.clearMarkers();\n      }\n    };\n  }, []);\n\n  // Initialize info window once\n  useEffect(() => {\n     if (typeof google === 'undefined') return;\n     if (!infowindowRef.current) {\n         infowindowRef.current = new google.maps.InfoWindow();\n     }\n  }, []);\n\n  useEffect(() => {\n    if (typeof window === 'undefined') return;\n    const storedFormat = window.localStorage.getItem(TIME_FORMAT_STORAGE_KEY);\n    if (storedFormat === '12' || storedFormat === '24') {\n      timeFormatRef.current = storedFormat;\n    }\n  }, []);\n\n  // Effect to handle marker highlighting from list hover\n  useEffect(() => {\n    if (typeof google === 'undefined') return;\n    debugLog('Hover highlight update', {\n      activeHoverId,\n      previousHighlighted: lastHighlightedRef.current,\n    });\n\n    // remove previous highlight\n    if (lastHighlightedRef.current !== null) {\n      const previous = markersRef.current[lastHighlightedRef.current];\n      if (previous) {\n        previous.marker.setIcon(buildIcon(previous.color));\n      }\n    }\n\n    // apply new highlight\n    if (activeHoverId !== null) {\n      const current = markersRef.current[activeHoverId];\n      if (current) {\n        current.marker.setIcon(buildIcon(current.color, 9, 2));\n        lastHighlightedRef.current = activeHoverId;\n        return;\n      }\n    }\n\n    lastHighlightedRef.current = null;\n  }, [activeHoverId, theme]);\n\n  useEffect(() => {\n    if (!map || typeof google === 'undefined') return;\n    const buildStart = typeof performance !== 'undefined' ? performance.now() : Date.now();\n    const reasons: string[] = [];\n    const previous = lastMarkerBuildRef.current;\n    if (!previous) {\n      reasons.push('initial render');\n    } else {\n      if (previous.map !== map) reasons.push('map instance changed');\n      if (previous.studentsRef !== students) reasons.push('students reference changed');\n      if (previous.studentsLength !== students.length) {\n        reasons.push(`students length ${previous.studentsLength} -> ${students.length}`);\n      }\n      if (previous.theme !== theme) reasons.push(`theme ${previous.theme} -> ${theme}`);\n    }\n\n    lastMarkerBuildRef.current = {\n      map,\n      studentsRef: students,\n      studentsLength: students.length,\n      theme,\n    };\n    debugLog('Rebuilding markers', { reasons, studentsLength: students.length, theme });\n    \n    if (!clustererRef.current) {\n      clustererRef.current = new MarkerClusterer({ \n          map,\n          renderer: {\n            render: ({ count, position }) => {\n                let color = \"red\";\n                let diameter = 50;\n                let labelColor = \"white\";\n\n                if (count <= 5) { color = \"green\"; diameter = 30; }\n                else if (count <= 10) { color = \"#90EE90\"; diameter = 35; labelColor = \"black\"; }\n                else if (count <= 20) { color = \"yellow\"; diameter = 40; labelColor = \"black\"; }\n                else if (count <= 50) { color = \"orange\"; diameter = 45; }\n\n                const svg = window.btoa(`\n                <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"${diameter}\" height=\"${diameter}\" viewBox=\"0 0 ${diameter} ${diameter}\">\n                    <circle cx=\"${diameter / 2}\" cy=\"${diameter / 2}\" r=\"${diameter / 2 * 0.9}\" fill=\"${color}\" stroke=\"rgba(0,0,0,0.3)\" stroke-width=\"${Math.max(1, diameter * 0.04)}\"/>\n                </svg>`);\n\n                return new google.maps.Marker({\n                    position,\n                    icon: {\n                        url: `data:image/svg+xml;base64,${svg}`,\n                        scaledSize: new google.maps.Size(diameter, diameter),\n                        anchor: new google.maps.Point(diameter / 2, diameter / 2)\n                    },\n                    label: {\n                        text: String(count),\n                        color: labelColor,\n                        fontSize: '12px',\n                        fontWeight: 'bold',\n                    },\n                    zIndex: 100 + count,\n                });\n            }\n          }\n      });\n      debugLog('Created marker clusterer instance');\n    }\n\n    const previousCount = clustererRef.current.getMarkers?.().length;\n    clustererRef.current.clearMarkers();\n    debugLog('Cleared clusterer markers', { previousCount });\n    markersRef.current = {};\n    lastHighlightedRef.current = null;\n\n    const mapsApiKey = process.env.NEXT_PUBLIC_GOOGLE_MAPS_API_KEY;\n    const weatherApiKey = process.env.NEXT_PUBLIC_OPENWEATHER_API_KEY;\n    const newMarkers: any[] = [];\n\n    const createSocialLinkSVG = (platform: 'linkedin' | 'instagram' | 'github', size = 16) => {\n      const invert = platform === 'github' && theme === 'dark' ? 'filter: invert(1);' : '';\n      return `<img src=\"/logos/${platform}.svg\" alt=\"${platform}\" style=\"width:${size}px;height:${size}px;vertical-align:middle;${invert}\" />`;\n    };\n\n    const createHonoraryIcons = (honoraries?: string[]) => {\n      if (!honoraries || honoraries.length === 0) return '';\n      const icons: Record<string, string> = {\n        dean_scholars: '/logos/dean scholars.png',\n        macaulay: '/logos/macaulay.png',\n        posse: '/logos/posse.png',\n        questbridge: '/logos/questbridge.png',\n      };\n      return honoraries\n        .map((h) => {\n          if (!icons[h]) return '';\n          const width = h === 'posse' ? 20 : 16;\n          return `<img src=\"${icons[h]}\" alt=\"${h}\" style=\"height:16px;width:${width}px;vertical-align:middle;margin-left:4px;\">`;\n        })\n        .join('');\n    };\n\n    const getLastName = (full: string) => {\n      const parts = full.trim().split(/\\s+/);\n      return parts.length > 1 ? parts[parts.length - 1] : full;\n    };\n\n    const getFirstName = (full: string) => {\n      const parts = full.trim().split(/\\s+/);\n      return parts[0] || full;\n    };\n\n    const formatLocationFocus = (focus: string) => {\n      const lookup: Record<string, string> = {\n        InCityNYC: 'NYC',\n        InStateNYOther: 'NY State (Outside NYC)',\n        OutOfStateUS: 'Out of State (US)',\n        International: 'International',\n        'N/A': 'N/A',\n      };\n      return lookup[focus] || focus || 'N/A';\n    };\n\n    const buildStudentsHtml = (student: ProcessedStudent) => {\n      if (student.collegeName === 'Undecided') {\n        return `<div style=\"line-height:1.6;\">\n          <b>${student.seniorName}</b>\n          <span style=\"color:${GRAD_CLASS_COLORS[student.gradClass] || '#ccc'};\"> (Class ${student.gradClass})</span>\n          <div><small>Major: ${student.major || 'Undecided'} (${student.majorArea || 'N/A'})</small></div>\n        </div>`;\n      }\n\n      const studentsAtSameCollege = students\n        .filter(\n          (s) =>\n            s.collegeName === student.collegeName &&\n            s.collegeName !== 'Undecided' &&\n            s.isIndividuallyVisible\n        )\n        .sort((a, b) => {\n          if (a.gradClass !== b.gradClass) return a.gradClass.localeCompare(b.gradClass);\n          const lastCompare = getLastName(a.seniorName).localeCompare(getLastName(b.seniorName));\n          if (lastCompare !== 0) return lastCompare;\n          return getFirstName(a.seniorName).localeCompare(getFirstName(b.seniorName));\n        });\n\n      if (studentsAtSameCollege.length === 0) {\n        return 'No other visible students found for this college with current filters.';\n      }\n\n      const studentWord = studentsAtSameCollege.length === 1 ? 'Student' : 'Students';\n      let html = `<u>${studentsAtSameCollege.length} ${studentWord} Attending Visible:</u><ol style=\"margin-top: 3px; margin-bottom: 3px; padding-left: 22px; list-style: decimal;\">`;\n      studentsAtSameCollege.forEach((s) => {\n        const socials = `\n          ${s.linkedInUrl ? `<a href=\"${s.linkedInUrl}\" target=\"_blank\" rel=\"noreferrer\" class=\"social-icon-link\">${createSocialLinkSVG('linkedin')}</a>` : ''}\n          ${s.instagramUrl ? `<a href=\"${s.instagramUrl}\" target=\"_blank\" rel=\"noreferrer\" class=\"social-icon-link\">${createSocialLinkSVG('instagram')}</a>` : ''}\n          ${s.githubUrl ? `<a href=\"${s.githubUrl}\" target=\"_blank\" rel=\"noreferrer\" class=\"social-icon-link\">${createSocialLinkSVG('github')}</a>` : ''}\n        `;\n        const badges = createHonoraryIcons(s.honoraries);\n        html += `<li style=\"padding:4px 2px; border-radius:3px;\">\n          <div style=\"line-height:1.5; display:flex; align-items:center; gap:4px; flex-wrap:wrap;\">\n            ${s.seniorName} <span style=\"color:${GRAD_CLASS_COLORS[s.gradClass] || '#ccc'};\">(${s.gradClass})</span>\n            ${badges}\n            ${socials}\n          </div>\n          <small style=\"padding-left:10px;\">Major: ${s.major || 'Undecided'} (${s.majorArea || 'N/A'})</small>\n        </li>`;\n      });\n      html += '</ol>';\n      return html;\n    };\n\n    const computeTimeOfDay = (collegeHour: number) => {\n      if (collegeHour >= 5 && collegeHour < 7) return 'Dawn / Early Morning';\n      if (collegeHour >= 7 && collegeHour < 9) return 'Morning';\n      if (collegeHour >= 9 && collegeHour < 12) return 'Late Morning';\n      if (collegeHour >= 12 && collegeHour < 14) return 'Afternoon';\n      if (collegeHour >= 14 && collegeHour < 17) return 'Late Afternoon';\n      if (collegeHour >= 17 && collegeHour < 19) return 'Dusk / Evening';\n      if (collegeHour >= 19 && collegeHour < 22) return 'Nighttime';\n      return 'Late Night';\n    };\n\n    const getTimeCacheKey = (target: CoordTarget) => `${target.lat},${target.lng}`;\n\n    const formatTimeString = (date: Date, format: TimeFormat, timeZoneId?: string) => {\n      const options: Intl.DateTimeFormatOptions = {\n        hour: 'numeric',\n        minute: '2-digit',\n        hour12: format === '12',\n      };\n      if (timeZoneId) options.timeZone = timeZoneId;\n      const formatter = new Intl.DateTimeFormat('en-US', options);\n      const formatted = formatter.format(date);\n\n      if (format !== '12') return formatted;\n\n      const parts = formatter.formatToParts(date);\n      const dayPeriod = parts.find((p) => p.type === 'dayPeriod')?.value?.toUpperCase() || '';\n      if (dayPeriod) {\n        return formatted.replace(/(am|pm)/i, dayPeriod);\n      }\n      const hourPart = parts.find((p) => p.type === 'hour')?.value;\n      const hourNumber = hourPart ? parseInt(hourPart, 10) : date.getHours();\n      const suffix = hourNumber >= 12 ? 'PM' : 'AM';\n      return `${formatted} ${suffix}`;\n    };\n\n    const renderTimeDisplay = (details: TimeDetails, format: TimeFormat) => {\n      const timeZoneId = details.timeZoneId || 'UTC';\n      const now = new Date();\n      const collegeTimeStr = formatTimeString(now, format, timeZoneId);\n      const collegeHour = parseInt(\n        now.toLocaleTimeString('en-US', { timeZone: timeZoneId, hour: 'numeric', hour12: false }),\n        10\n      );\n      const collegeTimeZoneAbbr = now\n        .toLocaleTimeString('en-US', { timeZone: timeZoneId, timeZoneName: 'short', hour12: true })\n        .split(' ')\n        .pop();\n      const userTimeStr = formatTimeString(now, format);\n      return `\n        <div>${collegeTimeStr} (${collegeTimeZoneAbbr}) - ${computeTimeOfDay(collegeHour)}</div>\n        <div>Your Time: ${userTimeStr}</div>\n      `;\n    };\n\n    const buildTimeSection = (target: CoordTarget, details: TimeDetails, format: TimeFormat, labelOverride?: string) => {\n      const cacheKey = getTimeCacheKey(target);\n      return `\n        <div class=\"time-info-block\" data-time-cache-key=\"${cacheKey}\">\n          <div style=\"display:flex; align-items:center; justify-content:space-between; gap:6px; flex-wrap:wrap; margin-bottom:4px;\">\n            <b>${labelOverride || details.label}:</b>\n            <label style=\"font-size:0.9em; font-weight:500;\">Format:\n              <select class=\"time-format-select\" data-cache-key=\"${cacheKey}\" style=\"margin-left:4px; padding:2px 6px; border-radius:6px;\">\n                <option value=\"24\"${format === '24' ? ' selected' : ''}>24-hour</option>\n                <option value=\"12\"${format === '12' ? ' selected' : ''}>12-hour</option>\n              </select>\n            </label>\n          </div>\n          <div class=\"time-info-body\" data-cache-key=\"${cacheKey}\">\n            ${renderTimeDisplay(details, format)}\n          </div>\n        </div>\n      `;\n    };\n\n    const fetchCollegeTimeDetails = async (target: CoordTarget, label = 'Time Info'): Promise<TimeDetails | null> => {\n      const cacheKey = getTimeCacheKey(target);\n      if (timeCacheRef.current.has(cacheKey)) return timeCacheRef.current.get(cacheKey)!;\n      if ((!target.lat && !target.lng) || !mapsApiKey) return null;\n\n      const timestamp = Math.floor(Date.now() / 1000);\n      const apiUrl = `https://maps.googleapis.com/maps/api/timezone/json?location=${target.lat},${target.lng}&timestamp=${timestamp}&key=${mapsApiKey}`;\n\n      try {\n        const response = await fetch(apiUrl);\n        const data = await response.json();\n\n        if (data.status !== 'OK') {\n          const fallback: TimeDetails = {\n            timeZoneId: 'UTC',\n            label: `${label} (API Error)`,\n          };\n          timeCacheRef.current.set(cacheKey, fallback);\n          return fallback;\n        }\n\n        const timeZoneId = data.timeZoneId;\n        const details: TimeDetails = {\n          timeZoneId,\n          label,\n        };\n        timeCacheRef.current.set(cacheKey, details);\n        return details;\n      } catch (error) {\n        console.error('Error fetching timezone data:', error);\n        const fallback: TimeDetails = {\n          timeZoneId: 'UTC',\n          label: `${label} (Fetch Error)`,\n        };\n        timeCacheRef.current.set(cacheKey, fallback);\n        return fallback;\n      }\n    };\n\n    const wireTimeDropdown = (target: CoordTarget) => {\n      if (!infowindowRef.current || typeof google === 'undefined') return;\n      const cacheKey = getTimeCacheKey(target);\n      google.maps.event.addListenerOnce(infowindowRef.current, 'domready', () => {\n        const container = document.querySelector('.info-window-content');\n        if (!container) return;\n        const select = container.querySelector<HTMLSelectElement>(`.time-format-select[data-cache-key=\"${cacheKey}\"]`);\n        const body = container.querySelector<HTMLElement>(`.time-info-body[data-cache-key=\"${cacheKey}\"]`);\n        if (!select || !body) return;\n\n        const applyFormat = (format: TimeFormat) => {\n          const details = timeCacheRef.current.get(cacheKey);\n          if (!details) return;\n          body.innerHTML = renderTimeDisplay(details, format);\n        };\n\n        select.value = timeFormatRef.current;\n        applyFormat(timeFormatRef.current);\n\n        const handleChange = (event: Event) => {\n          const newFormat = (event.target as HTMLSelectElement).value === '12' ? '12' : '24';\n          timeFormatRef.current = newFormat;\n          if (typeof window !== 'undefined') {\n            window.localStorage.setItem(TIME_FORMAT_STORAGE_KEY, newFormat);\n          }\n          applyFormat(newFormat);\n        };\n\n        select.addEventListener('change', handleChange);\n        google.maps.event.addListenerOnce(infowindowRef.current, 'closeclick', () => {\n          select.removeEventListener('change', handleChange);\n        });\n      });\n    };\n\n    const fetchCollegeWeatherHTML = async (target: CoordTarget) => {\n      const cacheKey = `${target.lat},${target.lng}`;\n      if (weatherCacheRef.current.has(cacheKey)) return weatherCacheRef.current.get(cacheKey)!;\n      if (!target.lat || !target.lng || target.lat === 0 || target.lng === 0 || !weatherApiKey) return '';\n\n      const apiUrl = `https://api.openweathermap.org/data/2.5/weather?lat=${target.lat}&lon=${target.lng}&appid=${weatherApiKey}&units=imperial`;\n      try {\n        const response = await fetch(apiUrl);\n        if (!response.ok) {\n          console.warn(`OpenWeatherMap API returned status: ${response.status}`);\n          weatherCacheRef.current.set(cacheKey, '');\n          return '';\n        }\n        const data = await response.json();\n        if (data && data.weather && data.weather[0] && data.main) {\n          const description = (data.weather[0].description as string).replace(/\\b\\w/g, (l: string) => l.toUpperCase());\n          const iconCode = data.weather[0].icon;\n          const iconUrl = `https://openweathermap.org/img/wn/${iconCode}@2x.png`;\n          const tempF = Math.round(data.main.temp);\n          const feelsLikeF = Math.round(data.main.feels_like);\n          const tempC = Math.round(((tempF - 32) * 5) / 9);\n          const feelsLikeC = Math.round(((feelsLikeF - 32) * 5) / 9);\n\n          const html = `\n            <div style=\"margin-top: 5px;\">\n              <b>Local Weather:</b>\n              <div style=\"display: flex; align-items: center; margin-top: 3px;\">\n                <img src=\"${iconUrl}\" alt=\"${description}\" title=\"${description}\" style=\"width: 32px; height: 32px; vertical-align: middle; margin-right: 5px; background-color: ${theme === 'dark' ? '#4a5c6e' : '#cde1f9'}; border-radius: 50%;\">\n                <div>\n                  <div style=\"font-weight: bold; font-size: 1.1em;\">${tempC}¬∞C / ${tempF}¬∞F</div>\n                  <div style=\"font-size: 0.9em; color: ${theme === 'dark' ? '#bbb' : '#555'};\">\n                    ${description} (Feels like ${feelsLikeC}¬∞C / ${feelsLikeF}¬∞F)\n                  </div>\n                </div>\n              </div>\n            </div>\n          `;\n          weatherCacheRef.current.set(cacheKey, html);\n          return html;\n        }\n        weatherCacheRef.current.set(cacheKey, '');\n        return '';\n      } catch (error) {\n        console.error('Error fetching weather data:', error);\n        weatherCacheRef.current.set(cacheKey, '');\n        return '';\n      }\n    };\n\n    const haversineDistance = (lat1: number, lon1: number, lat2: number, lon2: number) => {\n      const toRad = (deg: number) => (deg * Math.PI) / 180;\n      const R = 6371000;\n      const dLat = toRad(lat2 - lat1);\n      const dLon = toRad(lon2 - lon1);\n      const a =\n        Math.sin(dLat / 2) * Math.sin(dLat / 2) +\n        Math.cos(toRad(lat1)) * Math.cos(toRad(lat2)) *\n        Math.sin(dLon / 2) * Math.sin(dLon / 2);\n      const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\n      return R * c;\n    };\n\n    const isWithinNYC = (lat: number, lng: number) =>\n      lat >= NYC_BOUNDS.south && lat <= NYC_BOUNDS.north && lng >= NYC_BOUNDS.west && lng <= NYC_BOUNDS.east;\n\n    const fetchNearbyTransitStopsHTML = async (target: CoordTarget & { locationFocus?: string }) => {\n      const cacheKey = `${target.lat},${target.lng}`;\n      if (transitCacheRef.current.has(cacheKey)) return transitCacheRef.current.get(cacheKey)!;\n      if (!google?.maps?.places || !target.lat || !target.lng) return '';\n\n      const ICONS = {\n        BUS: '<img class=\"transit-icon\" alt=\"Bus\" src=\"//maps.gstatic.com/mapfiles/transit/iw2/svg/bus2.svg\">',\n        TRAIN: '<img class=\"transit-icon\" alt=\"Train\" src=\"//maps.gstatic.com/mapfiles/transit/iw2/svg/rail2.svg\">',\n        LIGHT_RAIL: '<img class=\"transit-icon\" alt=\"Light rail\" src=\"//maps.gstatic.com/mapfiles/transit/iw2/svg/tram2.svg\">',\n        SUBWAY: '<img class=\"transit-icon\" alt=\"Subway\" src=\"//maps.gstatic.com/mapfiles/transit/iw2/svg/subway2.svg\">',\n        STREETCAR: '<img class=\"transit-icon\" alt=\"Streetcar\" src=\"//maps.gstatic.com/mapfiles/transit/iw2/svg/cablecar.svg\">',\n        FERRY: '<img class=\"transit-icon\" alt=\"Ferry\" src=\"//maps.gstatic.com/mapfiles/transit/iw2/svg/ferry.svg\">'\n      };\n\n      const getTransitDetails = (types: string[] = [], name = '') => {\n        const lowerName = name.toLowerCase();\n        if (types.includes('ferry_terminal')) return { type: 'Ferry', icon: ICONS.FERRY, labelClass: 'ferry' };\n        if (types.includes('subway_station')) return { type: 'Subway', icon: ICONS.SUBWAY, labelClass: 'subway' };\n        if (types.includes('light_rail_station')) return { type: 'Light Rail', icon: ICONS.LIGHT_RAIL, labelClass: 'light-rail' };\n        if (types.includes('train_station')) return { type: 'Rail', icon: ICONS.TRAIN, labelClass: 'rail' };\n        if (types.includes('bus_station') || types.includes('bus_stop')) return { type: 'Bus', icon: ICONS.BUS, labelClass: 'bus' };\n        if (types.includes('transit_station')) {\n          if (lowerName.includes('streetcar')) return { type: 'Streetcar', icon: ICONS.STREETCAR, labelClass: 'streetcar' };\n          if (lowerName.includes('light rail')) return { type: 'Light Rail', icon: ICONS.LIGHT_RAIL, labelClass: 'light-rail' };\n          return { type: 'Bus', icon: ICONS.BUS, labelClass: 'bus' };\n        }\n        return { type: 'Transit', icon: ICONS.TRAIN, labelClass: 'rail' };\n      };\n\n      const service = new google.maps.places.PlacesService(map);\n      const location = new google.maps.LatLng(target.lat, target.lng);\n\n      const baseRequest: google.maps.places.PlaceSearchRequest = {\n        location,\n        keyword: 'transit subway bus stop rail station light rail ferry terminal',\n        type: 'transit_station',\n      };\n      const request: google.maps.places.PlaceSearchRequest = (target.locationFocus === 'InCityNYC' || isWithinNYC(target.lat, target.lng))\n        ? { ...baseRequest, rankBy: google.maps.places.RankBy.DISTANCE }\n        : { ...baseRequest, radius: 7500 };\n\n      const html = await new Promise<string>((resolve) => {\n        service.nearbySearch(request, (results, status) => {\n          if (status !== google.maps.places.PlacesServiceStatus.OK || !results || results.length === 0) {\n            resolve('');\n            return;\n          }\n\n          const uniqueStops = new Map<string, { place: google.maps.places.PlaceResult; distance: number; typeDetails: { type: string; icon: string; labelClass: string } }>();\n          results.slice(0, 25).forEach((place) => {\n            if (!place.geometry?.location) return;\n            const details = getTransitDetails(place.types || [], place.name || '');\n            const distance = google.maps.geometry?.spherical?.computeDistanceBetween\n              ? google.maps.geometry.spherical.computeDistanceBetween(location, place.geometry.location)\n              : haversineDistance(target.lat, target.lng, place.geometry.location.lat(), place.geometry.location.lng());\n\n            const cleanName = (place.name || '').replace(/\\s*\\([^)]+\\)$/, '').trim();\n            const groupKey = `${cleanName}|${details.type}`;\n            if (!uniqueStops.has(groupKey) || distance < uniqueStops.get(groupKey)!.distance) {\n              uniqueStops.set(groupKey, { place, distance, typeDetails: details });\n            }\n          });\n\n          const stops = Array.from(uniqueStops.values()).sort((a, b) => a.distance - b.distance).slice(0, 5);\n          if (stops.length === 0) {\n            resolve('');\n            return;\n          }\n\n          let htmlString = '<b>Nearby Transit Stops:</b><ol style=\"margin-top: 3px; margin-bottom: 3px; padding-left: 22px; list-style: decimal;\">';\n          stops.forEach(({ place, distance, typeDetails }) => {\n            const miles = distance * 0.000621371;\n            const km = distance / 1000;\n            const milesFormatted = miles < 1 ? miles.toFixed(2) : miles.toFixed(1);\n            const kmFormatted = km < 1 ? km.toFixed(2) : km.toFixed(1);\n            const gmapsUrl = `https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(place.name || '')}&query_place_id=${place.place_id}`;\n            const labelHtml = `<span class=\"transit-label ${typeDetails.labelClass}\">${typeDetails.type}</span>`;\n\n            htmlString += `\n              <li style=\"margin-bottom:4px;\">\n                ${typeDetails.icon}\n                <a href=\"${gmapsUrl}\" target=\"_blank\" rel=\"noreferrer\" class=\"transit-stop-link\">\n                  ${labelHtml}\n                  ${place.name || 'Transit Stop'}\n                </a>\n                <br><small style=\"padding-left: 20px; color: ${theme === 'dark' ? '#bbb' : '#555'};\">(${milesFormatted} mi / ${kmFormatted} km away)</small>\n              </li>\n            `;\n          });\n          htmlString += '</ol>';\n          resolve(htmlString);\n        });\n      });\n\n      transitCacheRef.current.set(cacheKey, html);\n      return html;\n    };\n\n    const buildInfoWindowContent = async (student: ProcessedStudent) => {\n      let contentString = `<div class=\"info-window-content\">`;\n      const targetUrl = student.collegeHomepageUrl && student.collegeHomepageUrl !== '#' ? student.collegeHomepageUrl : '#';\n      const openInNewTab = targetUrl !== '#' ? 'target=\"_blank\" rel=\"noreferrer\"' : '';\n\n      const badges = createHonoraryIcons(student.honoraries);\n      const collegeTypeChipClasses: Record<string, string> = {\n        'Ivy League': 'chip-ivy',\n        SUNY: 'chip-suny',\n        CUNY: 'chip-cuny',\n        'Purdue University System': 'chip-purdue',\n      };\n\n      if (student.collegeImageUrl && student.collegeImageUrl !== 'x' && !student.collegeImageUrl.toLowerCase().includes('placeholder')) {\n        contentString += `<a href=\"${targetUrl}\" ${openInNewTab}><img src=\"${student.collegeImageUrl}\" alt=\"${student.collegeName} logo/photo\" style=\"max-width: 180px; max-height: 120px; display: block; margin: 0 auto 10px auto; border-radius: 6px; object-fit: contain;\"></a>`;\n      }\n      if (targetUrl !== '#') {\n        contentString += `<b><a href=\"${targetUrl}\" ${openInNewTab}>${student.collegeName}</a></b>`;\n      } else {\n        contentString += `<b>${student.collegeName}</b>`;\n      }\n\n      const campusType = student.isCampusPublic ? 'Public' : 'Private';\n      const focusLabel = formatLocationFocus(student.locationFocus);\n      const typeParts: string[] = [];\n      const typeClass = collegeTypeChipClasses[student.collegeType] || 'chip-generic-type';\n      if (student.collegeType !== 'Other Public' && student.collegeType !== 'Other Private') {\n        typeParts.push(renderChip(student.collegeType, typeClass));\n      }\n      const campusClass = campusType === 'Public' ? 'chip-public' : 'chip-private';\n      typeParts.push(renderChip(campusType, campusClass));\n      const focusClass = locationFocusChipClasses[student.locationFocus] || 'muted';\n      typeParts.push(renderChip(focusLabel, focusClass));\n      contentString += `<div style=\"margin-top: 4px; line-height: 1.6;\">`;\n      contentString += `<div><b>Type:</b> ${typeParts.join(' ')}</div>`;\n      if (student.lat !== 0 || student.lng !== 0) {\n        contentString += `<div><a href=\"https://www.google.com/maps/dir/?api=1&destination=${student.lat},${student.lng}\" target=\"_blank\" rel=\"noreferrer\">Get Directions</a></div>`;\n      }\n      contentString += `</div>`;\n\n      const timeDetails = await fetchCollegeTimeDetails(student);\n      if (timeDetails) contentString += `<hr style=\"margin: 5px 0;\">${buildTimeSection(student, timeDetails, timeFormatRef.current)}`;\n\n      const weatherHtml = await fetchCollegeWeatherHTML(student);\n      if (weatherHtml) contentString += `<hr style=\"margin: 5px 0;\">${weatherHtml}`;\n\n      contentString += `<hr style=\"margin: 5px 0;\">`;\n      contentString += buildStudentsHtml(student);\n\n      const transitHtml = await fetchNearbyTransitStopsHTML(student);\n      if (transitHtml) contentString += `<hr style=\"margin: 5px 0;\">${transitHtml}`;\n\n      contentString += `</div>`;\n      return contentString;\n    };\n\n    const buildNestmInfoContent = async (detail: NestmInfoDetail) => {\n      const {\n        coords,\n        name = 'NEST+m',\n        homepageUrl = 'https://nestmk12.net/',\n        imageUrl = '/logos/NEST+m_Logo.png',\n        typeLabel = 'Public K-12 School',\n        locationFocus = 'InCityNYC',\n      } = detail;\n\n      let contentString = `<div class=\"info-window-content\">`;\n      if (imageUrl) {\n        const openInNewTab = homepageUrl ? 'target=\"_blank\" rel=\"noreferrer\"' : '';\n        const wrapStart = homepageUrl ? `<a href=\"${homepageUrl}\" ${openInNewTab}>` : '';\n        const wrapEnd = homepageUrl ? '</a>' : '';\n        contentString += `${wrapStart}<img src=\"${imageUrl}\" alt=\"${name} Logo\" style=\"max-width: 180px; max-height: 120px; display: block; margin: 0 auto 10px auto; border-radius: 6px; object-fit: contain;\">${wrapEnd}`;\n      }\n\n      if (homepageUrl) {\n        contentString += `<b><a href=\"${homepageUrl}\" target=\"_blank\" rel=\"noreferrer\">${name}</a></b>`;\n      } else {\n        contentString += `<b>${name}</b>`;\n      }\n\n      const chips: string[] = [];\n      chips.push(renderChip(typeLabel, 'chip-public'));\n      const focusClass = locationFocusChipClasses[locationFocus] || 'muted';\n      const focusLabel = formatLocationFocus(locationFocus);\n      chips.push(renderChip(focusLabel === 'NYC' ? 'NYC' : focusLabel, focusClass));\n      contentString += `<div style=\"margin-top: 4px; line-height: 1.6;\">`;\n      contentString += `<div><b>Type:</b> ${chips.join(' ')}</div>`;\n      contentString += `<div><a href=\"https://www.google.com/maps/dir/?api=1&destination=${coords.lat},${coords.lng}\" target=\"_blank\" rel=\"noreferrer\">Get Directions</a></div>`;\n      contentString += `</div>`;\n\n      const timeDetails = await fetchCollegeTimeDetails(coords, `${name} Time`);\n      if (timeDetails) contentString += `<hr style=\"margin: 5px 0;\">${buildTimeSection(coords, timeDetails, timeFormatRef.current, timeDetails.label)}`;\n\n      const weatherHtml = await fetchCollegeWeatherHTML(coords);\n      if (weatherHtml) contentString += `<hr style=\"margin: 5px 0;\">${weatherHtml}`;\n\n      const transitHtml = await fetchNearbyTransitStopsHTML({ ...coords, locationFocus });\n      if (transitHtml) contentString += `<hr style=\"margin: 5px 0;\">${transitHtml}`;\n\n      contentString += `</div>`;\n      return contentString;\n    };\n\n    const openStudentInfo = async (\n      student: ProcessedStudent,\n      marker: any | null,\n      positionOverride?: google.maps.LatLng | { lat: number; lng: number }\n    ) => {\n      if (!infowindowRef.current) return;\n      lastInfoWindowStudentIdRef.current = student.id;\n\n      const position =\n        positionOverride ||\n        marker?.getPosition?.() ||\n        (student.lat && student.lng ? new google.maps.LatLng(student.lat, student.lng) : null);\n\n      const html = await buildInfoWindowContent(student);\n      if (infowindowRef.current && lastInfoWindowStudentIdRef.current === student.id) {\n        infowindowRef.current.setContent(html);\n        if (position) {\n          infowindowRef.current.setPosition(position);\n        }\n        if (marker) {\n          infowindowRef.current.open({ map, anchor: marker });\n        } else if (position) {\n          infowindowRef.current.open({ map, position });\n        } else {\n          infowindowRef.current.open(map);\n        }\n        wireTimeDropdown(student);\n      }\n    };\n\n    // Scatter overlapping coordinates so markers don't perfectly overlap\n    const assignedCoordinatesCount: Record<string, number> = {};\n\n    students.forEach((student) => {\n        if (student.lat === 0 && student.lng === 0) return;\n        if (student.collegeName === \"Undecided\") return; \n\n        const color = GRAD_CLASS_COLORS[student.gradClass] || \"#cccccc\";\n\n        let lat = student.lat;\n        let lng = student.lng;\n        const coordKey = `${student.lat},${student.lng}`;\n        if (student.lat !== 0 || student.lng !== 0) {\n          if (assignedCoordinatesCount[coordKey]) {\n            const count = assignedCoordinatesCount[coordKey];\n            const offsetMagnitude = 0.00002 * Math.sqrt(count);\n            const angleIncrement = Math.PI / 3;\n            const angle = count * angleIncrement;\n            lat += offsetMagnitude * Math.cos(angle);\n            lng += offsetMagnitude * Math.sin(angle);\n            assignedCoordinatesCount[coordKey] = count + 1;\n          } else {\n            assignedCoordinatesCount[coordKey] = 1;\n          }\n        }\n        \n        const marker = new google.maps.Marker({\n            position: { lat, lng },\n            title: `${student.seniorName} -> ${student.collegeName}`,\n            icon: buildIcon(color)\n        });\n\n        marker.addListener(\"click\", () => {\n             // Open InfoWindow\n             openStudentInfo(student, marker);\n             // Trigger sidebar focus + popup sync\n             window.dispatchEvent(new CustomEvent('focus-student-from-map', { detail: { id: student.id } }));\n             setActiveHoverId(student.id);\n        });\n\n        marker.addListener(\"mouseover\", () => {\n           setActiveHoverId(student.id);\n        });\n\n        marker.addListener(\"mouseout\", () => {\n           setActiveHoverId(null);\n        });\n\n        newMarkers.push(marker);\n        markersRef.current[student.id] = { marker, color };\n    });\n\n    clustererRef.current.addMarkers(newMarkers);\n    const durationMs = (typeof performance !== 'undefined' ? performance.now() : Date.now()) - buildStart;\n    debugLog('Added markers to clusterer', {\n      added: newMarkers.length,\n      clusterCount: clustererRef.current.getMarkers?.().length,\n      durationMs: Math.round(durationMs),\n    });\n\n    const handleOpenNestmInfo = (ev: Event) => {\n      const { detail } = ev as CustomEvent<NestmInfoDetail>;\n      if (!detail || !detail.marker || !infowindowRef.current || !detail.coords) return;\n      lastInfoWindowStudentIdRef.current = null;\n      infowindowRef.current.close();\n      infowindowRef.current.setContent(\n        `<div class=\"info-window-content\"><b>${detail.name || 'NEST+m'}</b><div style=\"margin-top:4px;\">Loading details...</div></div>`\n      );\n      infowindowRef.current.open(map, detail.marker);\n\n      buildNestmInfoContent(detail).then((html) => {\n        if (infowindowRef.current) {\n          infowindowRef.current.setContent(html);\n          infowindowRef.current.open(map, detail.marker);\n          wireTimeDropdown(detail.coords);\n        }\n      });\n    };\n\n    const handleCenterEvent = (e: CustomEvent<{ id: number; lat?: number; lng?: number }>) => {\n      const targetStudent = students.find((s) => s.id === e.detail.id);\n      if (!targetStudent) return;\n\n      const target = markersRef.current[e.detail.id];\n      const positionExplicit =\n        e.detail.lat && e.detail.lng ? new google.maps.LatLng(e.detail.lat, e.detail.lng) : null;\n      const position =\n        positionExplicit ||\n        target?.marker?.getPosition?.() ||\n        (targetStudent.lat && targetStudent.lng\n          ? new google.maps.LatLng(targetStudent.lat, targetStudent.lng)\n          : null);\n\n      if (map && position) {\n        map.panTo(position);\n        const desiredZoom = 14;\n        map.setZoom(desiredZoom);\n      }\n\n      if (target) {\n        openStudentInfo(targetStudent, target.marker, position);\n      } else if (position && typeof google !== 'undefined') {\n        const tempMarker = new google.maps.Marker({ position, map });\n        openStudentInfo(targetStudent, tempMarker, position);\n        setTimeout(() => tempMarker.setMap(null), 600);\n      }\n\n      debugLog('center-student-marker event', {\n        id: e.detail.id,\n        hadMarker: !!target,\n        usedExplicitPosition: !!positionExplicit,\n      });\n\n      setActiveHoverId(e.detail.id);\n    };\n\n    window.addEventListener('center-student-marker', handleCenterEvent as EventListener);\n    window.addEventListener('open-nestm-info', handleOpenNestmInfo as EventListener);\n    return () => {\n      window.removeEventListener('center-student-marker', handleCenterEvent as EventListener);\n      window.removeEventListener('open-nestm-info', handleOpenNestmInfo as EventListener);\n    };\n\n  }, [map, students, theme, setActiveHoverId]);\n\n  return null;\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;AAEA;AACA;AACA;;;;;;;AA2BA,MAAM,0BAA0B;AAEhC,MAAM,uBAAuB;IAC3B,IAAI,QAAQ,GAAG,CAAC,wBAAwB,KAAK,QAAQ,OAAO;IAC5D;;IAGA,OAAO;AACT;AAEA,MAAM,WAAW,CAAC,GAAG;IACnB,IAAI,wBAAwB;QAC1B,QAAQ,KAAK,CAAC,mBAAmB;IACnC;AACF;AAEe,SAAS,WAAW,EAAE,QAAQ,EAAmB;IAC9D,MAAM,MAAM,IAAA,4LAAM;IAClB,MAAM,EAAE,KAAK,EAAE,GAAG,IAAA,4IAAQ;IAC1B,MAAM,EAAE,aAAa,EAAE,gBAAgB,EAAE,GAAG,IAAA,sIAAK;IACjD,MAAM,eAAe,IAAA,+MAAM,EAAyB;IACpD,MAAM,aAAa,IAAA,+MAAM,EAAmD,CAAC;IAC7E,MAAM,gBAAgB,IAAA,+MAAM,EAAa;IACzC,MAAM,qBAAqB,IAAA,+MAAM,EAAgB;IACjD,MAAM,6BAA6B,IAAA,+MAAM,EAAgB;IACzD,MAAM,eAAe,IAAA,+MAAM,EAA2B,IAAI;IAC1D,MAAM,kBAAkB,IAAA,+MAAM,EAAsB,IAAI;IACxD,MAAM,kBAAkB,IAAA,+MAAM,EAAsB,IAAI;IACxD,MAAM,gBAAgB,IAAA,+MAAM,EAAa;IACzC,MAAM,qBAAqB,IAAA,+MAAM,EAKvB;IACV,MAAM,2BAAmD;QACvD,WAAW;QACX,gBAAgB;QAChB,cAAc;QACd,eAAe;QACf,OAAO;IACT;IAEA,MAAM,aAAa,CAAC,OAAe,aAAa,EAAE,GAChD,CAAC,sBAAsB,EAAE,aAAa,CAAC,CAAC,EAAE,YAAY,GAAG,GAAG,EAAE,EAAE,MAAM,OAAO,CAAC;IAEhF,MAAM,YAAY,CAAC,OAAe,QAAQ,CAAC,EAAE,eAAe,GAAG,GAAK,CAAC;YACnE,MAAM,OAAO,IAAI,CAAC,UAAU,CAAC,MAAM;YACnC,WAAW;YACX,aAAa;YACb,aAAa,UAAU,SAAS,SAAS;YACzC;YACA;QACF,CAAC;IAED,6BAA6B;IAC7B,IAAA,kNAAS,EAAC;QACR,OAAO;YACL,IAAI,aAAa,OAAO,EAAE;gBACxB,aAAa,OAAO,CAAC,YAAY;YACnC;QACF;IACF,GAAG,EAAE;IAEL,8BAA8B;IAC9B,IAAA,kNAAS,EAAC;QACP,IAAI,OAAO,WAAW,aAAa;QACnC,IAAI,CAAC,cAAc,OAAO,EAAE;YACxB,cAAc,OAAO,GAAG,IAAI,OAAO,IAAI,CAAC,UAAU;QACtD;IACH,GAAG,EAAE;IAEL,IAAA,kNAAS,EAAC;QACR,wCAAmC;;;QACnC,MAAM;IAIR,GAAG,EAAE;IAEL,uDAAuD;IACvD,IAAA,kNAAS,EAAC;QACR,IAAI,OAAO,WAAW,aAAa;QACnC,SAAS,0BAA0B;YACjC;YACA,qBAAqB,mBAAmB,OAAO;QACjD;QAEA,4BAA4B;QAC5B,IAAI,mBAAmB,OAAO,KAAK,MAAM;YACvC,MAAM,WAAW,WAAW,OAAO,CAAC,mBAAmB,OAAO,CAAC;YAC/D,IAAI,UAAU;gBACZ,SAAS,MAAM,CAAC,OAAO,CAAC,UAAU,SAAS,KAAK;YAClD;QACF;QAEA,sBAAsB;QACtB,IAAI,kBAAkB,MAAM;YAC1B,MAAM,UAAU,WAAW,OAAO,CAAC,cAAc;YACjD,IAAI,SAAS;gBACX,QAAQ,MAAM,CAAC,OAAO,CAAC,UAAU,QAAQ,KAAK,EAAE,GAAG;gBACnD,mBAAmB,OAAO,GAAG;gBAC7B;YACF;QACF;QAEA,mBAAmB,OAAO,GAAG;IAC/B,GAAG;QAAC;QAAe;KAAM;IAEzB,IAAA,kNAAS,EAAC;QACR,IAAI,CAAC,OAAO,OAAO,WAAW,aAAa;QAC3C,MAAM,aAAa,OAAO,gBAAgB,cAAc,YAAY,GAAG,KAAK,KAAK,GAAG;QACpF,MAAM,UAAoB,EAAE;QAC5B,MAAM,WAAW,mBAAmB,OAAO;QAC3C,IAAI,CAAC,UAAU;YACb,QAAQ,IAAI,CAAC;QACf,OAAO;YACL,IAAI,SAAS,GAAG,KAAK,KAAK,QAAQ,IAAI,CAAC;YACvC,IAAI,SAAS,WAAW,KAAK,UAAU,QAAQ,IAAI,CAAC;YACpD,IAAI,SAAS,cAAc,KAAK,SAAS,MAAM,EAAE;gBAC/C,QAAQ,IAAI,CAAC,CAAC,gBAAgB,EAAE,SAAS,cAAc,CAAC,IAAI,EAAE,SAAS,MAAM,EAAE;YACjF;YACA,IAAI,SAAS,KAAK,KAAK,OAAO,QAAQ,IAAI,CAAC,CAAC,MAAM,EAAE,SAAS,KAAK,CAAC,IAAI,EAAE,OAAO;QAClF;QAEA,mBAAmB,OAAO,GAAG;YAC3B;YACA,aAAa;YACb,gBAAgB,SAAS,MAAM;YAC/B;QACF;QACA,SAAS,sBAAsB;YAAE;YAAS,gBAAgB,SAAS,MAAM;YAAE;QAAM;QAEjF,IAAI,CAAC,aAAa,OAAO,EAAE;YACzB,aAAa,OAAO,GAAG,IAAI,2LAAe,CAAC;gBACvC;gBACA,UAAU;oBACR,QAAQ,CAAC,EAAE,KAAK,EAAE,QAAQ,EAAE;wBACxB,IAAI,QAAQ;wBACZ,IAAI,WAAW;wBACf,IAAI,aAAa;wBAEjB,IAAI,SAAS,GAAG;4BAAE,QAAQ;4BAAS,WAAW;wBAAI,OAC7C,IAAI,SAAS,IAAI;4BAAE,QAAQ;4BAAW,WAAW;4BAAI,aAAa;wBAAS,OAC3E,IAAI,SAAS,IAAI;4BAAE,QAAQ;4BAAU,WAAW;4BAAI,aAAa;wBAAS,OAC1E,IAAI,SAAS,IAAI;4BAAE,QAAQ;4BAAU,WAAW;wBAAI;wBAEzD,MAAM,MAAM,OAAO,IAAI,CAAC,CAAC;+DACsB,EAAE,SAAS,UAAU,EAAE,SAAS,eAAe,EAAE,SAAS,CAAC,EAAE,SAAS;gCACrG,EAAE,WAAW,EAAE,MAAM,EAAE,WAAW,EAAE,KAAK,EAAE,WAAW,IAAI,IAAI,QAAQ,EAAE,MAAM,yCAAyC,EAAE,KAAK,GAAG,CAAC,GAAG,WAAW,MAAM;sBAChK,CAAC;wBAEP,OAAO,IAAI,OAAO,IAAI,CAAC,MAAM,CAAC;4BAC1B;4BACA,MAAM;gCACF,KAAK,CAAC,0BAA0B,EAAE,KAAK;gCACvC,YAAY,IAAI,OAAO,IAAI,CAAC,IAAI,CAAC,UAAU;gCAC3C,QAAQ,IAAI,OAAO,IAAI,CAAC,KAAK,CAAC,WAAW,GAAG,WAAW;4BAC3D;4BACA,OAAO;gCACH,MAAM,OAAO;gCACb,OAAO;gCACP,UAAU;gCACV,YAAY;4BAChB;4BACA,QAAQ,MAAM;wBAClB;oBACJ;gBACF;YACJ;YACA,SAAS;QACX;QAEA,MAAM,gBAAgB,aAAa,OAAO,CAAC,UAAU,KAAK;QAC1D,aAAa,OAAO,CAAC,YAAY;QACjC,SAAS,6BAA6B;YAAE;QAAc;QACtD,WAAW,OAAO,GAAG,CAAC;QACtB,mBAAmB,OAAO,GAAG;QAE7B,MAAM;QACN,MAAM;QACN,MAAM,aAAoB,EAAE;QAE5B,MAAM,sBAAsB,CAAC,UAA+C,OAAO,EAAE;YACnF,MAAM,SAAS,aAAa,YAAY,UAAU,SAAS,uBAAuB;YAClF,OAAO,CAAC,iBAAiB,EAAE,SAAS,WAAW,EAAE,SAAS,eAAe,EAAE,KAAK,UAAU,EAAE,KAAK,yBAAyB,EAAE,OAAO,IAAI,CAAC;QAC1I;QAEA,MAAM,sBAAsB,CAAC;YAC3B,IAAI,CAAC,cAAc,WAAW,MAAM,KAAK,GAAG,OAAO;YACnD,MAAM,QAAgC;gBACpC,eAAe;gBACf,UAAU;gBACV,OAAO;gBACP,aAAa;YACf;YACA,OAAO,WACJ,GAAG,CAAC,CAAC;gBACJ,IAAI,CAAC,KAAK,CAAC,EAAE,EAAE,OAAO;gBACtB,MAAM,QAAQ,MAAM,UAAU,KAAK;gBACnC,OAAO,CAAC,UAAU,EAAE,KAAK,CAAC,EAAE,CAAC,OAAO,EAAE,EAAE,2BAA2B,EAAE,MAAM,2CAA2C,CAAC;YACzH,GACC,IAAI,CAAC;QACV;QAEA,MAAM,cAAc,CAAC;YACnB,MAAM,QAAQ,KAAK,IAAI,GAAG,KAAK,CAAC;YAChC,OAAO,MAAM,MAAM,GAAG,IAAI,KAAK,CAAC,MAAM,MAAM,GAAG,EAAE,GAAG;QACtD;QAEA,MAAM,eAAe,CAAC;YACpB,MAAM,QAAQ,KAAK,IAAI,GAAG,KAAK,CAAC;YAChC,OAAO,KAAK,CAAC,EAAE,IAAI;QACrB;QAEA,MAAM,sBAAsB,CAAC;YAC3B,MAAM,SAAiC;gBACrC,WAAW;gBACX,gBAAgB;gBAChB,cAAc;gBACd,eAAe;gBACf,OAAO;YACT;YACA,OAAO,MAAM,CAAC,MAAM,IAAI,SAAS;QACnC;QAEA,MAAM,oBAAoB,CAAC;YACzB,IAAI,QAAQ,WAAW,KAAK,aAAa;gBACvC,OAAO,CAAC;aACH,EAAE,QAAQ,UAAU,CAAC;6BACL,EAAE,4IAAiB,CAAC,QAAQ,SAAS,CAAC,IAAI,OAAO,WAAW,EAAE,QAAQ,SAAS,CAAC;6BAChF,EAAE,QAAQ,KAAK,IAAI,YAAY,EAAE,EAAE,QAAQ,SAAS,IAAI,MAAM;cAC7E,CAAC;YACT;YAEA,MAAM,wBAAwB,SAC3B,MAAM,CACL,CAAC,IACC,EAAE,WAAW,KAAK,QAAQ,WAAW,IACrC,EAAE,WAAW,KAAK,eAClB,EAAE,qBAAqB,EAE1B,IAAI,CAAC,CAAC,GAAG;gBACR,IAAI,EAAE,SAAS,KAAK,EAAE,SAAS,EAAE,OAAO,EAAE,SAAS,CAAC,aAAa,CAAC,EAAE,SAAS;gBAC7E,MAAM,cAAc,YAAY,EAAE,UAAU,EAAE,aAAa,CAAC,YAAY,EAAE,UAAU;gBACpF,IAAI,gBAAgB,GAAG,OAAO;gBAC9B,OAAO,aAAa,EAAE,UAAU,EAAE,aAAa,CAAC,aAAa,EAAE,UAAU;YAC3E;YAEF,IAAI,sBAAsB,MAAM,KAAK,GAAG;gBACtC,OAAO;YACT;YAEA,MAAM,cAAc,sBAAsB,MAAM,KAAK,IAAI,YAAY;YACrE,IAAI,OAAO,CAAC,GAAG,EAAE,sBAAsB,MAAM,CAAC,CAAC,EAAE,YAAY,iHAAiH,CAAC;YAC/K,sBAAsB,OAAO,CAAC,CAAC;gBAC7B,MAAM,UAAU,CAAC;UACf,EAAE,EAAE,WAAW,GAAG,CAAC,SAAS,EAAE,EAAE,WAAW,CAAC,4DAA4D,EAAE,oBAAoB,YAAY,IAAI,CAAC,GAAG,GAAG;UACrJ,EAAE,EAAE,YAAY,GAAG,CAAC,SAAS,EAAE,EAAE,YAAY,CAAC,4DAA4D,EAAE,oBAAoB,aAAa,IAAI,CAAC,GAAG,GAAG;UACxJ,EAAE,EAAE,SAAS,GAAG,CAAC,SAAS,EAAE,EAAE,SAAS,CAAC,4DAA4D,EAAE,oBAAoB,UAAU,IAAI,CAAC,GAAG,GAAG;QACjJ,CAAC;gBACD,MAAM,SAAS,oBAAoB,EAAE,UAAU;gBAC/C,QAAQ,CAAC;;YAEL,EAAE,EAAE,UAAU,CAAC,oBAAoB,EAAE,4IAAiB,CAAC,EAAE,SAAS,CAAC,IAAI,OAAO,IAAI,EAAE,EAAE,SAAS,CAAC;YAChG,EAAE,OAAO;YACT,EAAE,QAAQ;;mDAE6B,EAAE,EAAE,KAAK,IAAI,YAAY,EAAE,EAAE,EAAE,SAAS,IAAI,MAAM;aACxF,CAAC;YACR;YACA,QAAQ;YACR,OAAO;QACT;QAEA,MAAM,mBAAmB,CAAC;YACxB,IAAI,eAAe,KAAK,cAAc,GAAG,OAAO;YAChD,IAAI,eAAe,KAAK,cAAc,GAAG,OAAO;YAChD,IAAI,eAAe,KAAK,cAAc,IAAI,OAAO;YACjD,IAAI,eAAe,MAAM,cAAc,IAAI,OAAO;YAClD,IAAI,eAAe,MAAM,cAAc,IAAI,OAAO;YAClD,IAAI,eAAe,MAAM,cAAc,IAAI,OAAO;YAClD,IAAI,eAAe,MAAM,cAAc,IAAI,OAAO;YAClD,OAAO;QACT;QAEA,MAAM,kBAAkB,CAAC,SAAwB,GAAG,OAAO,GAAG,CAAC,CAAC,EAAE,OAAO,GAAG,EAAE;QAE9E,MAAM,mBAAmB,CAAC,MAAY,QAAoB;YACxD,MAAM,UAAsC;gBAC1C,MAAM;gBACN,QAAQ;gBACR,QAAQ,WAAW;YACrB;YACA,IAAI,YAAY,QAAQ,QAAQ,GAAG;YACnC,MAAM,YAAY,IAAI,KAAK,cAAc,CAAC,SAAS;YACnD,MAAM,YAAY,UAAU,MAAM,CAAC;YAEnC,IAAI,WAAW,MAAM,OAAO;YAE5B,MAAM,QAAQ,UAAU,aAAa,CAAC;YACtC,MAAM,YAAY,MAAM,IAAI,CAAC,CAAC,IAAM,EAAE,IAAI,KAAK,cAAc,OAAO,iBAAiB;YACrF,IAAI,WAAW;gBACb,OAAO,UAAU,OAAO,CAAC,YAAY;YACvC;YACA,MAAM,WAAW,MAAM,IAAI,CAAC,CAAC,IAAM,EAAE,IAAI,KAAK,SAAS;YACvD,MAAM,aAAa,WAAW,SAAS,UAAU,MAAM,KAAK,QAAQ;YACpE,MAAM,SAAS,cAAc,KAAK,OAAO;YACzC,OAAO,GAAG,UAAU,CAAC,EAAE,QAAQ;QACjC;QAEA,MAAM,oBAAoB,CAAC,SAAsB;YAC/C,MAAM,aAAa,QAAQ,UAAU,IAAI;YACzC,MAAM,MAAM,IAAI;YAChB,MAAM,iBAAiB,iBAAiB,KAAK,QAAQ;YACrD,MAAM,cAAc,SAClB,IAAI,kBAAkB,CAAC,SAAS;gBAAE,UAAU;gBAAY,MAAM;gBAAW,QAAQ;YAAM,IACvF;YAEF,MAAM,sBAAsB,IACzB,kBAAkB,CAAC,SAAS;gBAAE,UAAU;gBAAY,cAAc;gBAAS,QAAQ;YAAK,GACxF,KAAK,CAAC,KACN,GAAG;YACN,MAAM,cAAc,iBAAiB,KAAK;YAC1C,OAAO,CAAC;aACD,EAAE,eAAe,EAAE,EAAE,oBAAoB,IAAI,EAAE,iBAAiB,aAAa;wBAClE,EAAE,YAAY;MAChC,CAAC;QACH;QAEA,MAAM,mBAAmB,CAAC,QAAqB,SAAsB,QAAoB;YACvF,MAAM,WAAW,gBAAgB;YACjC,OAAO,CAAC;0DAC4C,EAAE,SAAS;;eAEtD,EAAE,iBAAiB,QAAQ,KAAK,CAAC;;iEAEiB,EAAE,SAAS;kCAC1C,EAAE,WAAW,OAAO,cAAc,GAAG;kCACrC,EAAE,WAAW,OAAO,cAAc,GAAG;;;;sDAIjB,EAAE,SAAS;YACrD,EAAE,kBAAkB,SAAS,QAAQ;;;MAG3C,CAAC;QACH;QAEA,MAAM,0BAA0B,OAAO,QAAqB,QAAQ,WAAW;YAC7E,MAAM,WAAW,gBAAgB;YACjC,IAAI,aAAa,OAAO,CAAC,GAAG,CAAC,WAAW,OAAO,aAAa,OAAO,CAAC,GAAG,CAAC;YACxE,IAAI,AAAC,CAAC,OAAO,GAAG,IAAI,CAAC,OAAO,GAAG,IAAK,CAAC,YAAY,OAAO;YAExD,MAAM,YAAY,KAAK,KAAK,CAAC,KAAK,GAAG,KAAK;YAC1C,MAAM,SAAS,CAAC,4DAA4D,EAAE,OAAO,GAAG,CAAC,CAAC,EAAE,OAAO,GAAG,CAAC,WAAW,EAAE,UAAU,KAAK,EAAE,YAAY;YAEjJ,IAAI;gBACF,MAAM,WAAW,MAAM,MAAM;gBAC7B,MAAM,OAAO,MAAM,SAAS,IAAI;gBAEhC,IAAI,KAAK,MAAM,KAAK,MAAM;oBACxB,MAAM,WAAwB;wBAC5B,YAAY;wBACZ,OAAO,GAAG,MAAM,YAAY,CAAC;oBAC/B;oBACA,aAAa,OAAO,CAAC,GAAG,CAAC,UAAU;oBACnC,OAAO;gBACT;gBAEA,MAAM,aAAa,KAAK,UAAU;gBAClC,MAAM,UAAuB;oBAC3B;oBACA;gBACF;gBACA,aAAa,OAAO,CAAC,GAAG,CAAC,UAAU;gBACnC,OAAO;YACT,EAAE,OAAO,OAAO;gBACd,QAAQ,KAAK,CAAC,iCAAiC;gBAC/C,MAAM,WAAwB;oBAC5B,YAAY;oBACZ,OAAO,GAAG,MAAM,cAAc,CAAC;gBACjC;gBACA,aAAa,OAAO,CAAC,GAAG,CAAC,UAAU;gBACnC,OAAO;YACT;QACF;QAEA,MAAM,mBAAmB,CAAC;YACxB,IAAI,CAAC,cAAc,OAAO,IAAI,OAAO,WAAW,aAAa;YAC7D,MAAM,WAAW,gBAAgB;YACjC,OAAO,IAAI,CAAC,KAAK,CAAC,eAAe,CAAC,cAAc,OAAO,EAAE,YAAY;gBACnE,MAAM,YAAY,SAAS,aAAa,CAAC;gBACzC,IAAI,CAAC,WAAW;gBAChB,MAAM,SAAS,UAAU,aAAa,CAAoB,CAAC,oCAAoC,EAAE,SAAS,EAAE,CAAC;gBAC7G,MAAM,OAAO,UAAU,aAAa,CAAc,CAAC,gCAAgC,EAAE,SAAS,EAAE,CAAC;gBACjG,IAAI,CAAC,UAAU,CAAC,MAAM;gBAEtB,MAAM,cAAc,CAAC;oBACnB,MAAM,UAAU,aAAa,OAAO,CAAC,GAAG,CAAC;oBACzC,IAAI,CAAC,SAAS;oBACd,KAAK,SAAS,GAAG,kBAAkB,SAAS;gBAC9C;gBAEA,OAAO,KAAK,GAAG,cAAc,OAAO;gBACpC,YAAY,cAAc,OAAO;gBAEjC,MAAM,eAAe,CAAC;oBACpB,MAAM,YAAY,AAAC,MAAM,MAAM,CAAuB,KAAK,KAAK,OAAO,OAAO;oBAC9E,cAAc,OAAO,GAAG;oBACxB;;oBAGA,YAAY;gBACd;gBAEA,OAAO,gBAAgB,CAAC,UAAU;gBAClC,OAAO,IAAI,CAAC,KAAK,CAAC,eAAe,CAAC,cAAc,OAAO,EAAE,cAAc;oBACrE,OAAO,mBAAmB,CAAC,UAAU;gBACvC;YACF;QACF;QAEA,MAAM,0BAA0B,OAAO;YACrC,MAAM,WAAW,GAAG,OAAO,GAAG,CAAC,CAAC,EAAE,OAAO,GAAG,EAAE;YAC9C,IAAI,gBAAgB,OAAO,CAAC,GAAG,CAAC,WAAW,OAAO,gBAAgB,OAAO,CAAC,GAAG,CAAC;YAC9E,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,OAAO,GAAG,IAAI,OAAO,GAAG,KAAK,KAAK,OAAO,GAAG,KAAK,KAAK,CAAC,eAAe,OAAO;YAEjG,MAAM,SAAS,CAAC,oDAAoD,EAAE,OAAO,GAAG,CAAC,KAAK,EAAE,OAAO,GAAG,CAAC,OAAO,EAAE,cAAc,eAAe,CAAC;YAC1I,IAAI;gBACF,MAAM,WAAW,MAAM,MAAM;gBAC7B,IAAI,CAAC,SAAS,EAAE,EAAE;oBAChB,QAAQ,IAAI,CAAC,CAAC,oCAAoC,EAAE,SAAS,MAAM,EAAE;oBACrE,gBAAgB,OAAO,CAAC,GAAG,CAAC,UAAU;oBACtC,OAAO;gBACT;gBACA,MAAM,OAAO,MAAM,SAAS,IAAI;gBAChC,IAAI,QAAQ,KAAK,OAAO,IAAI,KAAK,OAAO,CAAC,EAAE,IAAI,KAAK,IAAI,EAAE;oBACxD,MAAM,cAAc,AAAC,KAAK,OAAO,CAAC,EAAE,CAAC,WAAW,CAAY,OAAO,CAAC,SAAS,CAAC,IAAc,EAAE,WAAW;oBACzG,MAAM,WAAW,KAAK,OAAO,CAAC,EAAE,CAAC,IAAI;oBACrC,MAAM,UAAU,CAAC,kCAAkC,EAAE,SAAS,OAAO,CAAC;oBACtE,MAAM,QAAQ,KAAK,KAAK,CAAC,KAAK,IAAI,CAAC,IAAI;oBACvC,MAAM,aAAa,KAAK,KAAK,CAAC,KAAK,IAAI,CAAC,UAAU;oBAClD,MAAM,QAAQ,KAAK,KAAK,CAAC,AAAC,CAAC,QAAQ,EAAE,IAAI,IAAK;oBAC9C,MAAM,aAAa,KAAK,KAAK,CAAC,AAAC,CAAC,aAAa,EAAE,IAAI,IAAK;oBAExD,MAAM,OAAO,CAAC;;;;0BAIE,EAAE,QAAQ,OAAO,EAAE,YAAY,SAAS,EAAE,YAAY,iGAAiG,EAAE,UAAU,SAAS,YAAY,UAAU;;oEAExJ,EAAE,MAAM,KAAK,EAAE,MAAM;uDAClC,EAAE,UAAU,SAAS,SAAS,OAAO;oBACxE,EAAE,YAAY,aAAa,EAAE,WAAW,KAAK,EAAE,WAAW;;;;;UAKpE,CAAC;oBACD,gBAAgB,OAAO,CAAC,GAAG,CAAC,UAAU;oBACtC,OAAO;gBACT;gBACA,gBAAgB,OAAO,CAAC,GAAG,CAAC,UAAU;gBACtC,OAAO;YACT,EAAE,OAAO,OAAO;gBACd,QAAQ,KAAK,CAAC,gCAAgC;gBAC9C,gBAAgB,OAAO,CAAC,GAAG,CAAC,UAAU;gBACtC,OAAO;YACT;QACF;QAEA,MAAM,oBAAoB,CAAC,MAAc,MAAc,MAAc;YACnE,MAAM,QAAQ,CAAC,MAAgB,AAAC,MAAM,KAAK,EAAE,GAAI;YACjD,MAAM,IAAI;YACV,MAAM,OAAO,MAAM,OAAO;YAC1B,MAAM,OAAO,MAAM,OAAO;YAC1B,MAAM,IACJ,KAAK,GAAG,CAAC,OAAO,KAAK,KAAK,GAAG,CAAC,OAAO,KACrC,KAAK,GAAG,CAAC,MAAM,SAAS,KAAK,GAAG,CAAC,MAAM,SACvC,KAAK,GAAG,CAAC,OAAO,KAAK,KAAK,GAAG,CAAC,OAAO;YACvC,MAAM,IAAI,IAAI,KAAK,KAAK,CAAC,KAAK,IAAI,CAAC,IAAI,KAAK,IAAI,CAAC,IAAI;YACrD,OAAO,IAAI;QACb;QAEA,MAAM,cAAc,CAAC,KAAa,MAChC,OAAO,qIAAU,CAAC,KAAK,IAAI,OAAO,qIAAU,CAAC,KAAK,IAAI,OAAO,qIAAU,CAAC,IAAI,IAAI,OAAO,qIAAU,CAAC,IAAI;QAExG,MAAM,8BAA8B,OAAO;YACzC,MAAM,WAAW,GAAG,OAAO,GAAG,CAAC,CAAC,EAAE,OAAO,GAAG,EAAE;YAC9C,IAAI,gBAAgB,OAAO,CAAC,GAAG,CAAC,WAAW,OAAO,gBAAgB,OAAO,CAAC,GAAG,CAAC;YAC9E,IAAI,CAAC,QAAQ,MAAM,UAAU,CAAC,OAAO,GAAG,IAAI,CAAC,OAAO,GAAG,EAAE,OAAO;YAEhE,MAAM,QAAQ;gBACZ,KAAK;gBACL,OAAO;gBACP,YAAY;gBACZ,QAAQ;gBACR,WAAW;gBACX,OAAO;YACT;YAEA,MAAM,oBAAoB,CAAC,QAAkB,EAAE,EAAE,OAAO,EAAE;gBACxD,MAAM,YAAY,KAAK,WAAW;gBAClC,IAAI,MAAM,QAAQ,CAAC,mBAAmB,OAAO;oBAAE,MAAM;oBAAS,MAAM,MAAM,KAAK;oBAAE,YAAY;gBAAQ;gBACrG,IAAI,MAAM,QAAQ,CAAC,mBAAmB,OAAO;oBAAE,MAAM;oBAAU,MAAM,MAAM,MAAM;oBAAE,YAAY;gBAAS;gBACxG,IAAI,MAAM,QAAQ,CAAC,uBAAuB,OAAO;oBAAE,MAAM;oBAAc,MAAM,MAAM,UAAU;oBAAE,YAAY;gBAAa;gBACxH,IAAI,MAAM,QAAQ,CAAC,kBAAkB,OAAO;oBAAE,MAAM;oBAAQ,MAAM,MAAM,KAAK;oBAAE,YAAY;gBAAO;gBAClG,IAAI,MAAM,QAAQ,CAAC,kBAAkB,MAAM,QAAQ,CAAC,aAAa,OAAO;oBAAE,MAAM;oBAAO,MAAM,MAAM,GAAG;oBAAE,YAAY;gBAAM;gBAC1H,IAAI,MAAM,QAAQ,CAAC,oBAAoB;oBACrC,IAAI,UAAU,QAAQ,CAAC,cAAc,OAAO;wBAAE,MAAM;wBAAa,MAAM,MAAM,SAAS;wBAAE,YAAY;oBAAY;oBAChH,IAAI,UAAU,QAAQ,CAAC,eAAe,OAAO;wBAAE,MAAM;wBAAc,MAAM,MAAM,UAAU;wBAAE,YAAY;oBAAa;oBACpH,OAAO;wBAAE,MAAM;wBAAO,MAAM,MAAM,GAAG;wBAAE,YAAY;oBAAM;gBAC3D;gBACA,OAAO;oBAAE,MAAM;oBAAW,MAAM,MAAM,KAAK;oBAAE,YAAY;gBAAO;YAClE;YAEA,MAAM,UAAU,IAAI,OAAO,IAAI,CAAC,MAAM,CAAC,aAAa,CAAC;YACrD,MAAM,WAAW,IAAI,OAAO,IAAI,CAAC,MAAM,CAAC,OAAO,GAAG,EAAE,OAAO,GAAG;YAE9D,MAAM,cAAqD;gBACzD;gBACA,SAAS;gBACT,MAAM;YACR;YACA,MAAM,UAAiD,AAAC,OAAO,aAAa,KAAK,eAAe,YAAY,OAAO,GAAG,EAAE,OAAO,GAAG,IAC9H;gBAAE,GAAG,WAAW;gBAAE,QAAQ,OAAO,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,QAAQ;YAAC,IAC7D;gBAAE,GAAG,WAAW;gBAAE,QAAQ;YAAK;YAEnC,MAAM,OAAO,MAAM,IAAI,QAAgB,CAAC;gBACtC,QAAQ,YAAY,CAAC,SAAS,CAAC,SAAS;oBACtC,IAAI,WAAW,OAAO,IAAI,CAAC,MAAM,CAAC,mBAAmB,CAAC,EAAE,IAAI,CAAC,WAAW,QAAQ,MAAM,KAAK,GAAG;wBAC5F,QAAQ;wBACR;oBACF;oBAEA,MAAM,cAAc,IAAI;oBACxB,QAAQ,KAAK,CAAC,GAAG,IAAI,OAAO,CAAC,CAAC;wBAC5B,IAAI,CAAC,MAAM,QAAQ,EAAE,UAAU;wBAC/B,MAAM,UAAU,kBAAkB,MAAM,KAAK,IAAI,EAAE,EAAE,MAAM,IAAI,IAAI;wBACnE,MAAM,WAAW,OAAO,IAAI,CAAC,QAAQ,EAAE,WAAW,yBAC9C,OAAO,IAAI,CAAC,QAAQ,CAAC,SAAS,CAAC,sBAAsB,CAAC,UAAU,MAAM,QAAQ,CAAC,QAAQ,IACvF,kBAAkB,OAAO,GAAG,EAAE,OAAO,GAAG,EAAE,MAAM,QAAQ,CAAC,QAAQ,CAAC,GAAG,IAAI,MAAM,QAAQ,CAAC,QAAQ,CAAC,GAAG;wBAExG,MAAM,YAAY,CAAC,MAAM,IAAI,IAAI,EAAE,EAAE,OAAO,CAAC,iBAAiB,IAAI,IAAI;wBACtE,MAAM,WAAW,GAAG,UAAU,CAAC,EAAE,QAAQ,IAAI,EAAE;wBAC/C,IAAI,CAAC,YAAY,GAAG,CAAC,aAAa,WAAW,YAAY,GAAG,CAAC,UAAW,QAAQ,EAAE;4BAChF,YAAY,GAAG,CAAC,UAAU;gCAAE;gCAAO;gCAAU,aAAa;4BAAQ;wBACpE;oBACF;oBAEA,MAAM,QAAQ,MAAM,IAAI,CAAC,YAAY,MAAM,IAAI,IAAI,CAAC,CAAC,GAAG,IAAM,EAAE,QAAQ,GAAG,EAAE,QAAQ,EAAE,KAAK,CAAC,GAAG;oBAChG,IAAI,MAAM,MAAM,KAAK,GAAG;wBACtB,QAAQ;wBACR;oBACF;oBAEA,IAAI,aAAa;oBACjB,MAAM,OAAO,CAAC,CAAC,EAAE,KAAK,EAAE,QAAQ,EAAE,WAAW,EAAE;wBAC7C,MAAM,QAAQ,WAAW;wBACzB,MAAM,KAAK,WAAW;wBACtB,MAAM,iBAAiB,QAAQ,IAAI,MAAM,OAAO,CAAC,KAAK,MAAM,OAAO,CAAC;wBACpE,MAAM,cAAc,KAAK,IAAI,GAAG,OAAO,CAAC,KAAK,GAAG,OAAO,CAAC;wBACxD,MAAM,WAAW,CAAC,gDAAgD,EAAE,mBAAmB,MAAM,IAAI,IAAI,IAAI,gBAAgB,EAAE,MAAM,QAAQ,EAAE;wBAC3I,MAAM,YAAY,CAAC,2BAA2B,EAAE,YAAY,UAAU,CAAC,EAAE,EAAE,YAAY,IAAI,CAAC,OAAO,CAAC;wBAEpG,cAAc,CAAC;;gBAEX,EAAE,YAAY,IAAI,CAAC;yBACV,EAAE,SAAS;kBAClB,EAAE,UAAU;kBACZ,EAAE,MAAM,IAAI,IAAI,eAAe;;6DAEY,EAAE,UAAU,SAAS,SAAS,OAAO,IAAI,EAAE,eAAe,MAAM,EAAE,YAAY;;YAE/H,CAAC;oBACH;oBACA,cAAc;oBACd,QAAQ;gBACV;YACF;YAEA,gBAAgB,OAAO,CAAC,GAAG,CAAC,UAAU;YACtC,OAAO;QACT;QAEA,MAAM,yBAAyB,OAAO;YACpC,IAAI,gBAAgB,CAAC,iCAAiC,CAAC;YACvD,MAAM,YAAY,QAAQ,kBAAkB,IAAI,QAAQ,kBAAkB,KAAK,MAAM,QAAQ,kBAAkB,GAAG;YAClH,MAAM,eAAe,cAAc,MAAM,qCAAqC;YAE9E,MAAM,SAAS,oBAAoB,QAAQ,UAAU;YACrD,MAAM,yBAAiD;gBACrD,cAAc;gBACd,MAAM;gBACN,MAAM;gBACN,4BAA4B;YAC9B;YAEA,IAAI,QAAQ,eAAe,IAAI,QAAQ,eAAe,KAAK,OAAO,CAAC,QAAQ,eAAe,CAAC,WAAW,GAAG,QAAQ,CAAC,gBAAgB;gBAChI,iBAAiB,CAAC,SAAS,EAAE,UAAU,EAAE,EAAE,aAAa,WAAW,EAAE,QAAQ,eAAe,CAAC,OAAO,EAAE,QAAQ,WAAW,CAAC,iJAAiJ,CAAC;YAC9Q;YACA,IAAI,cAAc,KAAK;gBACrB,iBAAiB,CAAC,YAAY,EAAE,UAAU,EAAE,EAAE,aAAa,CAAC,EAAE,QAAQ,WAAW,CAAC,QAAQ,CAAC;YAC7F,OAAO;gBACL,iBAAiB,CAAC,GAAG,EAAE,QAAQ,WAAW,CAAC,IAAI,CAAC;YAClD;YAEA,MAAM,aAAa,QAAQ,cAAc,GAAG,WAAW;YACvD,MAAM,aAAa,oBAAoB,QAAQ,aAAa;YAC5D,MAAM,YAAsB,EAAE;YAC9B,MAAM,YAAY,sBAAsB,CAAC,QAAQ,WAAW,CAAC,IAAI;YACjE,IAAI,QAAQ,WAAW,KAAK,kBAAkB,QAAQ,WAAW,KAAK,iBAAiB;gBACrF,UAAU,IAAI,CAAC,WAAW,QAAQ,WAAW,EAAE;YACjD;YACA,MAAM,cAAc,eAAe,WAAW,gBAAgB;YAC9D,UAAU,IAAI,CAAC,WAAW,YAAY;YACtC,MAAM,aAAa,wBAAwB,CAAC,QAAQ,aAAa,CAAC,IAAI;YACtE,UAAU,IAAI,CAAC,WAAW,YAAY;YACtC,iBAAiB,CAAC,gDAAgD,CAAC;YACnE,iBAAiB,CAAC,kBAAkB,EAAE,UAAU,IAAI,CAAC,KAAK,MAAM,CAAC;YACjE,IAAI,QAAQ,GAAG,KAAK,KAAK,QAAQ,GAAG,KAAK,GAAG;gBAC1C,iBAAiB,CAAC,iEAAiE,EAAE,QAAQ,GAAG,CAAC,CAAC,EAAE,QAAQ,GAAG,CAAC,2DAA2D,CAAC;YAC9K;YACA,iBAAiB,CAAC,MAAM,CAAC;YAEzB,MAAM,cAAc,MAAM,wBAAwB;YAClD,IAAI,aAAa,iBAAiB,CAAC,2BAA2B,EAAE,iBAAiB,SAAS,aAAa,cAAc,OAAO,GAAG;YAE/H,MAAM,cAAc,MAAM,wBAAwB;YAClD,IAAI,aAAa,iBAAiB,CAAC,2BAA2B,EAAE,aAAa;YAE7E,iBAAiB,CAAC,2BAA2B,CAAC;YAC9C,iBAAiB,kBAAkB;YAEnC,MAAM,cAAc,MAAM,4BAA4B;YACtD,IAAI,aAAa,iBAAiB,CAAC,2BAA2B,EAAE,aAAa;YAE7E,iBAAiB,CAAC,MAAM,CAAC;YACzB,OAAO;QACT;QAEA,MAAM,wBAAwB,OAAO;YACnC,MAAM,EACJ,MAAM,EACN,OAAO,QAAQ,EACf,cAAc,uBAAuB,EACrC,WAAW,wBAAwB,EACnC,YAAY,oBAAoB,EAChC,gBAAgB,WAAW,EAC5B,GAAG;YAEJ,IAAI,gBAAgB,CAAC,iCAAiC,CAAC;YACvD,IAAI,UAAU;gBACZ,MAAM,eAAe,cAAc,qCAAqC;gBACxE,MAAM,YAAY,cAAc,CAAC,SAAS,EAAE,YAAY,EAAE,EAAE,aAAa,CAAC,CAAC,GAAG;gBAC9E,MAAM,UAAU,cAAc,SAAS;gBACvC,iBAAiB,GAAG,UAAU,UAAU,EAAE,SAAS,OAAO,EAAE,KAAK,uIAAuI,EAAE,SAAS;YACrN;YAEA,IAAI,aAAa;gBACf,iBAAiB,CAAC,YAAY,EAAE,YAAY,mCAAmC,EAAE,KAAK,QAAQ,CAAC;YACjG,OAAO;gBACL,iBAAiB,CAAC,GAAG,EAAE,KAAK,IAAI,CAAC;YACnC;YAEA,MAAM,QAAkB,EAAE;YAC1B,MAAM,IAAI,CAAC,WAAW,WAAW;YACjC,MAAM,aAAa,wBAAwB,CAAC,cAAc,IAAI;YAC9D,MAAM,aAAa,oBAAoB;YACvC,MAAM,IAAI,CAAC,WAAW,eAAe,QAAQ,QAAQ,YAAY;YACjE,iBAAiB,CAAC,gDAAgD,CAAC;YACnE,iBAAiB,CAAC,kBAAkB,EAAE,MAAM,IAAI,CAAC,KAAK,MAAM,CAAC;YAC7D,iBAAiB,CAAC,iEAAiE,EAAE,OAAO,GAAG,CAAC,CAAC,EAAE,OAAO,GAAG,CAAC,2DAA2D,CAAC;YAC1K,iBAAiB,CAAC,MAAM,CAAC;YAEzB,MAAM,cAAc,MAAM,wBAAwB,QAAQ,GAAG,KAAK,KAAK,CAAC;YACxE,IAAI,aAAa,iBAAiB,CAAC,2BAA2B,EAAE,iBAAiB,QAAQ,aAAa,cAAc,OAAO,EAAE,YAAY,KAAK,GAAG;YAEjJ,MAAM,cAAc,MAAM,wBAAwB;YAClD,IAAI,aAAa,iBAAiB,CAAC,2BAA2B,EAAE,aAAa;YAE7E,MAAM,cAAc,MAAM,4BAA4B;gBAAE,GAAG,MAAM;gBAAE;YAAc;YACjF,IAAI,aAAa,iBAAiB,CAAC,2BAA2B,EAAE,aAAa;YAE7E,iBAAiB,CAAC,MAAM,CAAC;YACzB,OAAO;QACT;QAEA,MAAM,kBAAkB,OACtB,SACA,QACA;YAEA,IAAI,CAAC,cAAc,OAAO,EAAE;YAC5B,2BAA2B,OAAO,GAAG,QAAQ,EAAE;YAE/C,MAAM,WACJ,oBACA,QAAQ,mBACR,CAAC,QAAQ,GAAG,IAAI,QAAQ,GAAG,GAAG,IAAI,OAAO,IAAI,CAAC,MAAM,CAAC,QAAQ,GAAG,EAAE,QAAQ,GAAG,IAAI,IAAI;YAEvF,MAAM,OAAO,MAAM,uBAAuB;YAC1C,IAAI,cAAc,OAAO,IAAI,2BAA2B,OAAO,KAAK,QAAQ,EAAE,EAAE;gBAC9E,cAAc,OAAO,CAAC,UAAU,CAAC;gBACjC,IAAI,UAAU;oBACZ,cAAc,OAAO,CAAC,WAAW,CAAC;gBACpC;gBACA,IAAI,QAAQ;oBACV,cAAc,OAAO,CAAC,IAAI,CAAC;wBAAE;wBAAK,QAAQ;oBAAO;gBACnD,OAAO,IAAI,UAAU;oBACnB,cAAc,OAAO,CAAC,IAAI,CAAC;wBAAE;wBAAK;oBAAS;gBAC7C,OAAO;oBACL,cAAc,OAAO,CAAC,IAAI,CAAC;gBAC7B;gBACA,iBAAiB;YACnB;QACF;QAEA,qEAAqE;QACrE,MAAM,2BAAmD,CAAC;QAE1D,SAAS,OAAO,CAAC,CAAC;YACd,IAAI,QAAQ,GAAG,KAAK,KAAK,QAAQ,GAAG,KAAK,GAAG;YAC5C,IAAI,QAAQ,WAAW,KAAK,aAAa;YAEzC,MAAM,QAAQ,4IAAiB,CAAC,QAAQ,SAAS,CAAC,IAAI;YAEtD,IAAI,MAAM,QAAQ,GAAG;YACrB,IAAI,MAAM,QAAQ,GAAG;YACrB,MAAM,WAAW,GAAG,QAAQ,GAAG,CAAC,CAAC,EAAE,QAAQ,GAAG,EAAE;YAChD,IAAI,QAAQ,GAAG,KAAK,KAAK,QAAQ,GAAG,KAAK,GAAG;gBAC1C,IAAI,wBAAwB,CAAC,SAAS,EAAE;oBACtC,MAAM,QAAQ,wBAAwB,CAAC,SAAS;oBAChD,MAAM,kBAAkB,UAAU,KAAK,IAAI,CAAC;oBAC5C,MAAM,iBAAiB,KAAK,EAAE,GAAG;oBACjC,MAAM,QAAQ,QAAQ;oBACtB,OAAO,kBAAkB,KAAK,GAAG,CAAC;oBAClC,OAAO,kBAAkB,KAAK,GAAG,CAAC;oBAClC,wBAAwB,CAAC,SAAS,GAAG,QAAQ;gBAC/C,OAAO;oBACL,wBAAwB,CAAC,SAAS,GAAG;gBACvC;YACF;YAEA,MAAM,SAAS,IAAI,OAAO,IAAI,CAAC,MAAM,CAAC;gBAClC,UAAU;oBAAE;oBAAK;gBAAI;gBACrB,OAAO,GAAG,QAAQ,UAAU,CAAC,IAAI,EAAE,QAAQ,WAAW,EAAE;gBACxD,MAAM,UAAU;YACpB;YAEA,OAAO,WAAW,CAAC,SAAS;gBACvB,kBAAkB;gBAClB,gBAAgB,SAAS;gBACzB,qCAAqC;gBACrC,OAAO,aAAa,CAAC,IAAI,YAAY,0BAA0B;oBAAE,QAAQ;wBAAE,IAAI,QAAQ,EAAE;oBAAC;gBAAE;gBAC5F,iBAAiB,QAAQ,EAAE;YAChC;YAEA,OAAO,WAAW,CAAC,aAAa;gBAC7B,iBAAiB,QAAQ,EAAE;YAC9B;YAEA,OAAO,WAAW,CAAC,YAAY;gBAC5B,iBAAiB;YACpB;YAEA,WAAW,IAAI,CAAC;YAChB,WAAW,OAAO,CAAC,QAAQ,EAAE,CAAC,GAAG;gBAAE;gBAAQ;YAAM;QACrD;QAEA,aAAa,OAAO,CAAC,UAAU,CAAC;QAChC,MAAM,aAAa,CAAC,OAAO,gBAAgB,cAAc,YAAY,GAAG,KAAK,KAAK,GAAG,EAAE,IAAI;QAC3F,SAAS,8BAA8B;YACrC,OAAO,WAAW,MAAM;YACxB,cAAc,aAAa,OAAO,CAAC,UAAU,KAAK;YAClD,YAAY,KAAK,KAAK,CAAC;QACzB;QAEA,MAAM,sBAAsB,CAAC;YAC3B,MAAM,EAAE,MAAM,EAAE,GAAG;YACnB,IAAI,CAAC,UAAU,CAAC,OAAO,MAAM,IAAI,CAAC,cAAc,OAAO,IAAI,CAAC,OAAO,MAAM,EAAE;YAC3E,2BAA2B,OAAO,GAAG;YACrC,cAAc,OAAO,CAAC,KAAK;YAC3B,cAAc,OAAO,CAAC,UAAU,CAC9B,CAAC,oCAAoC,EAAE,OAAO,IAAI,IAAI,SAAS,+DAA+D,CAAC;YAEjI,cAAc,OAAO,CAAC,IAAI,CAAC,KAAK,OAAO,MAAM;YAE7C,sBAAsB,QAAQ,IAAI,CAAC,CAAC;gBAClC,IAAI,cAAc,OAAO,EAAE;oBACzB,cAAc,OAAO,CAAC,UAAU,CAAC;oBACjC,cAAc,OAAO,CAAC,IAAI,CAAC,KAAK,OAAO,MAAM;oBAC7C,iBAAiB,OAAO,MAAM;gBAChC;YACF;QACF;QAEA,MAAM,oBAAoB,CAAC;YACzB,MAAM,gBAAgB,SAAS,IAAI,CAAC,CAAC,IAAM,EAAE,EAAE,KAAK,EAAE,MAAM,CAAC,EAAE;YAC/D,IAAI,CAAC,eAAe;YAEpB,MAAM,SAAS,WAAW,OAAO,CAAC,EAAE,MAAM,CAAC,EAAE,CAAC;YAC9C,MAAM,mBACJ,EAAE,MAAM,CAAC,GAAG,IAAI,EAAE,MAAM,CAAC,GAAG,GAAG,IAAI,OAAO,IAAI,CAAC,MAAM,CAAC,EAAE,MAAM,CAAC,GAAG,EAAE,EAAE,MAAM,CAAC,GAAG,IAAI;YACtF,MAAM,WACJ,oBACA,QAAQ,QAAQ,mBAChB,CAAC,cAAc,GAAG,IAAI,cAAc,GAAG,GACnC,IAAI,OAAO,IAAI,CAAC,MAAM,CAAC,cAAc,GAAG,EAAE,cAAc,GAAG,IAC3D,IAAI;YAEV,IAAI,OAAO,UAAU;gBACnB,IAAI,KAAK,CAAC;gBACV,MAAM,cAAc;gBACpB,IAAI,OAAO,CAAC;YACd;YAEA,IAAI,QAAQ;gBACV,gBAAgB,eAAe,OAAO,MAAM,EAAE;YAChD,OAAO,IAAI,YAAY,OAAO,WAAW,aAAa;gBACpD,MAAM,aAAa,IAAI,OAAO,IAAI,CAAC,MAAM,CAAC;oBAAE;oBAAU;gBAAI;gBAC1D,gBAAgB,eAAe,YAAY;gBAC3C,WAAW,IAAM,WAAW,MAAM,CAAC,OAAO;YAC5C;YAEA,SAAS,+BAA+B;gBACtC,IAAI,EAAE,MAAM,CAAC,EAAE;gBACf,WAAW,CAAC,CAAC;gBACb,sBAAsB,CAAC,CAAC;YAC1B;YAEA,iBAAiB,EAAE,MAAM,CAAC,EAAE;QAC9B;QAEA,OAAO,gBAAgB,CAAC,yBAAyB;QACjD,OAAO,gBAAgB,CAAC,mBAAmB;QAC3C,OAAO;YACL,OAAO,mBAAmB,CAAC,yBAAyB;YACpD,OAAO,mBAAmB,CAAC,mBAAmB;QAChD;IAEF,GAAG;QAAC;QAAK;QAAU;QAAO;KAAiB;IAE3C,OAAO;AACT"}},
    {"offset": {"line": 3336, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/kirk/Downloads/Coding%20Projects/nestmcollegemap/src/components/map/MapControls.tsx"],"sourcesContent":["'use client';\n\nimport React from 'react';\nimport { useMap } from '@vis.gl/react-google-maps';\nimport { useTheme } from '@/contexts/ThemeContext';\nimport { useFilters } from '@/contexts/FilterContext';\n\ndeclare var google: any;\n\nconst HOME_COORDS = { lat: 40.720735, lng: -73.983154 }; // NEST+m approx\nconst NESTM_INFO = {\n  coords: HOME_COORDS,\n  name: 'NEST+m',\n  homepageUrl: 'https://nestmk12.net/',\n  imageUrl: '/logos/NEST+m_Logo.png',\n  typeLabel: 'Public K-12 School',\n  locationFocus: 'InCityNYC',\n};\n\nexport function MapControls() {\n  const map = useMap();\n  const { toggleTheme, theme } = useTheme();\n  const { resetFilters } = useFilters();\n  const [transitLayer, setTransitLayer] = React.useState<any | null>(null);\n  const [mapType, setMapType] = React.useState<'roadmap' | 'satellite'>('roadmap');\n  const [showNestm, setShowNestm] = React.useState<boolean>(() => {\n    if (typeof window === 'undefined') return true;\n    const stored = window.localStorage.getItem('show-nestm');\n    return stored === 'false' ? false : true;\n  });\n  const homeMarkerRef = React.useRef<any | null>(null);\n  const [controlsCollapsed, setControlsCollapsed] = React.useState(false);\n\n  React.useEffect(() => {\n    if (typeof window === 'undefined') return;\n    const stored = window.localStorage.getItem('map-type');\n    if (stored === 'satellite' || stored === 'roadmap') {\n      setMapType(stored);\n      if (map) map.setMapTypeId(stored);\n    }\n    const storedTransit = window.localStorage.getItem('transit-visible');\n    if (storedTransit === 'true' && map && !transitLayer) {\n      const layer = new google.maps.TransitLayer();\n      layer.setMap(map);\n      setTransitLayer(layer);\n    }\n    const storedControls = window.localStorage.getItem('map-controls-collapsed');\n    if (storedControls === 'true') setControlsCollapsed(true);\n  }, [map]);\n\n  React.useEffect(() => {\n    if (typeof window === 'undefined') return;\n    window.localStorage.setItem('map-controls-collapsed', controlsCollapsed ? 'true' : 'false');\n  }, [controlsCollapsed]);\n\n  // Place Google map type control in the upper left\n  React.useEffect(() => {\n    if (!map || typeof google === 'undefined') return;\n    map.setOptions({\n      mapTypeControl: true,\n      mapTypeControlOptions: {\n        position: google.maps.ControlPosition.LEFT_TOP,\n      },\n    });\n  }, [map]);\n\n  // Home marker toggle/persist\n  React.useEffect(() => {\n    if (!map) return;\n    if (showNestm) {\n      const marker = new google.maps.Marker({\n        position: HOME_COORDS,\n        map,\n        title: 'NEST+m',\n        icon: {\n          path: google.maps.SymbolPath.CIRCLE,\n          scale: 8,\n          fillColor: '#8b5cf6',\n          fillOpacity: 1,\n          strokeColor: '#fff',\n          strokeWeight: 2,\n        },\n        zIndex: 9999,\n      });\n      marker.addListener('click', () => {\n        window.dispatchEvent(\n          new CustomEvent('open-nestm-info', {\n            detail: { marker, ...NESTM_INFO },\n          })\n        );\n      });\n      homeMarkerRef.current = marker;\n      if (typeof window !== 'undefined') window.localStorage.setItem('show-nestm', 'true');\n    } else {\n      if (homeMarkerRef.current) {\n        homeMarkerRef.current.setMap(null);\n        homeMarkerRef.current = null;\n      }\n      if (typeof window !== 'undefined') window.localStorage.setItem('show-nestm', 'false');\n    }\n    return () => {\n      if (homeMarkerRef.current) {\n        homeMarkerRef.current.setMap(null);\n        homeMarkerRef.current = null;\n      }\n    };\n  }, [showNestm, map]);\n\n  const handleToggleTransit = () => {\n    if (!map) return;\n    if (transitLayer) {\n        transitLayer.setMap(null);\n        setTransitLayer(null);\n        if (typeof window !== 'undefined') window.localStorage.setItem('transit-visible', 'false');\n    } else {\n        const layer = new google.maps.TransitLayer();\n        layer.setMap(map);\n        setTransitLayer(layer);\n        if (typeof window !== 'undefined') window.localStorage.setItem('transit-visible', 'true');\n    }\n  };\n\n  const handleLocateMe = () => {\n    if (!map || !navigator.geolocation) {\n      alert('Geolocation not supported by your browser.');\n      return;\n    }\n    navigator.geolocation.getCurrentPosition(\n      (pos) => {\n        const coords = { lat: pos.coords.latitude, lng: pos.coords.longitude };\n        map.panTo(coords);\n        map.setZoom(12);\n        new google.maps.Marker({\n          position: coords,\n          map,\n          title: 'You are here',\n          icon: {\n            path: google.maps.SymbolPath.CIRCLE,\n            scale: 7,\n            fillColor: '#2563eb',\n            fillOpacity: 0.9,\n            strokeColor: '#fff',\n            strokeWeight: 2,\n          },\n          zIndex: 99999,\n        });\n      },\n      () => alert('Unable to retrieve your location.'),\n      { enableHighAccuracy: true, timeout: 10000 }\n    );\n  };\n\n  const toggleMapType = () => {\n    if (!map) return;\n    const next = mapType === 'roadmap' ? 'satellite' : 'roadmap';\n    map.setMapTypeId(next);\n    setMapType(next);\n    if (typeof window !== 'undefined') {\n      window.localStorage.setItem('map-type', next);\n    }\n  };\n\n  const handleZoomVisible = () => {\n      // In a real implementation, calculate bounds of filteredStudents and map.fitBounds(bounds)\n      if(!map) return;\n      map.setZoom(7);\n      map.setCenter({ lat: 41.8, lng: -74.5 });\n  };\n\n  const handleZoomHome = () => {\n    if (!map) return;\n    map.setCenter(HOME_COORDS);\n    map.setZoom(15);\n  };\n\n  return (\n    <>\n    <div\n      id=\"map-controls-bar\"\n      className=\"absolute top-2 right-4 w-full flex flex-col items-end gap-2 pointer-events-none\"\n      style={{ transform: 'translateX(0px)' }}\n    >\n        {!controlsCollapsed && (\n          <div className=\"bg-white/90 dark:bg-neutral-800/90 p-2 rounded shadow flex flex-wrap justify-center gap-2 pointer-events-auto backdrop-blur-sm border border-gray-200 dark:border-neutral-700 max-w-[min(85vw,700px)]\">\n          <button\n            onClick={toggleTheme}\n            id=\"darkModeToggle\"\n            className=\"px-3 py-1 bg-gray-100 dark:bg-neutral-700 rounded hover:bg-gray-200 text-sm\"\n          >\n            {theme === 'dark' ? '‚òÄÔ∏è Light' : 'üåô Dark'}\n          </button>\n          <button\n            onClick={handleLocateMe}\n            id=\"locateMeBtn\"\n            className=\"px-3 py-1 bg-gray-100 dark:bg-neutral-700 rounded hover:bg-gray-200 text-sm\"\n          >\n            üìç My Location\n          </button>\n          <button\n            onClick={handleToggleTransit}\n            id=\"toggleTransitBtn\"\n            className=\"px-3 py-1 bg-gray-100 dark:bg-neutral-700 rounded hover:bg-gray-200 text-sm\"\n          >\n            {transitLayer ? 'üöá Hide Transit' : 'üöá Transit'}\n          </button>\n          <div className=\"flex flex-wrap gap-2\">\n            <button\n              onClick={handleZoomHome}\n              id=\"zoomToNestmBtn\"\n              className=\"px-3 py-1 bg-gray-100 dark:bg-neutral-700 rounded hover:bg-gray-200 text-sm\"\n            >\n              üè´ NEST+m\n            </button>\n            <button\n              onClick={() => setShowNestm((v) => !v)}\n              id=\"toggleNestmBtn\"\n              className=\"px-3 py-1 bg-gray-100 dark:bg-neutral-700 rounded hover:bg-gray-200 text-sm\"\n              aria-pressed={showNestm}\n            >\n              {showNestm ? 'üëÅÔ∏è Hide NEST+m' : 'üëÄ Show NEST+m'}\n            </button>\n          </div>\n          <button\n            onClick={handleZoomVisible}\n            id=\"zoomToVisibleBtn\"\n            className=\"px-3 py-1 bg-gray-100 dark:bg-neutral-700 rounded hover:bg-gray-200 text-sm\"\n          >\n            üëÅÔ∏è Reset View\n          </button>\n          <button\n            onClick={() => window.dispatchEvent(new CustomEvent('open-update-log'))}\n            id=\"showUpdateLogBtn\"\n            className=\"px-3 py-1 bg-gray-100 dark:bg-neutral-700 rounded hover:bg-gray-200 text-sm\"\n          >\n            üìù Update Log\n          </button>\n          <button\n            onClick={() => window.dispatchEvent(new CustomEvent('open-faq'))}\n            id=\"showFaqBtn\"\n            className=\"px-3 py-1 bg-gray-100 dark:bg-neutral-700 rounded hover:bg-gray-200 text-sm\"\n          >\n            ‚ùì FAQ\n          </button>\n          <button\n            onClick={resetFilters}\n            id=\"clearAllFiltersBtn\"\n            className=\"px-3 py-1 bg-gray-100 dark:bg-neutral-700 rounded hover:bg-gray-200 text-sm\"\n          >\n            üßπ Clear Filters\n          </button>\n          </div>\n        )}\n        <button\n          onClick={() => setControlsCollapsed((v) => !v)}\n          className=\"pointer-events-auto px-2 py-1 bg-white/90 dark:bg-neutral-800/90 rounded shadow border border-gray-200 dark:border-neutral-700 text-sm\"\n          aria-pressed={controlsCollapsed}\n          aria-label={controlsCollapsed ? 'Show map controls' : 'Hide map controls'}\n        >\n          {controlsCollapsed ? '<<' : '>>'}\n        </button>\n      </div>\n    </>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 3661, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/kirk/Downloads/Coding%20Projects/nestmcollegemap/src/components/map/CollegeMap.tsx"],"sourcesContent":["'use client';\n\nimport React, { useEffect } from 'react';\nimport { APIProvider, Map, useMap } from '@vis.gl/react-google-maps';\nimport { useTheme } from '@/contexts/ThemeContext';\nimport { useFilters } from '@/contexts/FilterContext';\nimport { MAP_STYLE_DARK } from '@/lib/constants';\nimport MapMarkers from './MapMarkers';\nimport { MapControls } from './MapControls';\n\nconst DEFAULT_CENTER = { lat: 41.8, lng: -74.5 };\nconst DEFAULT_ZOOM = 7;\n\n// Sync map styling with theme without recreating the map instance\nfunction MapStyleSync({ theme }: { theme: 'light' | 'dark' }) {\n  const map = useMap();\n\n  useEffect(() => {\n    if (!map) return;\n    const styles = theme === 'dark' ? MAP_STYLE_DARK : [];\n    map.setOptions({ styles });\n  }, [map, theme]);\n\n  return null;\n}\n\nexport default function CollegeMap() {\n  const { theme } = useTheme();\n  const { filteredStudents } = useFilters();\n  const [mapType, setMapType] = React.useState<'roadmap' | 'satellite'>('roadmap');\n\n  useEffect(() => {\n    if (typeof window === 'undefined') return;\n    const stored = window.localStorage.getItem('map-type');\n    if (stored === 'satellite' || stored === 'roadmap') {\n      setMapType(stored);\n    }\n  }, []);\n\n  // Persist map type\n  useEffect(() => {\n    if (typeof window !== 'undefined') {\n      window.localStorage.setItem('map-type', mapType);\n    }\n  }, [mapType]);\n  \n  return (\n    <div className=\"relative w-full h-full bg-gray-200 dark:bg-neutral-800\">\n      <APIProvider \n        apiKey={process.env.NEXT_PUBLIC_GOOGLE_MAPS_API_KEY || ''} \n        libraries={['places', 'geometry']}\n      >\n        <Map\n          defaultCenter={DEFAULT_CENTER}\n          defaultZoom={DEFAULT_ZOOM}\n          gestureHandling={'greedy'}\n          disableDefaultUI={false}\n          fullscreenControl={false} // We have custom controls or layout handles this\n          defaultMapTypeId={mapType}\n          onMapTypeIdChanged={(e) => {\n            const newType = (e as any)?.mapTypeId || mapType;\n            if (newType === 'satellite' || newType === 'roadmap') setMapType(newType);\n          }}\n          className=\"w-full h-full\"\n        >\n            <MapStyleSync theme={theme} />\n            <MapMarkers students={filteredStudents} />\n            <MapControls />\n        </Map>\n      </APIProvider>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AARA;;;;;;;;;AAUA,MAAM,iBAAiB;IAAE,KAAK;IAAM,KAAK,CAAC;AAAK;AAC/C,MAAM,eAAe;AAErB,kEAAkE;AAClE,SAAS,aAAa,EAAE,KAAK,EAA+B;IAC1D,MAAM,MAAM,IAAA,4LAAM;IAElB,IAAA,kNAAS,EAAC;QACR,IAAI,CAAC,KAAK;QACV,MAAM,SAAS,UAAU,SAAS,yIAAc,GAAG,EAAE;QACrD,IAAI,UAAU,CAAC;YAAE;QAAO;IAC1B,GAAG;QAAC;QAAK;KAAM;IAEf,OAAO;AACT;AAEe,SAAS;IACtB,MAAM,EAAE,KAAK,EAAE,GAAG,IAAA,4IAAQ;IAC1B,MAAM,EAAE,gBAAgB,EAAE,GAAG,IAAA,+IAAU;IACvC,MAAM,CAAC,SAAS,WAAW,GAAG,gNAAK,CAAC,QAAQ,CAA0B;IAEtE,IAAA,kNAAS,EAAC;QACR,wCAAmC;;;QACnC,MAAM;IAIR,GAAG,EAAE;IAEL,mBAAmB;IACnB,IAAA,kNAAS,EAAC;QACR;;IAGF,GAAG;QAAC;KAAQ;IAEZ,qBACE,8OAAC;QAAI,WAAU;kBACb,cAAA,8OAAC,iMAAW;YACV,QAAQ,+EAA+C;YACvD,WAAW;gBAAC;gBAAU;aAAW;sBAEjC,cAAA,8OAAC,yLAAG;gBACF,eAAe;gBACf,aAAa;gBACb,iBAAiB;gBACjB,kBAAkB;gBAClB,mBAAmB;gBACnB,kBAAkB;gBAClB,oBAAoB,CAAC;oBACnB,MAAM,UAAU,AAAC,GAAW,aAAa;oBACzC,IAAI,YAAY,eAAe,YAAY,WAAW,WAAW;gBACnE;gBACA,WAAU;;kCAER,8OAAC;wBAAa,OAAO;;;;;;kCACrB,8OAAC,kJAAU;wBAAC,UAAU;;;;;;kCACtB,8OAAC,uJAAW;;;;;;;;;;;;;;;;;;;;;AAKxB"}},
    {"offset": {"line": 3780, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/kirk/Downloads/Coding%20Projects/nestmcollegemap/src/components/ui/PhotoPopup.tsx"],"sourcesContent":["'use client';\n\nimport React, { useEffect, useMemo, useRef, useState } from 'react';\nimport { PopupAnchorRect, useUI } from '@/contexts/UIContext';\nimport { X, ChevronLeft, ChevronRight } from 'lucide-react';\nimport { createPortal } from 'react-dom';\nimport { useFilters } from '@/contexts/FilterContext';\nimport { GRAD_CLASS_COLORS } from '@/lib/constants';\n\nexport default function PhotoPopup() {\n  const { selectedStudent, isPhotoPopupOpen, closePhotoPopup, openPhotoPopup, popupAnchorRect } = useUI();\n  const { filteredStudents } = useFilters();\n  const [isZoomed, setIsZoomed] = useState(false);\n  const wasOpenRef = useRef(false);\n\n  const captionText = useMemo(() => {\n    if (!selectedStudent) return '';\n    return selectedStudent.bioCaption && selectedStudent.bioCaption.trim().length > 0\n      ? selectedStudent.bioCaption\n      : `Congrats to ${selectedStudent.seniorName} on committing to ${selectedStudent.collegeName}!`;\n  }, [selectedStudent]);\n\n  // Reset zoom when the popup is first opened or closed\n  useEffect(() => {\n    if (isPhotoPopupOpen && !wasOpenRef.current) {\n      setIsZoomed(false);\n    }\n    if (!isPhotoPopupOpen) {\n      setIsZoomed(false);\n    }\n    wasOpenRef.current = isPhotoPopupOpen;\n  }, [isPhotoPopupOpen]);\n\n  // Close on Escape (mirrors vanilla zoom popup behavior)\n  useEffect(() => {\n    const handleEsc = (e: KeyboardEvent) => {\n      if (e.key === 'Escape' && isPhotoPopupOpen) {\n        e.preventDefault();\n        setIsZoomed(false);\n        closePhotoPopup();\n      }\n    };\n    if (isPhotoPopupOpen) window.addEventListener('keydown', handleEsc);\n    return () => window.removeEventListener('keydown', handleEsc);\n  }, [isPhotoPopupOpen, closePhotoPopup]);\n\n  const handleNext = (e?: React.MouseEvent | KeyboardEvent) => {\n    e?.stopPropagation?.();\n    if (!selectedStudent || filteredStudents.length === 0) return;\n\n    const currentIndex = filteredStudents.findIndex((s) => s.id === selectedStudent.id);\n    const nextIndex = currentIndex === -1 ? 0 : (currentIndex + 1) % filteredStudents.length;\n\n    openPhotoPopup(filteredStudents[nextIndex]);\n    setIsZoomed(true);\n  };\n\n  const handlePrev = (e?: React.MouseEvent | KeyboardEvent) => {\n    e?.stopPropagation?.();\n    if (!selectedStudent || filteredStudents.length === 0) return;\n\n    const currentIndex = filteredStudents.findIndex((s) => s.id === selectedStudent.id);\n    const prevIndex =\n      currentIndex === -1\n        ? filteredStudents.length - 1\n        : (currentIndex - 1 + filteredStudents.length) % filteredStudents.length;\n\n    openPhotoPopup(filteredStudents[prevIndex]);\n    setIsZoomed(true);\n  };\n\n  // Arrow key navigation only while zoomed (matches original behavior)\n  useEffect(() => {\n    const handleArrow = (e: KeyboardEvent) => {\n      if (!isPhotoPopupOpen || !isZoomed) return;\n      if (e.key === 'ArrowRight') {\n        handleNext(e);\n        e.preventDefault();\n      } else if (e.key === 'ArrowLeft') {\n        handlePrev(e);\n        e.preventDefault();\n      }\n    };\n    window.addEventListener('keydown', handleArrow);\n    return () => window.removeEventListener('keydown', handleArrow);\n  }, [isPhotoPopupOpen, isZoomed, filteredStudents, selectedStudent]);\n\n  if (!isPhotoPopupOpen || !selectedStudent) return null;\n\n  const gradColor = GRAD_CLASS_COLORS[selectedStudent.gradClass] || '#888';\n  const HonoraryBadges = ({ size = 16 }: { size?: number } = {}) => {\n    const h = selectedStudent.honoraries || [];\n    if (h.length === 0) return null;\n    const icons: Record<string, string> = {\n      dean_scholars: '/logos/dean scholars.png',\n      macaulay: '/logos/macaulay.png',\n      posse: '/logos/posse.png',\n      questbridge: '/logos/questbridge.png',\n    };\n    return (\n      <div className=\"flex items-center gap-1\">\n        {h.map((key) =>\n          icons[key] ? (\n            <img\n              key={key}\n              src={icons[key]}\n              alt={key}\n              className=\"h-4 w-4\"\n              style={{ height: size, width: key === 'posse' ? size * 1.3 : size }}\n            />\n          ) : null\n        )}\n      </div>\n    );\n  };\n\n  const SocialLinks = (\n    <div className=\"flex flex-wrap justify-center gap-2 items-center\">\n      <HonoraryBadges size={28} />\n      {selectedStudent.instagramUrl && (\n        <a\n          href={selectedStudent.instagramUrl}\n          target=\"_blank\"\n          rel=\"noreferrer\"\n          className=\"hover:scale-110 transition-transform\"\n        >\n          <img src=\"/logos/instagram.svg\" alt=\"Instagram\" className=\"h-7 w-7\" />\n        </a>\n      )}\n      {selectedStudent.linkedInUrl && (\n        <a\n          href={selectedStudent.linkedInUrl}\n          target=\"_blank\"\n          rel=\"noreferrer\"\n          className=\"hover:scale-110 transition-transform\"\n        >\n          <img src=\"/logos/linkedin.svg\" alt=\"LinkedIn\" className=\"h-7 w-7\" />\n        </a>\n      )}\n      {selectedStudent.githubUrl && (\n        <a\n          href={selectedStudent.githubUrl}\n          target=\"_blank\"\n          rel=\"noreferrer\"\n          className=\"hover:scale-110 transition-transform\"\n        >\n          <img src=\"/logos/github.svg\" alt=\"GitHub\" className=\"h-7 w-7 dark:invert\" />\n        </a>\n      )}\n    </div>\n  );\n\n  const closeAll = (e?: React.MouseEvent) => {\n    e?.stopPropagation();\n    setIsZoomed(false);\n    closePhotoPopup();\n  };\n\n  const computePreviewPosition = (anchor?: PopupAnchorRect | null) => {\n    if (typeof window === 'undefined') return { top: 24, left: 24, width: 320, maxHeight: 600 };\n    const viewportMargin = 12;\n    const gapFromList = 16;\n    const preferredWidth = 320;\n    const maxLeft = window.innerWidth - preferredWidth - viewportMargin;\n    const maxHeight = Math.max(240, window.innerHeight - viewportMargin * 2);\n\n    if (!anchor) {\n      return { top: viewportMargin, left: Math.max(viewportMargin, maxLeft), width: preferredWidth, maxHeight };\n    }\n\n    let left = anchor.right + gapFromList; // keep a gap from the list scrollbar\n    if (left > maxLeft) {\n      // If pushing right would overflow, place it to the left of the list item\n      left = anchor.left - preferredWidth - gapFromList;\n    }\n    left = Math.max(viewportMargin, Math.min(left, maxLeft));\n\n    const maxTopAllowed = window.innerHeight - maxHeight - viewportMargin;\n    let top = Math.min(anchor.top, Math.max(viewportMargin, maxTopAllowed));\n\n    return { top, left, width: preferredWidth, maxHeight };\n  };\n\n  const previewPos = computePreviewPosition(popupAnchorRect);\n\n  const FloatingPreview = (\n    <div\n      className=\"fixed z-[9999] rounded-xl border border-gray-200 dark:border-neutral-700 bg-white dark:bg-neutral-900 shadow-2xl overflow-hidden\"\n      style={{\n        top: previewPos.top + 50, // larger nudge down for breathing room\n        left: previewPos.left + 12,\n        width: previewPos.width,\n        maxWidth: '90vw',\n        maxHeight: previewPos.maxHeight,\n        overflowY: 'auto'\n      }}\n    >\n      <div className=\"flex items-start justify-between px-4 py-3 border-b border-gray-200 dark:border-neutral-800\">\n        <div className=\"space-y-0.5\">\n          <div className=\"flex items-center gap-2\">\n            <div className=\"text-sm font-semibold text-gray-900 dark:text-gray-100\">{selectedStudent.seniorName}</div>\n            <HonoraryBadges />\n          </div>\n          <button\n            type=\"button\"\n            className=\"text-xs text-blue-600 dark:text-blue-300 font-semibold underline-offset-2 hover:underline\"\n            onClick={(e) => {\n              e.stopPropagation();\n              window.dispatchEvent(new CustomEvent('center-student-marker', { detail: { id: selectedStudent.id } }));\n            }}\n          >\n            {selectedStudent.collegeName}\n          </button>\n          <div className=\"flex items-center gap-2 text-xs text-gray-600 dark:text-gray-400 flex-wrap\">\n            <span className=\"px-2 py-0.5 rounded-full text-white font-bold\" style={{ backgroundColor: gradColor }}>\n              Class of {selectedStudent.gradClass}\n            </span>\n            <span>{selectedStudent.major || 'Undecided'}</span>\n          </div>\n        </div>\n        <button\n          onClick={closeAll}\n          className=\"p-1 text-gray-500 hover:text-red-500 rounded-full hover:bg-gray-100 dark:hover:bg-neutral-800 transition-colors\"\n          aria-label=\"Close senior photo\"\n        >\n          <X size={18} />\n        </button>\n      </div>\n\n      <div className=\"relative bg-black\">\n        <img\n          src={selectedStudent.seniorPhotoUrl}\n          alt={selectedStudent.seniorName}\n          className=\"w-full object-contain max-h-80 cursor-zoom-in\"\n          onClick={(e) => {\n            e.stopPropagation();\n            setIsZoomed(true);\n          }}\n          onError={(e) => {\n            (e.target as HTMLImageElement).src = selectedStudent.seniorPhotoUrlPng || '/placeholder-logo.png';\n          }}\n        />\n        <div className=\"absolute bottom-2 right-2 bg-black/70 text-white text-xs px-2 py-1 rounded\">\n          Click to zoom & browse\n        </div>\n      </div>\n\n      <div className=\"px-4 py-3 space-y-3\">\n        <div className=\"text-sm text-gray-700 dark:text-gray-200 whitespace-pre-wrap max-h-32 overflow-y-auto leading-relaxed\">\n          {captionText}\n        </div>\n        <div className=\"pt-3 border-t border-gray-200 dark:border-neutral-800\">{SocialLinks}</div>\n      </div>\n    </div>\n  );\n\n  const ZoomOverlay = (\n    <div\n      className=\"fixed inset-0 z-[10000] bg-black/70 backdrop-blur-sm flex items-center justify-center\"\n      onClick={closeAll}\n    >\n      {filteredStudents.length > 1 && (\n        <>\n          <button\n            onClick={handlePrev}\n            className=\"absolute left-4 top-1/2 -translate-y-1/2 z-[10001] p-3 bg-black/80 text-white rounded-full hover:bg-black/90 transition-colors shadow-xl\"\n            aria-label=\"Previous senior\"\n          >\n            <ChevronLeft size={32} />\n          </button>\n          <button\n            onClick={handleNext}\n            className=\"absolute right-4 top-1/2 -translate-y-1/2 z-[10001] p-3 bg-black/80 text-white rounded-full hover:bg-black/90 transition-colors shadow-xl\"\n            aria-label=\"Next senior\"\n          >\n            <ChevronRight size={32} />\n          </button>\n        </>\n      )}\n\n      <button\n        onClick={closeAll}\n        className=\"absolute top-4 right-4 z-[10002] p-2 bg-black/70 text-white rounded-full hover:bg-red-500 transition-colors shadow-lg\"\n        aria-label=\"Close zoomed photo\"\n      >\n        <X size={22} />\n      </button>\n\n      <div\n        className=\"flex flex-col md:flex-row items-center justify-center gap-6 max-w-6xl w-[min(1100px,95vw)] max-h-[90vh] px-4\"\n        onClick={(e) => e.stopPropagation()}\n      >\n        <div className=\"flex-1 flex items-center justify-center max-h-[90vh] w-full\">\n          <div className=\"absolute top-3 left-3 flex items-center gap-2 bg-black/50 px-2 py-1 rounded\">\n            <HonoraryBadges />\n          </div>\n          <img\n            src={selectedStudent.seniorPhotoUrl}\n            alt={selectedStudent.seniorName}\n            className=\"max-h-[85vh] w-auto object-contain rounded-lg shadow-2xl bg-black\"\n            onError={(e) => {\n              (e.target as HTMLImageElement).src = selectedStudent.seniorPhotoUrlPng || '/placeholder-logo.png';\n            }}\n          />\n        </div>\n\n        <div className=\"w-full md:w-[420px] max-h-[90vh] overflow-y-auto rounded-xl bg-white/95 dark:bg-neutral-900/95 text-gray-900 dark:text-gray-50 shadow-2xl border border-gray-200/70 dark:border-neutral-700/70 p-6 space-y-3\">\n          <div className=\"text-center md:text-left space-y-1\">\n            <div className=\"text-2xl font-bold\">{selectedStudent.seniorName}</div>\n            <div className=\"flex flex-wrap justify-center md:justify-start items-center gap-2 text-sm\">\n              <span className=\"px-3 py-1 rounded-full text-white font-bold\" style={{ backgroundColor: gradColor }}>\n                Class of {selectedStudent.gradClass}\n              </span>\n              <HonoraryBadges />\n              <button\n                onClick={() => {\n                  window.dispatchEvent(new CustomEvent('center-student-marker', { detail: { id: selectedStudent.id } }));\n                }}\n                className=\"text-blue-600 dark:text-blue-300 font-semibold underline-offset-2 hover:underline\"\n              >\n                {selectedStudent.collegeName}\n              </button>\n            </div>\n            <div className=\"text-sm text-gray-600 dark:text-gray-300\">{selectedStudent.major || 'Undecided'}</div>\n            <div className=\"flex items-center gap-2\"><HonoraryBadges size={18} /></div>\n          </div>\n\n          <div className=\"text-sm whitespace-pre-wrap leading-relaxed text-gray-800 dark:text-gray-200\">\n            {captionText}\n          </div>\n\n          <div className=\"pt-2 border-t border-gray-200 dark:border-neutral-800\">{SocialLinks}</div>\n\n          <div className=\"text-xs text-gray-500 dark:text-gray-400 text-center border-t border-gray-200 dark:border-neutral-800 pt-3\">\n            Use ‚Üê/‚Üí to browse seniors. Click outside the photo or press Esc to exit zoom.\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n\n  // Floating preview mirrors the small popup; zoom overlay mirrors the zoomed view.\n  if (!isZoomed) {\n    return typeof document !== 'undefined' ? createPortal(FloatingPreview, document.body) : null;\n  }\n\n  return typeof document !== 'undefined' ? createPortal(ZoomOverlay, document.body) : null;\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AAPA;;;;;;;;AASe,SAAS;IACtB,MAAM,EAAE,eAAe,EAAE,gBAAgB,EAAE,eAAe,EAAE,cAAc,EAAE,eAAe,EAAE,GAAG,IAAA,sIAAK;IACrG,MAAM,EAAE,gBAAgB,EAAE,GAAG,IAAA,+IAAU;IACvC,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,iNAAQ,EAAC;IACzC,MAAM,aAAa,IAAA,+MAAM,EAAC;IAE1B,MAAM,cAAc,IAAA,gNAAO,EAAC;QAC1B,IAAI,CAAC,iBAAiB,OAAO;QAC7B,OAAO,gBAAgB,UAAU,IAAI,gBAAgB,UAAU,CAAC,IAAI,GAAG,MAAM,GAAG,IAC5E,gBAAgB,UAAU,GAC1B,CAAC,YAAY,EAAE,gBAAgB,UAAU,CAAC,kBAAkB,EAAE,gBAAgB,WAAW,CAAC,CAAC,CAAC;IAClG,GAAG;QAAC;KAAgB;IAEpB,sDAAsD;IACtD,IAAA,kNAAS,EAAC;QACR,IAAI,oBAAoB,CAAC,WAAW,OAAO,EAAE;YAC3C,YAAY;QACd;QACA,IAAI,CAAC,kBAAkB;YACrB,YAAY;QACd;QACA,WAAW,OAAO,GAAG;IACvB,GAAG;QAAC;KAAiB;IAErB,wDAAwD;IACxD,IAAA,kNAAS,EAAC;QACR,MAAM,YAAY,CAAC;YACjB,IAAI,EAAE,GAAG,KAAK,YAAY,kBAAkB;gBAC1C,EAAE,cAAc;gBAChB,YAAY;gBACZ;YACF;QACF;QACA,IAAI,kBAAkB,OAAO,gBAAgB,CAAC,WAAW;QACzD,OAAO,IAAM,OAAO,mBAAmB,CAAC,WAAW;IACrD,GAAG;QAAC;QAAkB;KAAgB;IAEtC,MAAM,aAAa,CAAC;QAClB,GAAG;QACH,IAAI,CAAC,mBAAmB,iBAAiB,MAAM,KAAK,GAAG;QAEvD,MAAM,eAAe,iBAAiB,SAAS,CAAC,CAAC,IAAM,EAAE,EAAE,KAAK,gBAAgB,EAAE;QAClF,MAAM,YAAY,iBAAiB,CAAC,IAAI,IAAI,CAAC,eAAe,CAAC,IAAI,iBAAiB,MAAM;QAExF,eAAe,gBAAgB,CAAC,UAAU;QAC1C,YAAY;IACd;IAEA,MAAM,aAAa,CAAC;QAClB,GAAG;QACH,IAAI,CAAC,mBAAmB,iBAAiB,MAAM,KAAK,GAAG;QAEvD,MAAM,eAAe,iBAAiB,SAAS,CAAC,CAAC,IAAM,EAAE,EAAE,KAAK,gBAAgB,EAAE;QAClF,MAAM,YACJ,iBAAiB,CAAC,IACd,iBAAiB,MAAM,GAAG,IAC1B,CAAC,eAAe,IAAI,iBAAiB,MAAM,IAAI,iBAAiB,MAAM;QAE5E,eAAe,gBAAgB,CAAC,UAAU;QAC1C,YAAY;IACd;IAEA,qEAAqE;IACrE,IAAA,kNAAS,EAAC;QACR,MAAM,cAAc,CAAC;YACnB,IAAI,CAAC,oBAAoB,CAAC,UAAU;YACpC,IAAI,EAAE,GAAG,KAAK,cAAc;gBAC1B,WAAW;gBACX,EAAE,cAAc;YAClB,OAAO,IAAI,EAAE,GAAG,KAAK,aAAa;gBAChC,WAAW;gBACX,EAAE,cAAc;YAClB;QACF;QACA,OAAO,gBAAgB,CAAC,WAAW;QACnC,OAAO,IAAM,OAAO,mBAAmB,CAAC,WAAW;IACrD,GAAG;QAAC;QAAkB;QAAU;QAAkB;KAAgB;IAElE,IAAI,CAAC,oBAAoB,CAAC,iBAAiB,OAAO;IAElD,MAAM,YAAY,4IAAiB,CAAC,gBAAgB,SAAS,CAAC,IAAI;IAClE,MAAM,iBAAiB,CAAC,EAAE,OAAO,EAAE,EAAqB,GAAG,CAAC,CAAC;QAC3D,MAAM,IAAI,gBAAgB,UAAU,IAAI,EAAE;QAC1C,IAAI,EAAE,MAAM,KAAK,GAAG,OAAO;QAC3B,MAAM,QAAgC;YACpC,eAAe;YACf,UAAU;YACV,OAAO;YACP,aAAa;QACf;QACA,qBACE,8OAAC;YAAI,WAAU;sBACZ,EAAE,GAAG,CAAC,CAAC,MACN,KAAK,CAAC,IAAI,iBACR,8OAAC;oBAEC,KAAK,KAAK,CAAC,IAAI;oBACf,KAAK;oBACL,WAAU;oBACV,OAAO;wBAAE,QAAQ;wBAAM,OAAO,QAAQ,UAAU,OAAO,MAAM;oBAAK;mBAJ7D;;;;2BAML;;;;;;IAIZ;IAEA,MAAM,4BACJ,8OAAC;QAAI,WAAU;;0BACb,8OAAC;gBAAe,MAAM;;;;;;YACrB,gBAAgB,YAAY,kBAC3B,8OAAC;gBACC,MAAM,gBAAgB,YAAY;gBAClC,QAAO;gBACP,KAAI;gBACJ,WAAU;0BAEV,cAAA,8OAAC;oBAAI,KAAI;oBAAuB,KAAI;oBAAY,WAAU;;;;;;;;;;;YAG7D,gBAAgB,WAAW,kBAC1B,8OAAC;gBACC,MAAM,gBAAgB,WAAW;gBACjC,QAAO;gBACP,KAAI;gBACJ,WAAU;0BAEV,cAAA,8OAAC;oBAAI,KAAI;oBAAsB,KAAI;oBAAW,WAAU;;;;;;;;;;;YAG3D,gBAAgB,SAAS,kBACxB,8OAAC;gBACC,MAAM,gBAAgB,SAAS;gBAC/B,QAAO;gBACP,KAAI;gBACJ,WAAU;0BAEV,cAAA,8OAAC;oBAAI,KAAI;oBAAoB,KAAI;oBAAS,WAAU;;;;;;;;;;;;;;;;;IAM5D,MAAM,WAAW,CAAC;QAChB,GAAG;QACH,YAAY;QACZ;IACF;IAEA,MAAM,yBAAyB,CAAC;QAC9B,wCAAmC,OAAO;YAAE,KAAK;YAAI,MAAM;YAAI,OAAO;YAAK,WAAW;QAAI;;;QAC1F,MAAM;QACN,MAAM;QACN,MAAM;QACN,MAAM;QACN,MAAM;QAMN,IAAI,MAAmC,qCAAqC;QAO5E,MAAM;QACN,IAAI;IAGN;IAEA,MAAM,aAAa,uBAAuB;IAE1C,MAAM,gCACJ,8OAAC;QACC,WAAU;QACV,OAAO;YACL,KAAK,WAAW,GAAG,GAAG;YACtB,MAAM,WAAW,IAAI,GAAG;YACxB,OAAO,WAAW,KAAK;YACvB,UAAU;YACV,WAAW,WAAW,SAAS;YAC/B,WAAW;QACb;;0BAEA,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAI,WAAU;;0CACb,8OAAC;gCAAI,WAAU;;kDACb,8OAAC;wCAAI,WAAU;kDAA0D,gBAAgB,UAAU;;;;;;kDACnG,8OAAC;;;;;;;;;;;0CAEH,8OAAC;gCACC,MAAK;gCACL,WAAU;gCACV,SAAS,CAAC;oCACR,EAAE,eAAe;oCACjB,OAAO,aAAa,CAAC,IAAI,YAAY,yBAAyB;wCAAE,QAAQ;4CAAE,IAAI,gBAAgB,EAAE;wCAAC;oCAAE;gCACrG;0CAEC,gBAAgB,WAAW;;;;;;0CAE9B,8OAAC;gCAAI,WAAU;;kDACb,8OAAC;wCAAK,WAAU;wCAAgD,OAAO;4CAAE,iBAAiB;wCAAU;;4CAAG;4CAC3F,gBAAgB,SAAS;;;;;;;kDAErC,8OAAC;kDAAM,gBAAgB,KAAK,IAAI;;;;;;;;;;;;;;;;;;kCAGpC,8OAAC;wBACC,SAAS;wBACT,WAAU;wBACV,cAAW;kCAEX,cAAA,8OAAC,iMAAC;4BAAC,MAAM;;;;;;;;;;;;;;;;;0BAIb,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBACC,KAAK,gBAAgB,cAAc;wBACnC,KAAK,gBAAgB,UAAU;wBAC/B,WAAU;wBACV,SAAS,CAAC;4BACR,EAAE,eAAe;4BACjB,YAAY;wBACd;wBACA,SAAS,CAAC;4BACP,EAAE,MAAM,CAAsB,GAAG,GAAG,gBAAgB,iBAAiB,IAAI;wBAC5E;;;;;;kCAEF,8OAAC;wBAAI,WAAU;kCAA6E;;;;;;;;;;;;0BAK9F,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAI,WAAU;kCACZ;;;;;;kCAEH,8OAAC;wBAAI,WAAU;kCAAyD;;;;;;;;;;;;;;;;;;IAK9E,MAAM,4BACJ,8OAAC;QACC,WAAU;QACV,SAAS;;YAER,iBAAiB,MAAM,GAAG,mBACzB;;kCACE,8OAAC;wBACC,SAAS;wBACT,WAAU;wBACV,cAAW;kCAEX,cAAA,8OAAC,mOAAW;4BAAC,MAAM;;;;;;;;;;;kCAErB,8OAAC;wBACC,SAAS;wBACT,WAAU;wBACV,cAAW;kCAEX,cAAA,8OAAC,sOAAY;4BAAC,MAAM;;;;;;;;;;;;;0BAK1B,8OAAC;gBACC,SAAS;gBACT,WAAU;gBACV,cAAW;0BAEX,cAAA,8OAAC,iMAAC;oBAAC,MAAM;;;;;;;;;;;0BAGX,8OAAC;gBACC,WAAU;gBACV,SAAS,CAAC,IAAM,EAAE,eAAe;;kCAEjC,8OAAC;wBAAI,WAAU;;0CACb,8OAAC;gCAAI,WAAU;0CACb,cAAA,8OAAC;;;;;;;;;;0CAEH,8OAAC;gCACC,KAAK,gBAAgB,cAAc;gCACnC,KAAK,gBAAgB,UAAU;gCAC/B,WAAU;gCACV,SAAS,CAAC;oCACP,EAAE,MAAM,CAAsB,GAAG,GAAG,gBAAgB,iBAAiB,IAAI;gCAC5E;;;;;;;;;;;;kCAIJ,8OAAC;wBAAI,WAAU;;0CACb,8OAAC;gCAAI,WAAU;;kDACb,8OAAC;wCAAI,WAAU;kDAAsB,gBAAgB,UAAU;;;;;;kDAC/D,8OAAC;wCAAI,WAAU;;0DACb,8OAAC;gDAAK,WAAU;gDAA8C,OAAO;oDAAE,iBAAiB;gDAAU;;oDAAG;oDACzF,gBAAgB,SAAS;;;;;;;0DAErC,8OAAC;;;;;0DACD,8OAAC;gDACC,SAAS;oDACP,OAAO,aAAa,CAAC,IAAI,YAAY,yBAAyB;wDAAE,QAAQ;4DAAE,IAAI,gBAAgB,EAAE;wDAAC;oDAAE;gDACrG;gDACA,WAAU;0DAET,gBAAgB,WAAW;;;;;;;;;;;;kDAGhC,8OAAC;wCAAI,WAAU;kDAA4C,gBAAgB,KAAK,IAAI;;;;;;kDACpF,8OAAC;wCAAI,WAAU;kDAA0B,cAAA,8OAAC;4CAAe,MAAM;;;;;;;;;;;;;;;;;0CAGjE,8OAAC;gCAAI,WAAU;0CACZ;;;;;;0CAGH,8OAAC;gCAAI,WAAU;0CAAyD;;;;;;0CAExE,8OAAC;gCAAI,WAAU;0CAA6G;;;;;;;;;;;;;;;;;;;;;;;;IAQpI,kFAAkF;IAClF,IAAI,CAAC,UAAU;QACb,OAAO,OAAO,aAAa,4BAAc,IAAA,4NAAY,EAAC,iBAAiB,SAAS,IAAI,IAAI;IAC1F;IAEA,OAAO,OAAO,aAAa,4BAAc,IAAA,4NAAY,EAAC,aAAa,SAAS,IAAI,IAAI;AACtF"}},
    {"offset": {"line": 4412, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/kirk/Downloads/Coding%20Projects/nestmcollegemap/src/components/ui/TutorialTour.tsx"],"sourcesContent":["'use client';\n\nimport React, { useCallback, useEffect, useMemo, useState } from 'react';\n\ntype Step = {\n  selector: string;\n  headline: string;\n  title: string;\n  text: string;\n};\n\ntype Position = {\n  top: number;\n  left: number;\n  width: number;\n  height: number;\n};\n\nfunction getScrollableAncestors(element: HTMLElement | null) {\n  if (!element || typeof window === 'undefined') return [];\n  const ancestors: HTMLElement[] = [];\n  let parent = element.parentElement;\n  const scrollRegex = /(auto|scroll)/;\n  while (parent && parent !== document.body) {\n    const style = window.getComputedStyle(parent);\n    if (scrollRegex.test(style.overflowY) || scrollRegex.test(style.overflowX) || scrollRegex.test(style.overflow)) {\n      ancestors.push(parent);\n    }\n    parent = parent.parentElement;\n  }\n  return ancestors;\n}\n\nfunction getHighlightPosition(selector: string, padding = 12): Position | null {\n  if (typeof document === 'undefined') return null;\n  const el = document.querySelector(selector) as HTMLElement | null;\n  if (!el) return null;\n  const rect = el.getBoundingClientRect();\n  return {\n    top: rect.top - padding,\n    left: rect.left - padding,\n    width: rect.width + padding * 2,\n    height: rect.height + padding * 2,\n  };\n}\n\nfunction getDescriptionPosition(highlight: Position | null, boxWidth = 320) {\n  const viewportWidth = typeof window === 'undefined' ? 0 : window.innerWidth;\n  const viewportHeight = typeof window === 'undefined' ? 0 : window.innerHeight;\n  const clampLeft = (val: number) => {\n    if (!viewportWidth) return 24;\n    return Math.min(Math.max(val, 16), viewportWidth - boxWidth - 16);\n  };\n  if (!highlight || !viewportWidth || !viewportHeight) {\n    return {\n      top: 80,\n      left: clampLeft(24),\n      arrow: 'top' as const,\n    };\n  }\n  const margin = 16;\n  const spaceBelow = viewportHeight - (highlight.top + highlight.height) - margin;\n  const spaceAbove = highlight.top - margin;\n\n  if (spaceBelow >= 180 || spaceBelow >= spaceAbove) {\n    return {\n      top: Math.min(highlight.top + highlight.height + margin, viewportHeight - 200),\n      left: clampLeft(highlight.left + highlight.width / 2 - boxWidth / 2),\n      arrow: 'top' as const,\n    };\n  }\n  return {\n    top: Math.max(highlight.top - margin - 160, 12),\n    left: clampLeft(highlight.left + highlight.width / 2 - boxWidth / 2),\n    arrow: 'bottom' as const,\n  };\n}\n\nfunction scrollStepIntoView(selector: string) {\n  if (typeof document === 'undefined') return;\n  const target = document.querySelector(selector) as HTMLElement | null;\n  if (!target) return;\n\n  const parents = getScrollableAncestors(target);\n  if (parents.length === 0) {\n    target.scrollIntoView({ behavior: 'smooth', block: 'center', inline: 'center' });\n    return;\n  }\n\n  parents.forEach((parent) => {\n    const parentRect = parent.getBoundingClientRect();\n    const targetRect = target.getBoundingClientRect();\n    const nextTop = targetRect.top - parentRect.top - parent.clientHeight / 2 + targetRect.height / 2;\n    const nextLeft = targetRect.left - parentRect.left - parent.clientWidth / 2 + targetRect.width / 2;\n    parent.scrollTo({\n      top: parent.scrollTop + nextTop,\n      left: parent.scrollLeft + nextLeft,\n      behavior: 'smooth',\n    });\n  });\n\n  requestAnimationFrame(() => {\n    const rect = target.getBoundingClientRect();\n    if (rect.top < 80 || rect.bottom > (window.innerHeight || 0) - 80) {\n      target.scrollIntoView({ behavior: 'smooth', block: 'center', inline: 'center' });\n    }\n  });\n}\n\nexport default function TutorialTour({ onClose }: { onClose?: () => void }) {\n  const steps: Step[] = useMemo(\n    () => [\n      { selector: 'body', headline: 'Welcome!', title: 'Tour intro', text: 'Welcome! This quick tutorial will guide you through the main features of the NEST+m Senior College Destinations Map.' },\n      { selector: '#sidebar-header', headline: 'App Header', title: 'Navigation anchor', text: 'This purple banner anchors the app title plus the Tutorial button‚Äîcome back here anytime for a refresher.' },\n      { selector: '#map-controls-bar', headline: 'Map Controls', title: 'Command strip', text: 'All quick map tools live here so you can toggle themes, overlays, and focus options in one sweep.' },\n      { selector: '#darkModeToggle', headline: 'Theme Toggle', title: 'Light & dark', text: 'Swap the entire experience between bright daytime mode and relaxed night mode.' },\n      { selector: '.gm-style-mtc', headline: 'Map Type', title: 'Map vs satellite', text: 'Use the built-in Google control (top-left) to flip between map and high-resolution satellite imagery.' },\n      { selector: '#locateMeBtn', headline: 'Locate Me', title: 'Center on you', text: 'Drop a marker right where you are standing and zoom the map there automatically.' },\n      { selector: '#toggleTransitBtn', headline: 'Transit Layer', title: 'Routes overlay', text: 'Overlay subway and rail routes to compare real-world commutes to each college.' },\n      { selector: '#zoomToNestmBtn', headline: 'Home Focus', title: 'Zoom to NEST+m', text: 'Snap back to home base whenever you want to re-orient on the school campus.' },\n      { selector: '#toggleNestmBtn', headline: 'Campus Marker', title: 'Show/hide NEST+m', text: 'Temporarily hide the purple campus pin to declutter wide map views.' },\n      { selector: '#zoomToVisibleBtn', headline: 'Reset View', title: 'Fit visible', text: 'Fit every currently visible college onto the screen‚Äîperfect after lots of panning.' },\n      { selector: '#showUpdateLogBtn', headline: 'Update Log', title: 'What changed', text: 'See the latest data drops and feature tweaks pulled straight from the project changelog.' },\n      { selector: '#showFaqBtn', headline: 'FAQ & Tips', title: 'Quick answers', text: 'Open the FAQ drawer for quick answers to common ‚ÄúHow do I‚Ä¶?‚Äù questions.' },\n      { selector: '#clearAllFiltersBtn', headline: 'Clear Filters', title: 'Start fresh', text: 'Reset every filter, search, and visibility toggle so you can start fresh.' },\n      { selector: '#filter-panel-section', headline: 'Filters', title: 'Console', text: 'This stack of accordions controls classes, majors, and regions‚Äîthe rest of the dashboard listens.' },\n      { selector: '#grad-class-filter', headline: 'Classes', title: 'Graduate years', text: 'Turn individual classes on/off or use the color-coded Instagram shortcuts to auto-filter and open their page.' },\n      { selector: '#class-instagram-links', headline: 'Class Instagrams', title: 'Decision pages', text: 'Each chip opens the class decision page in a new tab and filters the map to that class.' },\n      { selector: '#major-area-filter', headline: 'Majors', title: 'Areas of study', text: 'Filter by broad areas of study using quick select/clear buttons plus live student counts.' },\n      { selector: '#region-filter', headline: 'Regions', title: 'Location filters', text: 'Dial in NYC, the rest of NY, out-of-state, or international destinations‚Äîincluding state-by-state toggles.' },\n      { selector: '#statistics-section', headline: 'Stats', title: 'Attendance mix', text: 'Regional totals, public/private mix, and top colleges summarize whatever filters are active.' },\n      { selector: '#trend-section', headline: 'Trends', title: 'Line charts', text: 'Line charts track majors, location focus, and most popular colleges across graduating classes.' },\n      { selector: '#student-list-toolbar', headline: 'Search & Sort', title: 'List tools', text: 'Use the omnibox, view chooser, sorting menus, and gallery toggle to reshape the list instantly.' },\n      { selector: '#student-search-input', headline: 'Search', title: 'Omnibox', text: 'Type any student, college, or major keyword and the list + map react immediately.' },\n      { selector: '#student-list-scroll', headline: 'Student List', title: 'List & gallery', text: 'Hover to preview photos, click for the popup, collapse by class, or switch to a gallery grid.' },\n      { selector: '#map-area', headline: 'Interactive Map', title: 'Linked to filters', text: 'Pan, zoom, and click markers. Everything stays linked to the filters and list on the left.' },\n    ],\n    []\n  );\n\n  const [current, setCurrent] = useState(0);\n  const [isOpen, setIsOpen] = useState(false);\n  const [highlight, setHighlight] = useState<Position | null>(null);\n  const [hasCompleted, setHasCompleted] = useState(false);\n\n  const openTutorial = () => {\n    setIsOpen(true);\n    setCurrent(0);\n  };\n\n  const closeTutorial = useCallback(() => {\n    setIsOpen(false);\n    if (onClose) onClose();\n  }, [onClose]);\n\n  const markCompleted = useCallback(() => {\n    if (typeof window !== 'undefined') {\n      window.localStorage.setItem('tutorial-completed', 'true');\n    }\n    setHasCompleted(true);\n  }, []);\n\n  const goPrev = useCallback(() => setCurrent((c) => Math.max(0, c - 1)), []);\n  const goNext = useCallback(() => {\n    setCurrent((c) => {\n      if (c >= steps.length - 1) {\n        markCompleted();\n        closeTutorial();\n        return c;\n      }\n      return Math.min(steps.length - 1, c + 1);\n    });\n  }, [closeTutorial, markCompleted, steps.length]);\n\n  useEffect(() => {\n    if (!isOpen) return;\n    const selector = steps[current]?.selector;\n    if (!selector) return;\n    if (current === 0) {\n      setHighlight(null);\n      return;\n    }\n\n    const target = document.querySelector(selector) as HTMLElement | null;\n    const scrollParents = getScrollableAncestors(target);\n    let raf = requestAnimationFrame(() => setHighlight(getHighlightPosition(selector)));\n\n    const update = () => {\n      cancelAnimationFrame(raf);\n      raf = requestAnimationFrame(() => setHighlight(getHighlightPosition(selector)));\n    };\n\n    window.addEventListener('resize', update);\n    window.addEventListener('scroll', update, { passive: true });\n    scrollParents.forEach((node) => node.addEventListener('scroll', update, { passive: true }));\n\n    return () => {\n      cancelAnimationFrame(raf);\n      window.removeEventListener('resize', update);\n      window.removeEventListener('scroll', update);\n      scrollParents.forEach((node) => node.removeEventListener('scroll', update));\n    };\n  }, [current, isOpen, steps]);\n\n  useEffect(() => {\n    if (!isOpen || current === 0) return;\n    const selector = steps[current]?.selector;\n    if (!selector) return;\n    const raf = requestAnimationFrame(() => scrollStepIntoView(selector));\n    return () => cancelAnimationFrame(raf);\n  }, [current, isOpen, steps]);\n\n  // Arrow key navigation\n  useEffect(() => {\n    if (!isOpen) return;\n    const handleKey = (e: KeyboardEvent) => {\n      if (e.key === 'ArrowRight') {\n        e.preventDefault();\n        goNext();\n      } else if (e.key === 'ArrowLeft') {\n        e.preventDefault();\n        goPrev();\n      }\n    };\n    window.addEventListener('keydown', handleKey);\n    return () => window.removeEventListener('keydown', handleKey);\n  }, [isOpen, goNext, goPrev]);\n\n  // Initialize completion state and auto-open if not completed\n  useEffect(() => {\n    if (typeof window === 'undefined') return;\n    const done = window.localStorage.getItem('tutorial-completed') === 'true';\n    setHasCompleted(done);\n    if (!done) {\n      setIsOpen(true);\n      setCurrent(0);\n    }\n  }, []);\n\n  const handleRestart = () => {\n    setCurrent(0);\n    setIsOpen(true);\n  };\n\n  if (!isOpen) {\n    return (\n      <button\n        className=\"ml-2 px-3 py-1 text-sm rounded border border-white/40 bg-white/20 text-white hover:bg-white/30 transition-colors\"\n        onClick={openTutorial}\n        type=\"button\"\n      >\n        ‚ùì Tutorial\n      </button>\n    );\n  }\n\n  const step = steps[current];\n  const descPos =\n    current === 0\n      ? (() => {\n          const vw = typeof window !== 'undefined' ? window.innerWidth : 0;\n          const vh = typeof window !== 'undefined' ? window.innerHeight : 0;\n          return {\n            top: Math.max((vh ? vh / 2 : 200) - 120, 40),\n            left: Math.max((vw ? vw / 2 : 200) - 160, 24),\n          };\n        })()\n      : getDescriptionPosition(highlight);\n\n  return (\n    <>\n      <div\n        className={`fixed inset-0 z-[12000] ${current === 0 ? 'bg-black/70' : ''}`}\n        onClick={() => hasCompleted && closeTutorial()}\n      />\n      {highlight && (\n        <div\n          className=\"fixed z-[12001] pointer-events-none transition-all duration-200 ease-out\"\n          style={{\n            top: highlight.top,\n            left: highlight.left,\n            width: highlight.width,\n            height: highlight.height,\n            borderRadius: '14px',\n            boxShadow: '0 0 0 9999px rgba(0,0,0,0.72)',\n            border: '2px solid rgba(59,130,246,0.95)',\n            background: 'rgba(59,130,246,0.12)',\n          }}\n        />\n      )}\n      <div\n        className=\"fixed z-[12002] w-[min(340px,90vw)] bg-white dark:bg-neutral-900 border border-gray-200 dark:border-neutral-700 rounded-lg shadow-2xl p-4 text-sm\"\n        style={{ top: descPos.top, left: descPos.left }}\n      >\n        {step?.title && <div className=\"text-[11px] uppercase tracking-wide text-gray-500 dark:text-gray-400 mb-1\">{step.title}</div>}\n        <div className=\"text-lg mb-1 text-gray-900 dark:text-gray-100\">{step?.headline}</div>\n        <p className=\"text-gray-700 dark:text-gray-300 mb-3 leading-relaxed font-normal\">{step?.text}</p>\n        <div className=\"flex items-center justify-between text-xs gap-3 flex-wrap\">\n          <div className=\"flex items-center gap-2 flex-wrap\">\n            <button\n              className=\"px-2 py-1 rounded border border-gray-300 dark:border-neutral-700 bg-amber-100 text-amber-900 hover:bg-amber-200 dark:bg-amber-900/30 dark:text-amber-200 disabled:opacity-50 disabled:cursor-not-allowed\"\n              onClick={goPrev}\n              disabled={current === 0}\n              type=\"button\"\n            >\n              Prev\n            </button>\n            <button\n              className=\"px-2 py-1 rounded border border-gray-300 dark:border-neutral-700 bg-blue-600 text-white hover:bg-blue-700\"\n              onClick={() => {\n                if (current === steps.length - 1) {\n                  markCompleted();\n                  closeTutorial();\n                } else {\n                  goNext();\n                }\n              }}\n              type=\"button\"\n            >\n              {current === steps.length - 1 ? 'Finish' : 'Next'}\n            </button>\n            <button\n              className=\"px-2 py-1 rounded border border-gray-200 dark:border-neutral-700 bg-emerald-100 text-emerald-900 hover:bg-emerald-200 dark:bg-emerald-900/30 dark:text-emerald-200\"\n              onClick={handleRestart}\n              type=\"button\"\n            >\n              Restart\n            </button>\n            <button\n              className=\"px-2 py-1 rounded border border-gray-200 dark:border-neutral-700 bg-rose-100 text-rose-900 hover:bg-rose-200 dark:bg-rose-900/30 dark:text-rose-200\"\n              onClick={() => {\n                markCompleted();\n                closeTutorial();\n              }}\n              type=\"button\"\n            >\n              Skip\n            </button>\n          </div>\n          <span className=\"text-gray-500 dark:text-gray-400\">\n            Step {current + 1} / {steps.length}\n          </span>\n        </div>\n      </div>\n    </>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AAFA;;;AAkBA,SAAS,uBAAuB,OAA2B;IACzD,wCAA+C,OAAO,EAAE;;;IACxD,MAAM;IACN,IAAI;IACJ,MAAM;AASR;AAEA,SAAS,qBAAqB,QAAgB,EAAE,UAAU,EAAE;IAC1D,IAAI,OAAO,aAAa,aAAa,OAAO;IAC5C,MAAM,KAAK,SAAS,aAAa,CAAC;IAClC,IAAI,CAAC,IAAI,OAAO;IAChB,MAAM,OAAO,GAAG,qBAAqB;IACrC,OAAO;QACL,KAAK,KAAK,GAAG,GAAG;QAChB,MAAM,KAAK,IAAI,GAAG;QAClB,OAAO,KAAK,KAAK,GAAG,UAAU;QAC9B,QAAQ,KAAK,MAAM,GAAG,UAAU;IAClC;AACF;AAEA,SAAS,uBAAuB,SAA0B,EAAE,WAAW,GAAG;IACxE,MAAM,gBAAgB,uCAAgC,IAAI;IAC1D,MAAM,iBAAiB,uCAAgC,IAAI;IAC3D,MAAM,YAAY,CAAC;QACjB,wCAAoB,OAAO;;;IAE7B;IACA,wCAAqD;QACnD,OAAO;YACL,KAAK;YACL,MAAM,UAAU;YAChB,OAAO;QACT;IACF;;;IACA,MAAM;IACN,MAAM;IACN,MAAM;AAcR;AAEA,SAAS,mBAAmB,QAAgB;IAC1C,IAAI,OAAO,aAAa,aAAa;IACrC,MAAM,SAAS,SAAS,aAAa,CAAC;IACtC,IAAI,CAAC,QAAQ;IAEb,MAAM,UAAU,uBAAuB;IACvC,IAAI,QAAQ,MAAM,KAAK,GAAG;QACxB,OAAO,cAAc,CAAC;YAAE,UAAU;YAAU,OAAO;YAAU,QAAQ;QAAS;QAC9E;IACF;IAEA,QAAQ,OAAO,CAAC,CAAC;QACf,MAAM,aAAa,OAAO,qBAAqB;QAC/C,MAAM,aAAa,OAAO,qBAAqB;QAC/C,MAAM,UAAU,WAAW,GAAG,GAAG,WAAW,GAAG,GAAG,OAAO,YAAY,GAAG,IAAI,WAAW,MAAM,GAAG;QAChG,MAAM,WAAW,WAAW,IAAI,GAAG,WAAW,IAAI,GAAG,OAAO,WAAW,GAAG,IAAI,WAAW,KAAK,GAAG;QACjG,OAAO,QAAQ,CAAC;YACd,KAAK,OAAO,SAAS,GAAG;YACxB,MAAM,OAAO,UAAU,GAAG;YAC1B,UAAU;QACZ;IACF;IAEA,sBAAsB;QACpB,MAAM,OAAO,OAAO,qBAAqB;QACzC,IAAI,KAAK,GAAG,GAAG,MAAM,KAAK,MAAM,GAAG,CAAC,OAAO,WAAW,IAAI,CAAC,IAAI,IAAI;YACjE,OAAO,cAAc,CAAC;gBAAE,UAAU;gBAAU,OAAO;gBAAU,QAAQ;YAAS;QAChF;IACF;AACF;AAEe,SAAS,aAAa,EAAE,OAAO,EAA4B;IACxE,MAAM,QAAgB,IAAA,gNAAO,EAC3B,IAAM;YACJ;gBAAE,UAAU;gBAAQ,UAAU;gBAAY,OAAO;gBAAc,MAAM;YAAuH;YAC5L;gBAAE,UAAU;gBAAmB,UAAU;gBAAc,OAAO;gBAAqB,MAAM;YAA4G;YACrM;gBAAE,UAAU;gBAAqB,UAAU;gBAAgB,OAAO;gBAAiB,MAAM;YAAoG;YAC7L;gBAAE,UAAU;gBAAmB,UAAU;gBAAgB,OAAO;gBAAgB,MAAM;YAAiF;YACvK;gBAAE,UAAU;gBAAiB,UAAU;gBAAY,OAAO;gBAAoB,MAAM;YAAwG;YAC5L;gBAAE,UAAU;gBAAgB,UAAU;gBAAa,OAAO;gBAAiB,MAAM;YAAmF;YACpK;gBAAE,UAAU;gBAAqB,UAAU;gBAAiB,OAAO;gBAAkB,MAAM;YAAiF;YAC5K;gBAAE,UAAU;gBAAmB,UAAU;gBAAc,OAAO;gBAAkB,MAAM;YAA8E;YACpK;gBAAE,UAAU;gBAAmB,UAAU;gBAAiB,OAAO;gBAAoB,MAAM;YAAsE;YACjK;gBAAE,UAAU;gBAAqB,UAAU;gBAAc,OAAO;gBAAe,MAAM;YAAqF;YAC1K;gBAAE,UAAU;gBAAqB,UAAU;gBAAc,OAAO;gBAAgB,MAAM;YAA2F;YACjL;gBAAE,UAAU;gBAAe,UAAU;gBAAc,OAAO;gBAAiB,MAAM;YAA0E;YAC3J;gBAAE,UAAU;gBAAuB,UAAU;gBAAiB,OAAO;gBAAe,MAAM;YAA4E;YACtK;gBAAE,UAAU;gBAAyB,UAAU;gBAAW,OAAO;gBAAW,MAAM;YAAoG;YACtL;gBAAE,UAAU;gBAAsB,UAAU;gBAAW,OAAO;gBAAkB,MAAM;YAAgH;YACtM;gBAAE,UAAU;gBAA0B,UAAU;gBAAoB,OAAO;gBAAkB,MAAM;YAA0F;YAC7L;gBAAE,UAAU;gBAAsB,UAAU;gBAAU,OAAO;gBAAkB,MAAM;YAA4F;YACjL;gBAAE,UAAU;gBAAkB,UAAU;gBAAW,OAAO;gBAAoB,MAAM;YAA6G;YACjM;gBAAE,UAAU;gBAAuB,UAAU;gBAAS,OAAO;gBAAkB,MAAM;YAA+F;YACpL;gBAAE,UAAU;gBAAkB,UAAU;gBAAU,OAAO;gBAAe,MAAM;YAAiG;YAC/K;gBAAE,UAAU;gBAAyB,UAAU;gBAAiB,OAAO;gBAAc,MAAM;YAAkG;YAC7L;gBAAE,UAAU;gBAAyB,UAAU;gBAAU,OAAO;gBAAW,MAAM;YAAoF;YACrK;gBAAE,UAAU;gBAAwB,UAAU;gBAAgB,OAAO;gBAAkB,MAAM;YAAgG;YAC7L;gBAAE,UAAU;gBAAa,UAAU;gBAAmB,OAAO;gBAAqB,MAAM;YAA6F;SACtL,EACD,EAAE;IAGJ,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,iNAAQ,EAAC;IACvC,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,iNAAQ,EAAC;IACrC,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,iNAAQ,EAAkB;IAC5D,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,iNAAQ,EAAC;IAEjD,MAAM,eAAe;QACnB,UAAU;QACV,WAAW;IACb;IAEA,MAAM,gBAAgB,IAAA,oNAAW,EAAC;QAChC,UAAU;QACV,IAAI,SAAS;IACf,GAAG;QAAC;KAAQ;IAEZ,MAAM,gBAAgB,IAAA,oNAAW,EAAC;QAChC;;QAGA,gBAAgB;IAClB,GAAG,EAAE;IAEL,MAAM,SAAS,IAAA,oNAAW,EAAC,IAAM,WAAW,CAAC,IAAM,KAAK,GAAG,CAAC,GAAG,IAAI,KAAK,EAAE;IAC1E,MAAM,SAAS,IAAA,oNAAW,EAAC;QACzB,WAAW,CAAC;YACV,IAAI,KAAK,MAAM,MAAM,GAAG,GAAG;gBACzB;gBACA;gBACA,OAAO;YACT;YACA,OAAO,KAAK,GAAG,CAAC,MAAM,MAAM,GAAG,GAAG,IAAI;QACxC;IACF,GAAG;QAAC;QAAe;QAAe,MAAM,MAAM;KAAC;IAE/C,IAAA,kNAAS,EAAC;QACR,IAAI,CAAC,QAAQ;QACb,MAAM,WAAW,KAAK,CAAC,QAAQ,EAAE;QACjC,IAAI,CAAC,UAAU;QACf,IAAI,YAAY,GAAG;YACjB,aAAa;YACb;QACF;QAEA,MAAM,SAAS,SAAS,aAAa,CAAC;QACtC,MAAM,gBAAgB,uBAAuB;QAC7C,IAAI,MAAM,sBAAsB,IAAM,aAAa,qBAAqB;QAExE,MAAM,SAAS;YACb,qBAAqB;YACrB,MAAM,sBAAsB,IAAM,aAAa,qBAAqB;QACtE;QAEA,OAAO,gBAAgB,CAAC,UAAU;QAClC,OAAO,gBAAgB,CAAC,UAAU,QAAQ;YAAE,SAAS;QAAK;QAC1D,cAAc,OAAO,CAAC,CAAC,OAAS,KAAK,gBAAgB,CAAC,UAAU,QAAQ;gBAAE,SAAS;YAAK;QAExF,OAAO;YACL,qBAAqB;YACrB,OAAO,mBAAmB,CAAC,UAAU;YACrC,OAAO,mBAAmB,CAAC,UAAU;YACrC,cAAc,OAAO,CAAC,CAAC,OAAS,KAAK,mBAAmB,CAAC,UAAU;QACrE;IACF,GAAG;QAAC;QAAS;QAAQ;KAAM;IAE3B,IAAA,kNAAS,EAAC;QACR,IAAI,CAAC,UAAU,YAAY,GAAG;QAC9B,MAAM,WAAW,KAAK,CAAC,QAAQ,EAAE;QACjC,IAAI,CAAC,UAAU;QACf,MAAM,MAAM,sBAAsB,IAAM,mBAAmB;QAC3D,OAAO,IAAM,qBAAqB;IACpC,GAAG;QAAC;QAAS;QAAQ;KAAM;IAE3B,uBAAuB;IACvB,IAAA,kNAAS,EAAC;QACR,IAAI,CAAC,QAAQ;QACb,MAAM,YAAY,CAAC;YACjB,IAAI,EAAE,GAAG,KAAK,cAAc;gBAC1B,EAAE,cAAc;gBAChB;YACF,OAAO,IAAI,EAAE,GAAG,KAAK,aAAa;gBAChC,EAAE,cAAc;gBAChB;YACF;QACF;QACA,OAAO,gBAAgB,CAAC,WAAW;QACnC,OAAO,IAAM,OAAO,mBAAmB,CAAC,WAAW;IACrD,GAAG;QAAC;QAAQ;QAAQ;KAAO;IAE3B,6DAA6D;IAC7D,IAAA,kNAAS,EAAC;QACR,wCAAmC;;;QACnC,MAAM;IAMR,GAAG,EAAE;IAEL,MAAM,gBAAgB;QACpB,WAAW;QACX,UAAU;IACZ;IAEA,IAAI,CAAC,QAAQ;QACX,qBACE,8OAAC;YACC,WAAU;YACV,SAAS;YACT,MAAK;sBACN;;;;;;IAIL;IAEA,MAAM,OAAO,KAAK,CAAC,QAAQ;IAC3B,MAAM,UACJ,YAAY,IACR,CAAC;QACC,MAAM,KAAK,sCAAgC,0BAAoB;QAC/D,MAAM,KAAK,sCAAgC,0BAAqB;QAChE,OAAO;YACL,KAAK,KAAK,GAAG,CAAC,CAAC,sCAAK,0BAAS,GAAG,IAAI,KAAK;YACzC,MAAM,KAAK,GAAG,CAAC,CAAC,sCAAK,0BAAS,GAAG,IAAI,KAAK;QAC5C;IACF,CAAC,MACD,uBAAuB;IAE7B,qBACE;;0BACE,8OAAC;gBACC,WAAW,CAAC,wBAAwB,EAAE,YAAY,IAAI,gBAAgB,IAAI;gBAC1E,SAAS,IAAM,gBAAgB;;;;;;YAEhC,2BACC,8OAAC;gBACC,WAAU;gBACV,OAAO;oBACL,KAAK,UAAU,GAAG;oBAClB,MAAM,UAAU,IAAI;oBACpB,OAAO,UAAU,KAAK;oBACtB,QAAQ,UAAU,MAAM;oBACxB,cAAc;oBACd,WAAW;oBACX,QAAQ;oBACR,YAAY;gBACd;;;;;;0BAGJ,8OAAC;gBACC,WAAU;gBACV,OAAO;oBAAE,KAAK,QAAQ,GAAG;oBAAE,MAAM,QAAQ,IAAI;gBAAC;;oBAE7C,MAAM,uBAAS,8OAAC;wBAAI,WAAU;kCAA6E,KAAK,KAAK;;;;;;kCACtH,8OAAC;wBAAI,WAAU;kCAAiD,MAAM;;;;;;kCACtE,8OAAC;wBAAE,WAAU;kCAAqE,MAAM;;;;;;kCACxF,8OAAC;wBAAI,WAAU;;0CACb,8OAAC;gCAAI,WAAU;;kDACb,8OAAC;wCACC,WAAU;wCACV,SAAS;wCACT,UAAU,YAAY;wCACtB,MAAK;kDACN;;;;;;kDAGD,8OAAC;wCACC,WAAU;wCACV,SAAS;4CACP,IAAI,YAAY,MAAM,MAAM,GAAG,GAAG;gDAChC;gDACA;4CACF,OAAO;gDACL;4CACF;wCACF;wCACA,MAAK;kDAEJ,YAAY,MAAM,MAAM,GAAG,IAAI,WAAW;;;;;;kDAE7C,8OAAC;wCACC,WAAU;wCACV,SAAS;wCACT,MAAK;kDACN;;;;;;kDAGD,8OAAC;wCACC,WAAU;wCACV,SAAS;4CACP;4CACA;wCACF;wCACA,MAAK;kDACN;;;;;;;;;;;;0CAIH,8OAAC;gCAAK,WAAU;;oCAAmC;oCAC3C,UAAU;oCAAE;oCAAI,MAAM,MAAM;;;;;;;;;;;;;;;;;;;;;AAM9C"}},
    {"offset": {"line": 4926, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/kirk/Downloads/Coding%20Projects/nestmcollegemap/src/data/updateLog.ts"],"sourcesContent":["export const updateLog = [\n  {\n    version: \"v1.2.0\",\n    date: \"2025-02-01\",\n    notes: [\n      \"Added collapsible class groups, gallery view, and hover-triggered photo previews.\",\n      \"Persist filters, theme, map type, transit, and sidebar width to local storage.\",\n      \"Revamped trends with majors, regions, and top colleges per year.\",\n    ],\n  },\n  {\n    version: \"v1.1.0\",\n    date: \"2025-01-20\",\n    notes: [\n      \"Introduced interactive tutorial overlay.\",\n      \"Added update log and FAQ modals.\",\n      \"Improved senior photo popup navigation and map sync.\",\n    ],\n  },\n  {\n    version: \"v1.0.0\",\n    date: \"2025-01-10\",\n    notes: [\n      \"Initial React port of NEST+m College Map with map markers, filters, and photo popups.\",\n    ],\n  },\n];\n"],"names":[],"mappings":";;;;AAAO,MAAM,YAAY;IACvB;QACE,SAAS;QACT,MAAM;QACN,OAAO;YACL;YACA;YACA;SACD;IACH;IACA;QACE,SAAS;QACT,MAAM;QACN,OAAO;YACL;YACA;YACA;SACD;IACH;IACA;QACE,SAAS;QACT,MAAM;QACN,OAAO;YACL;SACD;IACH;CACD"}},
    {"offset": {"line": 4961, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/kirk/Downloads/Coding%20Projects/nestmcollegemap/src/components/ui/InfoModals.tsx"],"sourcesContent":["'use client';\n\nimport React, { useEffect, useState } from 'react';\nimport { updateLog as fallbackReleases } from '@/data/updateLog';\n\ntype Release = { version: string; date: string; notes: string[] };\n\nconst faqEntries = [\n  {\n    q: 'I have questions, concerns, and comments about the project.',\n    a: 'For any questions, concerns and comments, please message me on Instagram: @normanmei_',\n  },\n  {\n    q: 'How is the data collected?',\n    a: 'Data is pulled / sourced all done manually from publicly available Instagram posts (e.g., \"college decisions\" accounts for NEST+m graduating classes) and voluntarily submitted information. All data aims to be respectful of privacy and focuses on publicly shared commitments.',\n  },\n  {\n    q: 'How often is the data updated?',\n    a: 'During decision season I refresh the dataset roughly once a week; outside that window, I batch updates every few weeks or when new info is submitted.',\n  },\n  {\n    q: 'What is the next thing you are going to add?',\n    a: 'Next up: shareable filter presets (so you can link friends directly to a view) and a compact ‚Äúyear-over-year‚Äù trends tab that compares classes.',\n  },\n  {\n    q: 'How long did this project take? What was the inspiration?',\n    a: \"I started this project in late May 2025 for my APCSP final project just for fun. Putting in all the data manually probably took a combined total of 60 hours or more.\",\n  },\n  {\n    q: 'Is my personal information shared publicly?',\n    a: 'Only your first and last name, graduating class, the school you commmited to, Instagram profile, LinkedIn profile, and college choice are displayed. No other personal details (e.g., home address, email) are collected or shown, to respect privacy.',\n  },\n  {\n    q: 'Have you considered using the Instagram API?',\n    a: `Yes, I thought of this at first to completely futureproof my project for future graduating classes but as I did a little more research, I found out that I simply can't do it because I need a solution that works for accounts I don‚Äôt own and maintains minimal ongoing effort, the official Instagram APIs simply won‚Äôt do.\n\nBasic Display API is gone: Meta deprecated it on December 4, 2024, so any calls now just error out.\nGraph API requires ownership & verification: I‚Äôd have to convert the school‚Äôs accounts to Business/Creator, pass App Review, and complete Business Verification‚Äînone of which I control.\noEmbed only returns embed HTML: I can‚Äôt pull separate JSON fields for photos, bios, or profile pics‚Äîjust a blockquote snippet.\nScraping is brittle (& against IG ToS): While it‚Äôs technically possible, it can break whenever the site changes (too much work to fix over time if it keeps breaking) and not to mention it violates Instagram‚Äôs Terms of Service, and risks bans.\n\nBottom line: Without owning and verifying the accounts, there‚Äôs no official API route to auto-fetch seniors‚Äô photos or bios, so I that's why I don't use any API of sort, everything is done manually.`,\n  },\n  {\n    q: 'How are \"Major Areas\" determined?',\n    a: 'Specific majors are mapped to broader \"Major Areas\" using a combination of a JS file and keyword-based logic in the main script. This helps in summarizing trends. Combined majors (e.g., \"CS & Econ\") may be split or categorized based on their components.',\n  },\n  {\n    q: \"Why can't I see a specific senior's photo?\",\n    a: 'Photos are linked based on filenames derived from senior names and graduating years. If a photo is missing, it might be because it wasn\\'t available or a naming convention mismatch. The system attempts fallbacks (PNG, college logo) if the primary JPG is not found.',\n  },\n  {\n    q: 'How do the filters work?',\n    a: 'You can filter by graduating class, state/country of the college, location focus (NYC, NY State, Out of State, International), and major area. Filters are generally additive (AND logic). The lists and map will update to show only seniors matching all active filter criteria. \"Clear All Filters\" resets everything.',\n  },\n  {\n    q: 'What do the different colors for map markers mean?',\n    a: 'Map marker colors correspond to the graduating class of the senior, using the same color scheme as in the \"Filter by Graduating Class\" section.',\n  },\n  {\n    q: 'What is \"Gallery View\"?',\n    a: 'Gallery View changes the student list into a card-based layout, often showing senior photos or college logos more prominently. It\\'s an alternative way to browse the data.',\n  },\n  {\n    q: 'How can I use the list navigation with keyboard?',\n    a: 'When the list has focus (and you\\'re not typing in the search bar), use the Up and Down arrow keys to navigate between seniors. If a senior\\'s photo is zoomed in, use Left and Right arrow keys to navigate to the previous/next senior\\'s photo. Press Escape to close popups or zoomed photos.',\n  },\n];\n\nfunction ModalShell({\n  title,\n  open,\n  onClose,\n  children,\n}: {\n  title: string;\n  open: boolean;\n  onClose: () => void;\n  children: React.ReactNode;\n}) {\n  if (!open) return null;\n  return (\n    <>\n      <div className=\"fixed inset-0 z-[13000] bg-black/60\" onClick={onClose} />\n      <div className=\"fixed z-[13001] top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[min(90vw,720px)] max-h-[80vh] bg-white dark:bg-neutral-900 border border-gray-200 dark:border-neutral-700 rounded-lg shadow-2xl overflow-hidden flex flex-col\">\n        <div className=\"flex items-center justify-between px-4 py-3 border-b border-gray-200 dark:border-neutral-700\">\n          <h3 className=\"font-semibold\">{title}</h3>\n          <button onClick={onClose} className=\"text-lg px-2 py-1 rounded hover:bg-gray-100 dark:hover:bg-neutral-800\">\n            √ó\n          </button>\n        </div>\n        <div className=\"flex-1 overflow-y-auto p-4 text-sm\">{children}</div>\n      </div>\n    </>\n  );\n}\n\nexport default function InfoModals() {\n  const [showUpdateLog, setShowUpdateLog] = useState(false);\n  const [showFaq, setShowFaq] = useState(false);\n  const [releases, setReleases] = useState<Release[]>(fallbackReleases);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  useEffect(() => {\n    const openLog = () => setShowUpdateLog(true);\n    const openFaq = () => setShowFaq(true);\n    window.addEventListener('open-update-log', openLog as EventListener);\n    window.addEventListener('open-faq', openFaq as EventListener);\n    return () => {\n      window.removeEventListener('open-update-log', openLog as EventListener);\n      window.removeEventListener('open-faq', openFaq as EventListener);\n    };\n  }, []);\n\n  useEffect(() => {\n    if (!showUpdateLog) return;\n    if (releases !== fallbackReleases && releases.length > 0) return;\n\n    const fetchReleases = async () => {\n      const controller = new AbortController();\n      const timeout = setTimeout(() => controller.abort(), 5000);\n      try {\n        setLoading(true);\n        setError(null);\n        const resp = await fetch('https://api.github.com/repos/norman-mei/nestmcollegemap/releases?per_page=10', {\n          signal: controller.signal,\n        });\n        if (!resp.ok) throw new Error(`GitHub responded ${resp.status}`);\n        const json = await resp.json();\n        const mapped: Release[] = (json || []).map((r: any) => ({\n          version: r.name || r.tag_name || 'Untitled',\n          date: r.published_at ? new Date(r.published_at).toISOString().slice(0, 10) : 'Unknown',\n          notes:\n            r.body\n              ?.split('\\n')\n              .map((l: string) => l.trim().replace(/^[-*]\\s*/, ''))\n              .filter((l: string) => l.length > 0) || ['No notes provided.'],\n        }));\n        if (mapped.length > 0) {\n          setReleases(mapped);\n        } else {\n          setReleases([]);\n        }\n      } catch (e: any) {\n        setError('Could not load update log from GitHub.');\n        setReleases([]);\n      } finally {\n        clearTimeout(timeout);\n        setLoading(false);\n      }\n    };\n\n    fetchReleases();\n  }, [showUpdateLog, releases]);\n\n  return (\n    <>\n      <ModalShell title=\"Update Log / Releases\" open={showUpdateLog} onClose={() => setShowUpdateLog(false)}>\n        <div className=\"space-y-4\">\n          {loading && <div className=\"text-xs text-gray-500\">Loading latest releases from GitHub‚Ä¶</div>}\n          {error && <div className=\"text-xs text-red-500\">{error}</div>}\n          {releases.length === 0 && !loading ? (\n            <div className=\"text-sm text-gray-600 dark:text-gray-300\">No updates found.</div>\n          ) : (\n            releases.map((r) => (\n              <div key={`${r.version}-${r.date}`} className=\"border-b border-gray-200 dark:border-neutral-800 pb-3 last:border-none\">\n                <div className=\"flex items-center justify-between flex-wrap gap-2 mb-2\">\n                  <h4 className=\"font-semibold\">{r.version}</h4>\n                  <span className=\"text-xs text-gray-500 dark:text-gray-400\">{r.date}</span>\n                </div>\n                <ul className=\"list-disc pl-4 space-y-1\">\n                  {r.notes.map((n, idx) => (\n                    <li key={idx}>{n}</li>\n                  ))}\n                </ul>\n              </div>\n            ))\n          )}\n        </div>\n      </ModalShell>\n\n      <ModalShell title=\"FAQ\" open={showFaq} onClose={() => setShowFaq(false)}>\n        <div className=\"space-y-3\">\n          {faqEntries.map((item, idx) => (\n            <div key={idx} className=\"border-b border-gray-200 dark:border-neutral-800 pb-3 last:border-none\">\n              <div className=\"font-semibold mb-1\">{item.q}</div>\n              <div className=\"text-gray-700 dark:text-gray-300\">{item.a}</div>\n            </div>\n          ))}\n        </div>\n      </ModalShell>\n    </>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 5285, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/kirk/Downloads/Coding%20Projects/nestmcollegemap/src/app/page.tsx"],"sourcesContent":["'use client';\n\nimport React, { useState, useEffect } from \"react\";\nimport SidebarContainer from \"@/components/sidebar/SidebarContainer\";\nimport StudentList from \"@/components/sidebar/StudentList\";\nimport FilterPanel from \"@/components/sidebar/FilterPanel\";\nimport StatisticsPanel from \"@/components/sidebar/StatisticsPanel\";\nimport TrendCharts from \"@/components/sidebar/TrendCharts\";\nimport CollegeMap from \"@/components/map/CollegeMap\";\nimport PhotoPopup from \"@/components/ui/PhotoPopup\";\nimport TutorialTour from \"@/components/ui/TutorialTour\";\nimport InfoModals from \"@/components/ui/InfoModals\";\n\nexport default function Home() {\n  const [sidebarCollapsed, setSidebarCollapsed] = useState(false);\n  const NORMAN_ID = 346;\n\n  // Load sidebar collapsed preference\n  useEffect(() => {\n    if (typeof window === 'undefined') return;\n    const stored = window.localStorage.getItem('sidebar-collapsed');\n    if (stored === 'true') setSidebarCollapsed(true);\n  }, []);\n\n  useEffect(() => {\n    if (typeof window !== 'undefined') {\n      (window as any).__sidebarCollapsed = sidebarCollapsed;\n      window.dispatchEvent(new CustomEvent('sidebar-visibility-change', { detail: { collapsed: sidebarCollapsed } }));\n      window.localStorage.setItem('sidebar-collapsed', sidebarCollapsed ? 'true' : 'false');\n    }\n  }, [sidebarCollapsed]);\n\n  return (\n    <main className=\"flex h-screen w-screen overflow-hidden text-gray-800 dark:text-gray-200 relative\">\n      <PhotoPopup />\n      <InfoModals />\n      {!sidebarCollapsed && (\n        <SidebarContainer>\n            <div className=\"flex flex-col h-full min-h-0\">\n              <div id=\"sidebar-header\" className=\"bg-purple-700 text-white p-4 font-bold shadow-md shrink-0 flex items-center gap-2\">\n                  <button\n                    onClick={() => setSidebarCollapsed(true)}\n                    className=\"px-2 py-1 bg-white/20 hover:bg-white/30 text-white rounded border border-white/30 text-xs\"\n                    aria-label=\"Collapse sidebar\"\n                  >\n                    {'<<'}\n                  </button>\n                  <span className=\"text-center flex-1\">NEST+m Senior College Destinations ü¶Ö</span>\n                  <TutorialTour />\n              </div>\n              \n              <div\n                id=\"sidebar-scroll-container\"\n                className=\"flex-1 min-h-0 overflow-y-auto scrollbar-thin scrollbar-thumb-gray-400 pr-2\"\n                style={{ scrollbarGutter: 'stable' }}\n              >\n                  <div id=\"filter-panel-section\"><FilterPanel /></div>\n                  <div id=\"statistics-section\"><StatisticsPanel /></div>\n                  <div id=\"trend-section\"><TrendCharts /></div>\n                  <div id=\"student-list-section\"><StudentList /></div>\n              </div>\n              \n              <div className=\"p-2 text-xs text-center border-t border-gray-200 dark:border-neutral-800 bg-gray-50 dark:bg-neutral-900\">\n                  <button\n                    className=\"font-bold text-[#188BFE] hover:underline focus:underline\"\n                    onClick={() => {\n                      window.dispatchEvent(new CustomEvent('focus-student-from-map', { detail: { id: NORMAN_ID } }));\n                      const fallback = document.querySelector(`[data-student-id=\\\"${NORMAN_ID}\\\"]`) as HTMLElement | null;\n                      if (fallback) {\n                        fallback.scrollIntoView({ behavior: 'smooth', block: 'center' });\n                        fallback.classList.add('ring-2', 'ring-[#188BFE]', 'ring-offset-2');\n                        setTimeout(() => fallback.classList.remove('ring-2', 'ring-[#188BFE]', 'ring-offset-2'), 1500);\n                      }\n                    }}\n                  >\n                    Created by Norman Mei ('25)\n                  </button>\n              </div>\n            </div>\n        </SidebarContainer>\n      )}\n      {sidebarCollapsed && (\n        <button\n          onClick={() => setSidebarCollapsed(false)}\n          className=\"absolute top-1/2 -translate-y-1/2 left-3 z-30 px-2 py-1 bg-white/90 dark:bg-neutral-800/90 rounded shadow border border-gray-200 dark:border-neutral-700 text-sm\"\n          aria-label=\"Expand sidebar\"\n        >\n          {'>>'}\n        </button>\n      )}\n      <div className=\"flex-1 relative h-full\">\n          <div id=\"map-area\" className=\"absolute inset-0\">\n            <CollegeMap />\n          </div>\n      </div>\n    </main>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAXA;;;;;;;;;;;;AAae,SAAS;IACtB,MAAM,CAAC,kBAAkB,oBAAoB,GAAG,IAAA,iNAAQ,EAAC;IACzD,MAAM,YAAY;IAElB,oCAAoC;IACpC,IAAA,kNAAS,EAAC;QACR,wCAAmC;;;QACnC,MAAM;IAER,GAAG,EAAE;IAEL,IAAA,kNAAS,EAAC;QACR;;IAKF,GAAG;QAAC;KAAiB;IAErB,qBACE,8OAAC;QAAK,WAAU;;0BACd,8OAAC,iJAAU;;;;;0BACX,8OAAC,iJAAU;;;;;YACV,CAAC,kCACA,8OAAC,4JAAgB;0BACb,cAAA,8OAAC;oBAAI,WAAU;;sCACb,8OAAC;4BAAI,IAAG;4BAAiB,WAAU;;8CAC/B,8OAAC;oCACC,SAAS,IAAM,oBAAoB;oCACnC,WAAU;oCACV,cAAW;8CAEV;;;;;;8CAEH,8OAAC;oCAAK,WAAU;8CAAqB;;;;;;8CACrC,8OAAC,mJAAY;;;;;;;;;;;sCAGjB,8OAAC;4BACC,IAAG;4BACH,WAAU;4BACV,OAAO;gCAAE,iBAAiB;4BAAS;;8CAEjC,8OAAC;oCAAI,IAAG;8CAAuB,cAAA,8OAAC,uJAAW;;;;;;;;;;8CAC3C,8OAAC;oCAAI,IAAG;8CAAqB,cAAA,8OAAC,2JAAe;;;;;;;;;;8CAC7C,8OAAC;oCAAI,IAAG;8CAAgB,cAAA,8OAAC,uJAAW;;;;;;;;;;8CACpC,8OAAC;oCAAI,IAAG;8CAAuB,cAAA,8OAAC,uJAAW;;;;;;;;;;;;;;;;sCAG/C,8OAAC;4BAAI,WAAU;sCACX,cAAA,8OAAC;gCACC,WAAU;gCACV,SAAS;oCACP,OAAO,aAAa,CAAC,IAAI,YAAY,0BAA0B;wCAAE,QAAQ;4CAAE,IAAI;wCAAU;oCAAE;oCAC3F,MAAM,WAAW,SAAS,aAAa,CAAC,CAAC,mBAAmB,EAAE,UAAU,GAAG,CAAC;oCAC5E,IAAI,UAAU;wCACZ,SAAS,cAAc,CAAC;4CAAE,UAAU;4CAAU,OAAO;wCAAS;wCAC9D,SAAS,SAAS,CAAC,GAAG,CAAC,UAAU,kBAAkB;wCACnD,WAAW,IAAM,SAAS,SAAS,CAAC,MAAM,CAAC,UAAU,kBAAkB,kBAAkB;oCAC3F;gCACF;0CACD;;;;;;;;;;;;;;;;;;;;;;YAOZ,kCACC,8OAAC;gBACC,SAAS,IAAM,oBAAoB;gBACnC,WAAU;gBACV,cAAW;0BAEV;;;;;;0BAGL,8OAAC;gBAAI,WAAU;0BACX,cAAA,8OAAC;oBAAI,IAAG;oBAAW,WAAU;8BAC3B,cAAA,8OAAC,kJAAU;;;;;;;;;;;;;;;;;;;;;AAKvB"}}]
}